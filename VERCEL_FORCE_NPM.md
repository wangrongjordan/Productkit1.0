# ğŸ”§ Vercel å¼ºåˆ¶ä½¿ç”¨ NPM éƒ¨ç½²æ–¹æ¡ˆ

## ğŸš¨ é—®é¢˜åˆ†æ
ä»æ„å»ºæ—¥å¿—å¯ä»¥çœ‹åˆ°ï¼š
```
Detected 'pnpm-lock.yaml' which may be generated by pnpm@9.x or pnpm@10.x
Using pnpm@10.x based on project creation date
```

**æ ¹å› **ï¼šVercel çš„è‡ªåŠ¨æ£€æµ‹æœºåˆ¶å¿½ç•¥äº†æˆ‘ä»¬çš„é…ç½®ï¼Œä»ç„¶é€‰æ‹© pnpmã€‚

## âœ… å·²åº”ç”¨çš„å¼ºåˆ¶ä¿®å¤

### 1. å¼ºåŒ– vercel.json é…ç½®
```json
{
  "framework": "vite",
  "buildCommand": "npm run build",
  "outputDirectory": "dist",
  "installCommand": "npm install --force",
  "env": {
    "NODE_ENV": "production",
    "ENABLE_EXPERIMENTAL_COREPACK": "0",
    "NPM_CONFIG_FUND": "false", 
    "NPM_CONFIG_AUDIT": "false"
  }
}
```

### 2. åˆ›å»º package-lock.json å ä½æ–‡ä»¶
- å¼ºåˆ¶ Vercel æ£€æµ‹åˆ° npm ç¯å¢ƒ
- ä¼˜å…ˆçº§é«˜äºå…¶ä»–åŒ…ç®¡ç†å™¨æ£€æµ‹

### 3. å¢å¼º .npmrc é…ç½®
```
legacy-peer-deps=true
engine-strict=false
package-lock=true
prefer-offline=false
strict-ssl=true
```

## ğŸš€ ç«‹å³æ‰§è¡Œæ­¥éª¤

### æ­¥éª¤ 1: æäº¤æ›´æ”¹åˆ° Git
```bash
git add .
git commit -m "force: use npm for Vercel deployment"
git push origin main
```

### æ­¥éª¤ 2: åœ¨ Vercel æ§åˆ¶å°å¼ºåˆ¶è®¾ç½®
1. è¿›å…¥é¡¹ç›® â†’ **Settings** â†’ **Build & Output Settings**
2. ç‚¹å‡» **Edit**
3. **é‡è¦**ï¼šæ‰‹åŠ¨è¾“å…¥ä»¥ä¸‹è®¾ç½®ï¼š
   ```
   Framework Preset: Other
   Build Command: npm install --force && npm run build
   Output Directory: dist
   Install Command: npm install --force
   ```
4. ç‚¹å‡» **Save**

### æ­¥éª¤ 3: æ·»åŠ ç¯å¢ƒå˜é‡
åœ¨ **Settings** â†’ **Environment Variables** æ·»åŠ ï¼š
```
ENABLE_EXPERIMENTAL_COREPACK = 0
NPM_CONFIG_FUND = false
NPM_CONFIG_AUDIT = false
NODE_VERSION = 18
```

### æ­¥éª¤ 4: å¼ºåˆ¶é‡æ–°éƒ¨ç½²
1. è¿›å…¥ **Deployments**
2. ç‚¹å‡»æœ€æ–°éƒ¨ç½²çš„ **...** èœå•
3. é€‰æ‹© **Redeploy**
4. **å…³é”®**ï¼šé€‰æ‹© **Use existing Build Cache = NO**
5. ç‚¹å‡» **Redeploy**

## ğŸ” éªŒè¯æˆåŠŸæ ‡å¿—

éƒ¨ç½²æˆåŠŸååº”è¯¥çœ‹åˆ°ï¼š
```
âœ“ Installing dependencies with npm install --force
âœ“ Running build command: npm run build
âœ“ Build completed successfully
```

**è€Œä¸æ˜¯**ï¼š
```
âŒ Using pnpm@10.x based on project creation date
âŒ ERR_PNPM_OUTDATED_LOCKFILE
```

## ğŸš¨ å¦‚æœä»ç„¶å¤±è´¥

### ç»ˆææ–¹æ¡ˆï¼šåˆ é™¤é¡¹ç›®é‡å»º
1. åœ¨ Vercel æ§åˆ¶å°å®Œå…¨åˆ é™¤é¡¹ç›®
2. ç¡®ä¿ Git ä»“åº“åŒ…å«æˆ‘ä»¬çš„ä¿®å¤æ–‡ä»¶ï¼š
   - `package-lock.json` âœ…
   - æ›´æ–°çš„ `vercel.json` âœ…
   - å¼ºåŒ–çš„ `.npmrc` âœ…
3. é‡æ–°ä» GitHub å¯¼å…¥é¡¹ç›®
4. é€‰æ‹© **Other** ä½œä¸ºæ¡†æ¶é¢„è®¾
5. æ‰‹åŠ¨è®¾ç½®æ„å»ºå‘½ä»¤

### å¤‡ç”¨æ–¹æ¡ˆï¼šä½¿ç”¨ç¯å¢ƒå˜é‡å¼ºåˆ¶
å¦‚æœé¡¹ç›®æ— æ³•åˆ é™¤ï¼Œåœ¨ç¯å¢ƒå˜é‡ä¸­æ·»åŠ ï¼š
```
FORCE_PACKAGE_MANAGER = npm
DISABLE_COREPACK = 1
NPM_USE_PRODUCTION = false
```

## ğŸ“ æŠ€æœ¯åˆ†æ

**ä¸ºä»€ä¹ˆ Vercel ä»é€‰æ‹© pnpmï¼Ÿ**
1. Git å†å²ä¸­å¯èƒ½åŒ…å« pnpm ç›¸å…³è®°å½•
2. é¡¹ç›®åˆ›å»ºæ—¶çš„å…ƒæ•°æ®æ ‡è®°
3. Vercel çš„å¯å‘å¼æ£€æµ‹ç®—æ³•

**æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆï¼š**
1. âœ… æä¾›æ˜ç¡®çš„ package-lock.json æ–‡ä»¶
2. âœ… ç¯å¢ƒå˜é‡ç¦ç”¨ Corepack
3. âœ… å¼ºåˆ¶å®‰è£…å‘½ä»¤ `npm install --force`
4. âœ… æ‰‹åŠ¨è¦†ç›– Vercel æ£€æµ‹

---

## ğŸ¯ ç°åœ¨è¡ŒåŠ¨

1. **ç«‹å³æäº¤ä»£ç æ›´æ”¹**
2. **åœ¨ Vercel æ§åˆ¶å°æ‰‹åŠ¨è®¾ç½®æ„å»ºé…ç½®**
3. **å¼ºåˆ¶é‡æ–°éƒ¨ç½²ï¼ˆä¸ä½¿ç”¨ç¼“å­˜ï¼‰**

è¿™æ¬¡åº”è¯¥å¯ä»¥å¼ºåˆ¶ Vercel ä½¿ç”¨ npm äº†ï¼ğŸš€