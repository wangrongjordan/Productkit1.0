# 阿里云部署操作手册
## React+Supabase全栈Web应用部署完整指南

---

## 目录

1. [执行概述](#执行概述)
2. [前期准备](#前期准备)
3. [阿里云ECS服务器配置](#阿里云ecs服务器配置)
4. [域名注册和ICP备案](#域名注册和icp备案)
5. [SSL证书申请与配置](#ssl证书申请与配置)
6. [应用代码部署](#应用代码部署)
7. [数据库迁移配置](#数据库迁移配置)
8. [CDN加速配置](#cdn加速配置)
9. [监控和维护](#监控和维护)
10. [成本优化建议](#成本优化建议)
11. [常见问题解决](#常见问题解决)

---

## 执行概述

本手册将指导您将React+Supabase全栈Web应用完整部署到阿里云平台。整个部署过程预计需要3-5天时间（主要等待备案审核），总成本预估300-800元/年。

**部署架构图：**
```
用户 → CDN → Nginx → React应用（静态文件）
                  ↘
                    Node.js后端 → RDS数据库
```

**重要提醒：** 
- 本手册适合非技术人员操作，每个步骤都有详细说明
- 请严格按照顺序执行，避免遗漏关键步骤
- 备案是法律要求，使用中国大陆服务器必须完成ICP备案

---

## 前期准备

### 1. 必需材料清单

**个人用户需要：**
- 身份证正反面扫描件（清晰彩色版）
- 手机号码（用于接收验证码）
- 邮箱地址（用于域名验证）
- 银行卡或支付宝（用于支付）

**企业用户需要：**
- 营业执照扫描件
- 法人身份证正反面扫描件
- 企业公章（用于备案材料盖章）
- 法人手机号码
- 企业邮箱地址

### 2. 技术准备

- **本地开发环境：** 确保React项目可以正常构建（`npm run build`）
- **代码准备：** 将项目代码上传到Git仓库（GitHub/GitLab等）
- **域名规划：** 确定要使用的域名（建议选择.com/.cn等主流后缀）

### 3. 预算规划

**年度费用预估：**
- ECS服务器：99-399元/年（根据配置）
- 域名注册：29-89元/年
- SSL证书：免费（阿里云提供）
- CDN流量：按使用量计费，约10-50元/月
- RDS数据库：180-600元/年（可选）
- **总计：** 约300-800元/年

---

## 阿里云ECS服务器配置

### 1. 注册阿里云账号

1. **访问官网**
   - 打开 [阿里云官网](https://www.aliyun.com)
   - 点击右上角"注册"按钮

2. **账号注册**
   - 选择"手机号注册"
   - 输入手机号码，获取验证码
   - 设置登录密码（建议包含大小写字母、数字和特殊字符）
   - 勾选用户协议，点击"注册"

3. **实名认证**
   - 注册成功后，进入"账号中心"
   - 点击"实名认证"
   - **个人用户：** 选择"个人认证"，上传身份证照片
   - **企业用户：** 选择"企业认证"，上传营业执照和法人身份证

### 2. 购买ECS云服务器

1. **进入ECS购买页面**
   - 登录阿里云控制台
   - 搜索"云服务器ECS"，点击进入
   - 点击"立即购买"

2. **基础配置选择**
   ```
   地域选择：
   - 个人建议：选择离用户最近的区域（如华东1-杭州）
   - 企业建议：选择离公司所在地最近的区域
   
   实例规格推荐：
   - 小型应用：2核2G内存（经济型e实例）- 99元/年
   - 中型应用：2核4G内存（通用算力型u1）- 199元/年  
   - 大型应用：4核8G内存（计算增强型c7）- 399元/年
   ```

3. **网络和存储配置**
   ```
   网络配置：
   - VPC网络：使用默认VPC（推荐）
   - 公网IP：分配公网IPv4地址
   - 带宽：3M固定带宽（适合中小型应用）
   
   存储配置：
   - 系统盘：40G ESSD Entry云盘（性价比高）
   - 数据盘：根据需要选择（可后期扩容）
   ```

4. **系统配置**
   ```
   操作系统：CentOS 7.9 64位（推荐，稳定性好）
   登录方式：设置实例密码（请记住此密码）
   ```

5. **购买确认**
   - 确认配置信息无误
   - 选择购买时长（建议1年，有折扣）
   - 勾选"云服务器ECS服务条款"
   - 点击"立即购买"并完成支付

### 3. 安全组配置

1. **进入安全组管理**
   - 在ECS控制台找到刚创建的实例
   - 点击实例名称进入详情页
   - 点击"安全组"标签页

2. **添加安全组规则**
   ```
   需要开放的端口：
   - HTTP: 80端口（网站访问）
   - HTTPS: 443端口（SSL访问）
   - SSH: 22端口（远程管理，限制源IP为办公网络IP）
   - 自定义：3000端口（Node.js应用端口）
   ```

3. **具体操作步骤**
   - 点击"配置规则"
   - 在"入方向"添加规则：
     * 端口范围：80/80，授权对象：0.0.0.0/0
     * 端口范围：443/443，授权对象：0.0.0.0/0
     * 端口范围：22/22，授权对象：您的办公网络IP/32
     * 端口范围：3000/3000，授权对象：127.0.0.1/32（仅本机访问）

---

## 域名注册和ICP备案

### 1. 域名注册

1. **域名选择原则**
   - 简短易记，与品牌相关
   - 建议选择.com/.cn/.net等主流后缀
   - 避免使用连字符和数字混合

2. **注册步骤**
   - 在阿里云控制台搜索"域名注册"
   - 输入想要的域名进行查询
   - 选择可用的域名后缀
   - 点击"立即注册"

3. **域名信息模板**
   - 创建域名信息模板
   - 填写真实的联系信息
   - 完成邮箱验证
   - 等待模板审核通过（1-2小时）

### 2. ICP备案流程

**⚠️ 重要提醒：** ICP备案是中国大陆的法律要求，网站上线前必须完成备案。

1. **备案前准备**
   - 确保阿里云账号已完成实名认证
   - 准备备案所需材料（见前期准备清单）
   - 确保域名已完成实名认证

2. **开始备案**
   - 登录[阿里云ICP代备案管理系统](https://beian.aliyun.com)
   - 点击"开始备案"
   - 系统会自动判断备案类型（通常是"首次备案"）

3. **填写备案信息**
   
   **第一步：基础信息校验**
   - 选择备案省份（营业执照或身份证所在省份）
   - 输入域名
   - 选择产品类型（云服务器ECS）
   - 输入实例ID（ECS实例的ID）

   **第二步：填写主办者信息**
   ```
   个人备案需要：
   - 姓名、证件号码、地址、电话
   - 身份证正反面照片
   
   企业备案需要：
   - 企业名称、统一社会信用代码
   - 法人信息、企业地址、联系电话
   - 营业执照扫描件、法人身份证
   ```

   **第三步：填写网站信息**
   - 网站名称（不能包含企业、组织等字样，个人备案）
   - 网站内容描述
   - 前置审批：一般选择"以上都不涉及"

4. **上传资料**
   - 按要求上传身份证或营业执照
   - 如需要，上传授权书等其他材料
   - 所有照片需清晰，大小在100KB-4MB之间

5. **提交审核**
   - 仔细核对所有信息
   - 确认无误后提交初审

6. **审核流程**
   ```
   阿里云初审（1-2个工作日）
   ↓
   工信部短信核验（收到短信后24小时内完成）
   ↓
   工信部审核（5-20个工作日）
   ↓
   备案成功（收到短信和邮件通知）
   ```

7. **注意事项**
   - 备案期间网站不能访问
   - 保持联系方式畅通，配合电话核验
   - 备案成功后需在网站底部添加备案号

### 3. 域名解析配置

1. **进入域名解析**
   - 在域名控制台选择已注册的域名
   - 点击"解析"进入DNS解析管理

2. **添加解析记录**
   ```
   A记录配置：
   - 记录类型：A
   - 主机记录：@ （代表根域名）
   - 解析线路：默认
   - 记录值：ECS服务器的公网IP地址
   - TTL：10分钟
   
   CNAME记录配置（可选，用于www前缀）：
   - 记录类型：CNAME  
   - 主机记录：www
   - 记录值：@
   ```

---

## SSL证书申请与配置

### 1. 申请免费SSL证书

1. **进入SSL证书管理**
   - 登录阿里云控制台
   - 搜索"SSL证书"或"数字证书管理服务"
   - 点击进入证书管理页面

2. **申请免费证书**
   - 在左侧导航选择"SSL证书管理"
   - 切换到"个人测试证书（原免费证书）"标签
   - 点击"立即购买"
   - 保持默认选项，勾选服务协议
   - 点击"立即购买"（0元，但需要支付流程）

3. **创建证书**
   - 购买完成后，点击"创建证书"
   - 填写证书信息：
     * 域名名称：输入您的域名（如：example.com）
     * 勾选"快捷签发"
     * 域名验证方式：选择"自动DNS验证"（如果域名在阿里云）
     * 选择或创建联系人信息
     * 选择所在地区

4. **提交审核**
   - 确认信息无误后点击"提交审核"
   - 系统会自动进行域名验证
   - 证书通常在1-15分钟内签发完成

### 2. 下载和部署证书

1. **下载证书**
   - 证书状态显示"已签发"后，点击"下载"
   - 选择"Nginx"服务器类型
   - 下载证书压缩包到本地

2. **解压证书文件**
   - 解压后得到两个文件：
     * `域名.pem`（证书文件）
     * `域名.key`（私钥文件）

3. **上传证书到服务器**
   ```bash
   # 使用SSH连接到服务器
   ssh root@您的服务器IP
   
   # 创建证书存储目录
   mkdir -p /usr/local/nginx/conf/cert
   
   # 使用scp命令上传证书文件（在本地终端执行）
   scp 域名.pem root@服务器IP:/usr/local/nginx/conf/cert/
   scp 域名.key root@服务器IP:/usr/local/nginx/conf/cert/
   ```

### 3. Nginx SSL配置

1. **安装Nginx（如未安装）**
   ```bash
   # CentOS系统
   yum install -y nginx
   
   # 启动并设置开机自启
   systemctl start nginx
   systemctl enable nginx
   ```

2. **配置SSL**
   ```bash
   # 编辑Nginx配置文件
   vi /etc/nginx/nginx.conf
   ```

   **添加HTTPS服务器配置：**
   ```nginx
   server {
       listen 80;
       server_name 您的域名;
       # 将HTTP重定向到HTTPS
       return 301 https://$server_name$request_uri;
   }

   server {
       listen 443 ssl;
       server_name 您的域名;
       
       # SSL证书配置
       ssl_certificate /usr/local/nginx/conf/cert/您的域名.pem;
       ssl_certificate_key /usr/local/nginx/conf/cert/您的域名.key;
       
       # SSL参数
       ssl_session_cache shared:SSL:1m;
       ssl_session_timeout 5m;
       ssl_protocols TLSv1.2 TLSv1.3;
       ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;
       ssl_prefer_server_ciphers on;
       
       # 网站根目录
       root /var/www/html;
       index index.html index.htm;
       
       location / {
           try_files $uri $uri/ @rewrites;
       }
       
       # 用于React Router
       location @rewrites {
           rewrite ^(.+)$ /index.html last;
       }
       
       # API代理到Node.js后端
       location /api/ {
           proxy_pass http://127.0.0.1:3000;
           proxy_http_version 1.1;
           proxy_set_header Upgrade $http_upgrade;
           proxy_set_header Connection 'upgrade';
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_set_header X-Forwarded-Proto $scheme;
           proxy_cache_bypass $http_upgrade;
       }
   }
   ```

3. **重启Nginx**
   ```bash
   # 检查配置语法
   nginx -t
   
   # 重启Nginx
   systemctl restart nginx
   ```

4. **验证SSL部署**
   - 在浏览器中访问 `https://您的域名`
   - 查看地址栏是否显示锁定图标
   - 点击锁定图标确认证书信息

---

## 应用代码部署

### 1. 服务器环境准备

1. **连接服务器**
   ```bash
   # 使用SSH连接（Windows可使用PuTTY）
   ssh root@您的服务器IP
   ```

2. **安装Node.js**
   ```bash
   # 安装Node.js官方仓库
   curl -fsSL https://rpm.nodesource.com/setup_18.x | bash -
   
   # 安装Node.js
   yum install -y nodejs
   
   # 验证安装
   node --version
   npm --version
   ```

3. **安装PM2进程管理器**
   ```bash
   # 全局安装PM2
   npm install -g pm2
   
   # 验证安装
   pm2 --version
   ```

4. **安装Git**
   ```bash
   yum install -y git
   ```

### 2. 部署前端React应用

1. **下载代码**
   ```bash
   # 创建项目目录
   mkdir -p /var/www
   cd /var/www
   
   # 克隆项目代码
   git clone https://github.com/您的用户名/您的项目.git
   cd 您的项目目录
   ```

2. **安装依赖和构建**
   ```bash
   # 安装依赖
   npm install
   
   # 构建生产版本
   npm run build
   ```

3. **配置Nginx指向构建文件**
   ```bash
   # 将构建文件复制到网站根目录
   cp -r build/* /var/www/html/
   
   # 设置文件权限
   chmod -R 755 /var/www/html
   chown -R nginx:nginx /var/www/html
   ```

### 3. 部署Node.js后端

1. **准备后端代码**
   ```bash
   # 如果前后端分离，单独下载后端代码
   cd /var/www
   git clone https://github.com/您的用户名/您的后端项目.git backend
   cd backend
   
   # 安装依赖
   npm install --production
   ```

2. **配置环境变量**
   ```bash
   # 创建环境配置文件
   vi .env
   ```
   
   **环境变量示例：**
   ```env
   NODE_ENV=production
   PORT=3000
   DATABASE_URL=您的数据库连接字符串
   JWT_SECRET=您的JWT密钥
   ```

3. **创建PM2配置文件**
   ```bash
   vi ecosystem.config.js
   ```
   
   **PM2配置示例：**
   ```javascript
   module.exports = {
     apps: [{
       name: 'your-app-backend',
       script: 'server.js',
       instances: 1,
       exec_mode: 'fork',
       env: {
         NODE_ENV: 'production',
         PORT: 3000
       },
       error_file: './logs/err.log',
       out_file: './logs/out.log',
       log_file: './logs/combined.log',
       time: true
     }]
   }
   ```

4. **启动应用**
   ```bash
   # 创建日志目录
   mkdir logs
   
   # 使用PM2启动应用
   pm2 start ecosystem.config.js
   
   # 设置PM2开机自启
   pm2 startup
   pm2 save
   
   # 查看运行状态
   pm2 status
   ```

---

## 数据库迁移配置

### 1. Supabase数据导出

1. **使用pg_dump导出数据**
   ```bash
   # 在本地机器执行（需要安装PostgreSQL客户端）
   pg_dump -h db.你的supabase项目.supabase.co \
           -U postgres \
           -d postgres \
           -p 5432 \
           --clean --create --if-exists \
           -f backup.sql
   ```

2. **导出特定表数据**
   ```bash
   # 只导出数据，不包含结构
   pg_dump -h db.你的supabase项目.supabase.co \
           -U postgres \
           -d postgres \
           --data-only \
           -t 表名1 -t 表名2 \
           -f data.sql
   ```

### 2. 阿里云RDS PostgreSQL配置

1. **创建RDS实例**
   - 在阿里云控制台搜索"云数据库RDS"
   - 选择PostgreSQL版本（建议14或以上）
   - 选择规格：
     * 小型应用：1核2G，20G存储 - 约180元/年
     * 中型应用：2核4G，50G存储 - 约400元/年

2. **配置数据库**
   ```sql
   -- 连接到RDS实例后执行
   CREATE DATABASE your_app_db;
   CREATE USER app_user WITH PASSWORD '强密码';
   GRANT ALL PRIVILEGES ON DATABASE your_app_db TO app_user;
   ```

3. **设置IP白名单**
   - 在RDS控制台进入实例详情
   - 点击"数据安全性"
   - 添加ECS服务器内网IP到白名单

### 3. 数据迁移

1. **上传备份文件到服务器**
   ```bash
   # 使用scp上传
   scp backup.sql root@服务器IP:/tmp/
   ```

2. **安装PostgreSQL客户端**
   ```bash
   # 在ECS服务器上安装
   yum install -y postgresql
   ```

3. **恢复数据**
   ```bash
   # 恢复完整备份
   psql -h RDS内网地址 \
        -U app_user \
        -d your_app_db \
        -f /tmp/backup.sql
   ```

4. **验证数据迁移**
   ```bash
   # 连接数据库检查
   psql -h RDS内网地址 -U app_user -d your_app_db
   
   # 在psql中执行
   \dt  -- 列出所有表
   SELECT count(*) FROM your_table;  -- 检查数据条数
   ```

### 4. 更新应用配置

1. **修改数据库连接字符串**
   ```bash
   vi /var/www/backend/.env
   ```
   
   ```env
   DATABASE_URL=postgresql://app_user:password@RDS内网地址:5432/your_app_db
   ```

2. **重启应用**
   ```bash
   pm2 restart all
   ```

---

## CDN加速配置

### 1. 开通CDN服务

1. **进入CDN控制台**
   - 在阿里云控制台搜索"CDN"
   - 点击"立即开通"
   - 选择计费方式（建议按流量计费）

2. **添加加速域名**
   - 点击"添加域名"
   - 填写要加速的域名（如：cdn.yourdomain.com）
   - 源站类型选择"IP"
   - 源站地址填入ECS公网IP

### 2. CDN缓存策略配置

1. **基础缓存设置**
   ```
   文件类型缓存时间配置：
   - 静态文件(.js, .css, .png, .jpg): 30天
   - HTML文件: 1小时  
   - API接口: 不缓存
   ```

2. **高级缓存配置**
   - 在CDN控制台进入域名管理
   - 点击"缓存配置" → "缓存过期时间"
   - 按文件类型设置不同缓存时间：
   
   ```
   配置规则：
   *.js,*.css,*.png,*.jpg,*.gif,*.ico  → 缓存30天
   *.html,*.htm  → 缓存1小时
   /api/*  → 不缓存
   /  → 缓存1小时
   ```

3. **HTTPS配置**
   - 在"HTTPS配置"中启用HTTPS
   - 上传之前申请的SSL证书
   - 开启"强制HTTPS跳转"

### 3. 优化配置

1. **开启Gzip压缩**
   - 在"性能优化"中开启"智能压缩"
   - 可减少30-70%的传输数据量

2. **页面优化**
   - 开启"页面优化"功能
   - 自动删除页面冗余内容

3. **回源配置**
   - 设置回源HOST为实际服务器域名
   - 开启回源跟随301/302重定向

### 4. DNS解析更新

1. **添加CNAME记录**
   - 在域名解析控制台
   - 添加CDN提供的CNAME地址
   
   ```
   记录类型：CNAME
   主机记录：cdn（或直接用@替换原有记录）
   记录值：xxx.cdn.dnsv1.com（CDN提供的CNAME地址）
   ```

2. **验证CDN生效**
   ```bash
   # 使用curl测试
   curl -I http://cdn.yourdomain.com
   
   # 查看响应头中的Via或X-Cache字段确认CDN生效
   ```

---

## 监控和维护

### 1. 服务器监控

1. **安装监控工具**
   ```bash
   # 安装htop（进程监控）
   yum install -y epel-release
   yum install -y htop
   
   # 安装iotop（磁盘I/O监控）
   yum install -y iotop
   ```

2. **设置日志轮转**
   ```bash
   # 创建logrotate配置
   vi /etc/logrotate.d/your-app
   ```
   
   ```
   /var/www/backend/logs/*.log {
       daily
       missingok
       rotate 52
       compress
       delaycompress
       notifempty
       create 644 root root
       postrotate
           pm2 reload all
       endscript
   }
   ```

3. **设置监控脚本**
   ```bash
   # 创建监控脚本
   vi /root/monitor.sh
   ```
   
   ```bash
   #!/bin/bash
   
   # 检查服务状态
   if ! systemctl is-active --quiet nginx; then
       systemctl restart nginx
       echo "$(date): Nginx restarted" >> /var/log/monitor.log
   fi
   
   # 检查PM2应用状态
   if ! pm2 status | grep -q online; then
       pm2 restart all
       echo "$(date): PM2 apps restarted" >> /var/log/monitor.log
   fi
   
   # 检查磁盘使用率
   DISK_USAGE=$(df -h / | awk '/\// {print $(NF-1)}' | sed 's/%//')
   if [ $DISK_USAGE -gt 80 ]; then
       echo "$(date): Disk usage is ${DISK_USAGE}%" >> /var/log/monitor.log
   fi
   ```

4. **设置定时任务**
   ```bash
   # 编辑crontab
   crontab -e
   
   # 添加监控任务（每5分钟执行一次）
   */5 * * * * /bin/bash /root/monitor.sh
   
   # 每天凌晨2点清理旧日志
   0 2 * * * find /var/www/backend/logs -name "*.log" -mtime +30 -delete
   ```

### 2. 数据库备份

1. **自动备份脚本**
   ```bash
   vi /root/db_backup.sh
   ```
   
   ```bash
   #!/bin/bash
   
   BACKUP_DIR="/backup/database"
   DATE=$(date +%Y%m%d_%H%M%S)
   DB_HOST="RDS内网地址"
   DB_NAME="your_app_db"
   DB_USER="app_user"
   
   # 创建备份目录
   mkdir -p $BACKUP_DIR
   
   # 执行备份
   pg_dump -h $DB_HOST -U $DB_USER -d $DB_NAME > $BACKUP_DIR/backup_$DATE.sql
   
   # 压缩备份文件
   gzip $BACKUP_DIR/backup_$DATE.sql
   
   # 删除7天前的备份
   find $BACKUP_DIR -name "backup_*.sql.gz" -mtime +7 -delete
   
   echo "Backup completed: backup_$DATE.sql.gz"
   ```

2. **设置备份定时任务**
   ```bash
   # 每天凌晨3点执行备份
   0 3 * * * /bin/bash /root/db_backup.sh >> /var/log/backup.log 2>&1
   ```

### 3. 阿里云监控告警

1. **开通云监控服务**
   - 在阿里云控制台搜索"云监控"
   - 免费开通基础监控服务

2. **设置告警规则**
   ```
   CPU使用率告警：
   - 指标：CPU使用率 > 80%
   - 持续时间：5分钟
   - 通知方式：短信 + 邮件
   
   内存使用率告警：
   - 指标：内存使用率 > 85%
   - 持续时间：5分钟
   
   磁盘使用率告警：
   - 指标：磁盘使用率 > 80%
   - 持续时间：10分钟
   
   外网流出带宽告警：
   - 指标：外网流出带宽 > 2.5M（3M带宽的80%）
   - 持续时间：5分钟
   ```

3. **设置通知联系人**
   - 添加手机号码和邮箱地址
   - 完成手机号和邮箱验证
   - 设置接收时间（建议7×24小时）

---

## 成本优化建议

### 1. 服务器成本优化

1. **实例规格优化**
   ```
   流量分析建议：
   - 日访问量 < 1000：1核2G经济型实例
   - 日访问量 1000-5000：2核4G通用型实例
   - 日访问量 5000-20000：4核8G计算型实例
   
   购买时长优化：
   - 3个月：无折扣
   - 6个月：9折
   - 1年：8.3折
   - 3年：5折
   ```

2. **带宽成本优化**
   ```
   带宽选择策略：
   - 固定带宽：适合流量稳定的应用
   - 按使用流量：适合流量波动较大的应用
   - 建议起始配置：3M固定带宽（约900元/年）
   ```

3. **存储成本优化**
   - 使用ESSD Entry云盘（性价比最高）
   - 定期清理无用文件和日志
   - 大文件存储可考虑OSS对象存储

### 2. CDN成本控制

1. **流量包购买**
   ```
   流量包选择：
   - 小型网站：100GB流量包 - 21元/年
   - 中型网站：500GB流量包 - 99元/年
   - 大型网站：1TB流量包 - 188元/年
   ```

2. **缓存策略优化**
   - 静态文件设置长期缓存（30天）
   - 合理设置缓存刷新规则
   - 使用图片格式优化（WebP）

### 3. 数据库成本优化

1. **RDS规格选择**
   ```
   数据量分析：
   - < 1GB数据：基础版1核2G - 约180元/年
   - 1-10GB数据：基础版2核4G - 约360元/年
   - > 10GB数据：高可用版 - 约600元/年起
   ```

2. **备份存储优化**
   - 设置合理的备份保留期（默认7天）
   - 使用增量备份减少存储费用

### 4. 监控费用预算

**月度费用明细（以中小型应用为例）：**
```
ECS服务器 (2核4G)：约33元/月
固定带宽 (3M)：约75元/月  
RDS数据库 (2核4G)：约33元/月
CDN流量费用：约10-30元/月
域名续费：约8元/月
SSL证书：免费

总计：约159-179元/月
年费预算：约1900-2150元
```

---

## 常见问题解决

### 1. 部署相关问题

**问题1：网站无法访问**
```
排查步骤：
1. ping 域名，检查DNS解析是否正确
2. telnet 服务器IP 80，检查端口是否开放
3. 检查Nginx配置语法：nginx -t
4. 查看Nginx错误日志：tail -f /var/log/nginx/error.log
5. 检查服务器防火墙和安全组配置
```

**问题2：SSL证书不生效**
```
解决方法：
1. 检查证书文件路径是否正确
2. 确认证书文件权限：chmod 644 *.pem *.key
3. 验证证书有效期：openssl x509 -in cert.pem -text -noout
4. 重启Nginx服务：systemctl restart nginx
```

**问题3：Node.js应用无法启动**
```
排查步骤：
1. 检查端口占用：netstat -tlnp | grep 3000
2. 查看PM2日志：pm2 logs
3. 检查环境变量配置
4. 验证数据库连接字符串
```

### 2. 性能相关问题

**问题1：网站加载速度慢**
```
优化方案：
1. 启用Gzip压缩
2. 优化图片格式和大小
3. 使用CDN加速静态资源
4. 开启浏览器缓存
5. 压缩CSS和JavaScript文件
```

**问题2：服务器CPU使用率过高**
```
解决方法：
1. 使用htop查看占用资源的进程
2. 优化数据库查询语句
3. 增加服务器实例规格
4. 实施应用缓存机制
```

**问题3：数据库连接超时**
```
解决方案：
1. 检查RDS白名单配置
2. 增加连接池大小
3. 优化长时间运行的SQL查询
4. 检查网络连接稳定性
```

### 3. 安全相关问题

**问题1：网站被攻击**
```
紧急处理：
1. 立即修改所有密码
2. 检查并清理恶意文件
3. 更新所有系统和应用补丁
4. 配置Web应用防火墙(WAF)
5. 分析日志查找攻击源
```

**问题2：SSL证书即将过期**
```
处理步骤：
1. 提前30天开始准备续期
2. 申请新的SSL证书
3. 在维护窗口期内更换证书
4. 验证新证书是否生效
```

### 4. 备案相关问题

**问题1：备案被驳回**
```
常见原因和解决方法：
1. 网站内容与备案信息不符 → 调整网站内容或重新备案
2. 联系方式无效 → 确保手机号码可正常接听
3. 资料不清晰 → 重新上传高清扫描件
4. 域名实名信息不匹配 → 完成域名实名认证
```

**问题2：备案号显示问题**
```
解决方法：
1. 在网站底部添加备案号
2. 备案号必须链接到工信部网站
3. 格式：京ICP备xxxxxxxx号-x
4. 字体颜色不能与背景色过于接近
```

### 5. 紧急故障处理流程

1. **故障发现**
   - 监控告警或用户反馈
   - 立即确认故障范围和影响程度

2. **快速响应**
   - 15分钟内开始处理
   - 通知相关负责人
   - 记录故障开始时间

3. **故障诊断**
   - 检查服务器状态
   - 查看应用日志
   - 分析监控数据

4. **故障恢复**
   - 执行预定的恢复方案
   - 必要时切换到备用方案
   - 验证服务恢复正常

5. **事后总结**
   - 分析故障根本原因
   - 制定预防措施
   - 更新应急预案

---

## 联系支持

### 技术支持渠道

1. **阿里云官方支持**
   - 工单系统：https://selfservice.console.aliyun.com
   - 电话支持：95187转1
   - 在线客服：阿里云控制台右上角

2. **社区资源**
   - 阿里云开发者社区：https://developer.aliyun.com
   - 阿里云帮助文档：https://help.aliyun.com
   - Stack Overflow：搜索相关技术问题

3. **应急联系方式**
   - 服务器宕机：立即提交工单 + 电话联系
   - 网络攻击：提交安全工单 + 联系安全专家
   - 备案问题：备案专线 95187转3

---

**手册版本：** v1.0
**最后更新：** 2025-08-26
**适用范围：** React+Supabase应用阿里云部署
**维护人员：** MiniMax Agent

---

*本手册旨在为非技术背景人员提供详细的操作指导。如遇到任何问题，请优先查阅本手册的常见问题部分，或联系技术支持获取帮助。*