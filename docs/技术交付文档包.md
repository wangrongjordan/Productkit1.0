# æŠ€æœ¯äº¤ä»˜æ–‡æ¡£åŒ…

**é¡¹ç›®åç§°ï¼š** [é¡¹ç›®åç§°]  
**ç‰ˆæœ¬ï¼š** v1.0.0  
**æ–‡æ¡£ç‰ˆæœ¬ï¼š** 1.0  
**åˆ›å»ºæ—¥æœŸï¼š** 2025å¹´8æœˆ26æ—¥  
**æœ€åæ›´æ–°ï¼š** 2025å¹´8æœˆ26æ—¥  
**ä½œè€…ï¼š** MiniMax Agent  
**æ–‡æ¡£çŠ¶æ€ï¼š** æ­£å¼ç‰ˆ  

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æºä»£ç ç»“æ„è¯´æ˜](#1-é¡¹ç›®æºä»£ç ç»“æ„è¯´æ˜)
2. [æŠ€æœ¯æ ˆå’Œä¾èµ–è¯´æ˜](#2-æŠ€æœ¯æ ˆå’Œä¾èµ–è¯´æ˜)
3. [æœ¬åœ°å¼€å‘ç¯å¢ƒæ­å»ºæŒ‡å—](#3-æœ¬åœ°å¼€å‘ç¯å¢ƒæ­å»ºæŒ‡å—)
4. [éƒ¨ç½²é…ç½®è¯´æ˜](#4-éƒ¨ç½²é…ç½®è¯´æ˜)
5. [APIæ¥å£æ–‡æ¡£](#5-apiæ¥å£æ–‡æ¡£)
6. [æ•°æ®åº“ç»“æ„è¯´æ˜](#6-æ•°æ®åº“ç»“æ„è¯´æ˜)
7. [ç³»ç»Ÿæ¶æ„å›¾å’ŒæŠ€æœ¯æ–‡æ¡£](#7-ç³»ç»Ÿæ¶æ„å›¾å’ŒæŠ€æœ¯æ–‡æ¡£)
8. [åç»­å¼€å‘å’Œç»´æŠ¤æŒ‡å—](#8-åç»­å¼€å‘å’Œç»´æŠ¤æŒ‡å—)

---

## ğŸ“„ æ–‡æ¡£æ¦‚è¿°

æœ¬æŠ€æœ¯äº¤ä»˜æ–‡æ¡£åŒ…ä¸ºæŠ€æœ¯äººå‘˜æä¾›äº†å®Œæ•´çš„é¡¹ç›®å¼€å‘ã€éƒ¨ç½²å’Œç»´æŠ¤ä¿¡æ¯ã€‚åŒ…å«äº†ä»ä»£ç ç»“æ„åˆ°ç³»ç»Ÿæ¶æ„ï¼Œä»ç¯å¢ƒæ­å»ºåˆ°åç»­ç»´æŠ¤çš„å…¨æ–¹ä½æŠ€æœ¯æŒ‡å¯¼ã€‚

### æ–‡æ¡£ä½¿ç”¨è¯´æ˜

- **å¼€å‘äººå‘˜**ï¼šé‡ç‚¹é˜…è¯»ç¬¬1ã€2ã€3ç« èŠ‚ï¼Œäº†è§£ä»£ç ç»“æ„å’Œå¼€å‘ç¯å¢ƒ
- **è¿ç»´äººå‘˜**ï¼šé‡ç‚¹é˜…è¯»ç¬¬4ã€7ã€8ç« èŠ‚ï¼Œäº†è§£éƒ¨ç½²å’Œç»´æŠ¤æ–¹æ¡ˆ
- **é¡¹ç›®ç»ç†**ï¼šå»ºè®®é˜…è¯»æ‰€æœ‰ç« èŠ‚ï¼Œå…¨é¢äº†è§£æŠ€æœ¯æ¶æ„
- **æ–°åŠ å…¥å›¢é˜Ÿæˆå‘˜**ï¼šæŒ‰é¡ºåºå®Œæ•´é˜…è¯»æ‰€æœ‰ç« èŠ‚

---

## 1. é¡¹ç›®æºä»£ç ç»“æ„è¯´æ˜

### 1.1 æ€»ä½“ç»“æ„æ¦‚è§ˆ

```
project-name/
â”œâ”€â”€ README.md                     # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ package.json                  # é¡¹ç›®ä¾èµ–é…ç½®
â”œâ”€â”€ .gitignore                    # Gitå¿½ç•¥æ–‡ä»¶é…ç½®
â”œâ”€â”€ .env.example                  # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ docker-compose.yml            # Dockerç¼–æ’é…ç½®
â”œâ”€â”€ Dockerfile                    # Dockeré•œåƒæ„å»ºæ–‡ä»¶
â”œâ”€â”€ nginx.conf                    # Nginxé…ç½®æ–‡ä»¶
â”œâ”€â”€ docs/                         # é¡¹ç›®æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ api/                      # APIæ–‡æ¡£
â”‚   â”œâ”€â”€ architecture/             # æ¶æ„è®¾è®¡æ–‡æ¡£
â”‚   â”œâ”€â”€ deployment/               # éƒ¨ç½²æ–‡æ¡£
â”‚   â””â”€â”€ development/              # å¼€å‘æ–‡æ¡£
â”œâ”€â”€ scripts/                      # è„šæœ¬æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ build.sh                  # æ„å»ºè„šæœ¬
â”‚   â”œâ”€â”€ deploy.sh                 # éƒ¨ç½²è„šæœ¬
â”‚   â”œâ”€â”€ backup.sh                 # å¤‡ä»½è„šæœ¬
â”‚   â””â”€â”€ init-db.sh                # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ config/                       # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ database.js               # æ•°æ®åº“é…ç½®
â”‚   â”œâ”€â”€ redis.js                  # Redisé…ç½®
â”‚   â”œâ”€â”€ email.js                  # é‚®ä»¶æœåŠ¡é…ç½®
â”‚   â””â”€â”€ logger.js                 # æ—¥å¿—é…ç½®
â”œâ”€â”€ src/                          # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ controllers/              # æ§åˆ¶å™¨å±‚
â”‚   â”‚   â”œâ”€â”€ auth.controller.js    # è®¤è¯æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ user.controller.js    # ç”¨æˆ·æ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ product.controller.js # äº§å“æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ services/                 # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”œâ”€â”€ auth.service.js       # è®¤è¯æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ user.service.js       # ç”¨æˆ·æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ email.service.js      # é‚®ä»¶æœåŠ¡
â”‚   â”‚   â””â”€â”€ file.service.js       # æ–‡ä»¶æœåŠ¡
â”‚   â”œâ”€â”€ models/                   # æ•°æ®æ¨¡å‹å±‚
â”‚   â”‚   â”œâ”€â”€ User.js               # ç”¨æˆ·æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ Product.js            # äº§å“æ¨¡å‹
â”‚   â”‚   â””â”€â”€ Order.js              # è®¢å•æ¨¡å‹
â”‚   â”œâ”€â”€ middleware/               # ä¸­é—´ä»¶ç›®å½•
â”‚   â”‚   â”œâ”€â”€ auth.middleware.js    # è®¤è¯ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ validation.middleware.js # æ•°æ®éªŒè¯ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ cors.middleware.js    # è·¨åŸŸä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ logger.middleware.js  # æ—¥å¿—ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ routes/                   # è·¯ç”±å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ index.js              # è·¯ç”±å…¥å£
â”‚   â”‚   â”œâ”€â”€ auth.routes.js        # è®¤è¯è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ user.routes.js        # ç”¨æˆ·è·¯ç”±
â”‚   â”‚   â””â”€â”€ product.routes.js     # äº§å“è·¯ç”±
â”‚   â”œâ”€â”€ utils/                    # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ validator.js          # æ•°æ®éªŒè¯å·¥å…·
â”‚   â”‚   â”œâ”€â”€ crypto.js             # åŠ å¯†å·¥å…·
â”‚   â”‚   â”œâ”€â”€ datetime.js           # æ—¥æœŸæ—¶é—´å·¥å…·
â”‚   â”‚   â””â”€â”€ response.js           # å“åº”æ ¼å¼åŒ–å·¥å…·
â”‚   â”œâ”€â”€ database/                 # æ•°æ®åº“ç›¸å…³
â”‚   â”‚   â”œâ”€â”€ migrations/           # æ•°æ®åº“è¿ç§»æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ seeders/              # æ•°æ®ç§å­æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ connection.js         # æ•°æ®åº“è¿æ¥é…ç½®
â”‚   â””â”€â”€ app.js                    # åº”ç”¨ç¨‹åºå…¥å£
â”œâ”€â”€ frontend/                     # å‰ç«¯ä»£ç ç›®å½•
â”‚   â”œâ”€â”€ public/                   # é™æ€èµ„æº
â”‚   â”‚   â”œâ”€â”€ index.html            # HTMLå…¥å£æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ favicon.ico           # ç½‘ç«™å›¾æ ‡
â”‚   â”‚   â””â”€â”€ assets/               # é™æ€èµ„æºæ–‡ä»¶
â”‚   â”œâ”€â”€ src/                      # å‰ç«¯æºä»£ç 
â”‚   â”‚   â”œâ”€â”€ components/           # ç»„ä»¶ç›®å½•
â”‚   â”‚   â”‚   â”œâ”€â”€ common/           # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ forms/            # è¡¨å•ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ layout/           # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ pages/                # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/             # è®¤è¯é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/        # ä»ªè¡¨æ¿é¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ products/         # äº§å“é¡µé¢
â”‚   â”‚   â”œâ”€â”€ services/             # APIæœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ api.js            # APIåŸºç¡€é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.service.js   # è®¤è¯APIæœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ product.service.js # äº§å“APIæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ store/                # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ index.js          # Storeå…¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.store.js     # è®¤è¯çŠ¶æ€
â”‚   â”‚   â”‚   â””â”€â”€ product.store.js  # äº§å“çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ styles/               # æ ·å¼æ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ global.css        # å…¨å±€æ ·å¼
â”‚   â”‚   â”‚   â”œâ”€â”€ variables.css     # CSSå˜é‡
â”‚   â”‚   â”‚   â””â”€â”€ components/       # ç»„ä»¶æ ·å¼
â”‚   â”‚   â”œâ”€â”€ utils/                # å‰ç«¯å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â”œâ”€â”€ constants.js      # å¸¸é‡å®šä¹‰
â”‚   â”‚   â”‚   â”œâ”€â”€ helpers.js        # è¾…åŠ©å‡½æ•°
â”‚   â”‚   â”‚   â””â”€â”€ validators.js     # è¡¨å•éªŒè¯
â”‚   â”‚   â””â”€â”€ App.js                # å‰ç«¯åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ package.json              # å‰ç«¯ä¾èµ–é…ç½®
â”‚   â””â”€â”€ webpack.config.js         # Webpacké…ç½®
â”œâ”€â”€ tests/                        # æµ‹è¯•æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ unit/                     # å•å…ƒæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ controllers/          # æ§åˆ¶å™¨æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ services/             # æœåŠ¡æµ‹è¯•
â”‚   â”‚   â””â”€â”€ utils/                # å·¥å…·å‡½æ•°æµ‹è¯•
â”‚   â”œâ”€â”€ integration/              # é›†æˆæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ api/                  # APIæµ‹è¯•
â”‚   â”‚   â””â”€â”€ database/             # æ•°æ®åº“æµ‹è¯•
â”‚   â”œâ”€â”€ fixtures/                 # æµ‹è¯•æ•°æ®
â”‚   â””â”€â”€ helpers/                  # æµ‹è¯•è¾…åŠ©å‡½æ•°
â””â”€â”€ logs/                         # æ—¥å¿—æ–‡ä»¶ç›®å½•
    â”œâ”€â”€ access.log                # è®¿é—®æ—¥å¿—
    â”œâ”€â”€ error.log                 # é”™è¯¯æ—¥å¿—
    â””â”€â”€ application.log           # åº”ç”¨æ—¥å¿—
```

### 1.2 æ ¸å¿ƒç›®å½•è¯¦ç»†è¯´æ˜

#### 1.2.1 åç«¯æºä»£ç ç›®å½•ï¼ˆsrc/ï¼‰

**æ§åˆ¶å™¨å±‚ï¼ˆcontrollers/ï¼‰**
- è´Ÿè´£å¤„ç†HTTPè¯·æ±‚å’Œå“åº”
- è°ƒç”¨ç›¸åº”çš„æœåŠ¡å±‚æ–¹æ³•
- è¿›è¡Œè¯·æ±‚å‚æ•°éªŒè¯
- è¿”å›æ ‡å‡†åŒ–çš„JSONå“åº”

**æœåŠ¡å±‚ï¼ˆservices/ï¼‰**
- åŒ…å«æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
- å¤„ç†æ•°æ®è½¬æ¢å’Œä¸šåŠ¡è§„åˆ™
- è°ƒç”¨æ•°æ®æ¨¡å‹è¿›è¡Œæ•°æ®æ“ä½œ
- é›†æˆç¬¬ä¸‰æ–¹æœåŠ¡

**æ¨¡å‹å±‚ï¼ˆmodels/ï¼‰**
- å®šä¹‰æ•°æ®ç»“æ„å’Œå…³ç³»
- åŒ…å«æ•°æ®åº“æ“ä½œæ–¹æ³•
- å®ç°æ•°æ®éªŒè¯è§„åˆ™
- ç®¡ç†æ•°æ®åº“è¿æ¥

**ä¸­é—´ä»¶ï¼ˆmiddleware/ï¼‰**
- è¯·æ±‚é¢„å¤„ç†å’Œåå¤„ç†
- èº«ä»½éªŒè¯å’Œæˆæƒ
- é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- è¯·æ±‚é™æµå’Œå®‰å…¨é˜²æŠ¤

#### 1.2.2 å‰ç«¯ä»£ç ç›®å½•ï¼ˆfrontend/ï¼‰

**ç»„ä»¶ç›®å½•ï¼ˆcomponents/ï¼‰**
- `common/`ï¼šå¯å¤ç”¨çš„é€šç”¨ç»„ä»¶
- `forms/`ï¼šè¡¨å•ç›¸å…³ç»„ä»¶
- `layout/`ï¼šé¡µé¢å¸ƒå±€ç»„ä»¶

**é¡µé¢ç›®å½•ï¼ˆpages/ï¼‰**
- æŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡çš„é¡µé¢ç»„ä»¶
- æ¯ä¸ªé¡µé¢åŒ…å«è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘
- ä½¿ç”¨ç»„åˆçš„æ–¹å¼æ„å»ºå¤æ‚é¡µé¢

**çŠ¶æ€ç®¡ç†ï¼ˆstore/ï¼‰**
- å…¨å±€çŠ¶æ€ç®¡ç†
- æŒ‰æ¨¡å—åˆ’åˆ†çŠ¶æ€
- åŒ…å«actionså’Œmutations

#### 1.2.3 é…ç½®å’Œè„šæœ¬ç›®å½•

**é…ç½®ç›®å½•ï¼ˆconfig/ï¼‰**
- æ•°æ®åº“è¿æ¥é…ç½®
- ç¬¬ä¸‰æ–¹æœåŠ¡é…ç½®
- ç¯å¢ƒç›¸å…³é…ç½®
- æ—¥å¿—é…ç½®

**è„šæœ¬ç›®å½•ï¼ˆscripts/ï¼‰**
- è‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬
- éƒ¨ç½²è„šæœ¬
- æ•°æ®åº“è¿ç§»è„šæœ¬
- å¤‡ä»½å’Œæ¢å¤è„šæœ¬

### 1.3 ä»£ç ç»„ç»‡è§„èŒƒ

#### 1.3.1 å‘½åè§„èŒƒ

**æ–‡ä»¶å‘½å**
- ä½¿ç”¨å°å†™å­—æ¯å’Œè¿å­—ç¬¦ï¼š`user-controller.js`
- æ¨¡å‹æ–‡ä»¶ä½¿ç”¨å¤§é©¼å³°ï¼š`User.js`
- æµ‹è¯•æ–‡ä»¶æ·»åŠ `.test`æˆ–`.spec`åç¼€

**å˜é‡å’Œå‡½æ•°å‘½å**
- ä½¿ç”¨é©¼å³°å‘½åæ³•ï¼š`getUserById`
- å¸¸é‡ä½¿ç”¨å¤§å†™å­—æ¯å’Œä¸‹åˆ’çº¿ï¼š`API_BASE_URL`
- ç§æœ‰æ–¹æ³•å’Œå˜é‡æ·»åŠ ä¸‹åˆ’çº¿å‰ç¼€ï¼š`_privateMethod`

**æ¥å£å’Œè·¯ç”±å‘½å**
- RESTfulé£æ ¼ï¼š`GET /api/users`, `POST /api/users`
- ç‰ˆæœ¬åŒ–ï¼š`/api/v1/users`
- ä½¿ç”¨å¤æ•°å½¢å¼ï¼š`/users`è€Œä¸æ˜¯`/user`

#### 1.3.2 ä»£ç ç»“æ„è§„èŒƒ

**æ¨¡å—å¯¼å‡ºè§„èŒƒ**
```javascript
// å•ä¸€å¯¼å‡º
module.exports = UserController;

// å¤šä¸ªå¯¼å‡º
module.exports = {
  createUser,
  getUserById,
  updateUser,
  deleteUser
};

// ES6æ¨¡å—å¯¼å‡º
export default UserService;
export { createUser, updateUser };
```

**é”™è¯¯å¤„ç†è§„èŒƒ**
```javascript
// ç»Ÿä¸€é”™è¯¯å¤„ç†æ ¼å¼
class AppError extends Error {
  constructor(message, statusCode) {
    super(message);
    this.statusCode = statusCode;
    this.status = `${statusCode}`.startsWith('4') ? 'fail' : 'error';
    this.isOperational = true;
  }
}
```

### 1.4 ç‰ˆæœ¬æ§åˆ¶ç­–ç•¥

#### 1.4.1 åˆ†æ”¯ç®¡ç†ç­–ç•¥

**ä¸»è¦åˆ†æ”¯**
- `main/master`ï¼šç”Ÿäº§ç¯å¢ƒåˆ†æ”¯
- `develop`ï¼šå¼€å‘ç¯å¢ƒåˆ†æ”¯
- `staging`ï¼šé¢„å‘å¸ƒç¯å¢ƒåˆ†æ”¯

**åŠŸèƒ½åˆ†æ”¯**
- `feature/åŠŸèƒ½åç§°`ï¼šæ–°åŠŸèƒ½å¼€å‘
- `bugfix/bugç¼–å·`ï¼šBugä¿®å¤
- `hotfix/ç´§æ€¥ä¿®å¤`ï¼šç”Ÿäº§ç¯å¢ƒç´§æ€¥ä¿®å¤

**åˆ†æ”¯å‘½åè§„èŒƒ**
```
feature/user-authentication
bugfix/login-validation
hotfix/security-patch-001
```

#### 1.4.2 æäº¤ä¿¡æ¯è§„èŒƒ

```
<type>(<scope>): <subject>

<body>

<footer>
```

**æäº¤ç±»å‹**
- `feat`ï¼šæ–°åŠŸèƒ½
- `fix`ï¼šBugä¿®å¤
- `docs`ï¼šæ–‡æ¡£æ›´æ–°
- `style`ï¼šä»£ç æ ¼å¼åŒ–
- `refactor`ï¼šä»£ç é‡æ„
- `test`ï¼šæµ‹è¯•ç›¸å…³
- `chore`ï¼šæ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·å˜åŠ¨

**ç¤ºä¾‹**
```
feat(auth): add JWT token refresh mechanism

- Implement automatic token refresh
- Add refresh token validation
- Update authentication middleware

Closes #123
```

---

## 2. æŠ€æœ¯æ ˆå’Œä¾èµ–è¯´æ˜

### 2.1 æŠ€æœ¯æ¶æ„æ€»è§ˆ

æœ¬é¡¹ç›®é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼ŒåŸºäºç°ä»£åŒ–çš„æŠ€æœ¯æ ˆæ„å»ºï¼Œç¡®ä¿é«˜æ€§èƒ½ã€é«˜å¯ç”¨æ€§å’Œè‰¯å¥½çš„å¯ç»´æŠ¤æ€§ã€‚

### 2.2 åç«¯æŠ€æœ¯æ ˆ

#### 2.2.1 æ ¸å¿ƒæ¡†æ¶å’Œè¿è¡Œç¯å¢ƒ

**Node.js 18.x LTS**
- **é€‰æ‹©ç†ç”±**ï¼šLTSç‰ˆæœ¬ç¨³å®šæ€§å¥½ï¼Œç”Ÿæ€å®Œå–„ï¼Œæ€§èƒ½ä¼˜å¼‚
- **ä¸»è¦ç‰¹æ€§**ï¼šéé˜»å¡I/Oã€äº‹ä»¶é©±åŠ¨ã€è½»é‡çº§
- **ç‰ˆæœ¬è¦æ±‚**ï¼šNode.js >= 18.0.0

**Express.js 4.18.x**
```json
{
  "express": "^4.18.2"
}
```
- **é€‰æ‹©ç†ç”±**ï¼šè½»é‡çº§ã€çµæ´»ã€ä¸­é—´ä»¶ç”Ÿæ€ä¸°å¯Œ
- **ä¸»è¦åŠŸèƒ½**ï¼šHTTPæœåŠ¡å™¨ã€è·¯ç”±ç®¡ç†ã€ä¸­é—´ä»¶æ”¯æŒ
- **ç›¸å…³ä¸­é—´ä»¶**ï¼š
  - `express-rate-limit`ï¼šè¯·æ±‚é™æµ
  - `express-validator`ï¼šæ•°æ®éªŒè¯
  - `compression`ï¼šå“åº”å‹ç¼©

#### 2.2.2 æ•°æ®åº“å’ŒæŒä¹…åŒ–

**PostgreSQL 15.x**
```json
{
  "pg": "^8.11.3",
  "pg-hstore": "^2.3.4"
}
```
- **é€‰æ‹©ç†ç”±**ï¼šACIDäº‹åŠ¡æ”¯æŒã€JSONæ•°æ®ç±»å‹ã€å¼ºå¤§çš„æŸ¥è¯¢èƒ½åŠ›
- **è¿æ¥æ± **ï¼šä½¿ç”¨`pg-pool`ç®¡ç†è¿æ¥
- **è¿ç§»å·¥å…·**ï¼š`knex.js`æˆ–`sequelize`

**Redis 7.x**
```json
{
  "redis": "^4.6.8",
  "ioredis": "^5.3.2"
}
```
- **é€‰æ‹©ç†ç”±**ï¼šé«˜æ€§èƒ½ç¼“å­˜ã€ä¼šè¯å­˜å‚¨ã€æ¶ˆæ¯é˜Ÿåˆ—
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - ä¼šè¯å­˜å‚¨
  - APIå“åº”ç¼“å­˜
  - åˆ†å¸ƒå¼é”
  - å®æ—¶æ•°æ®ç¼“å­˜

**Sequelize ORM**
```json
{
  "sequelize": "^6.32.1",
  "sequelize-cli": "^6.6.1"
}
```
- **é€‰æ‹©ç†ç”±**ï¼šæˆç†Ÿçš„ORMã€æ”¯æŒå¤šç§æ•°æ®åº“ã€è¿ç§»ç®¡ç†
- **åŠŸèƒ½**ï¼šæ¨¡å‹å®šä¹‰ã€å…³ç³»æ˜ å°„ã€æŸ¥è¯¢ä¼˜åŒ–

#### 2.2.3 èº«ä»½éªŒè¯å’Œå®‰å…¨

**JWTè®¤è¯**
```json
{
  "jsonwebtoken": "^9.0.2",
  "bcryptjs": "^2.4.3"
}
```
- **JWT**ï¼šæ— çŠ¶æ€è®¤è¯ã€è·¨åŸŸæ”¯æŒ
- **bcryptjs**ï¼šå¯†ç åŠ å¯†å’ŒéªŒè¯
- **passport.js**ï¼šå¤šç§è®¤è¯ç­–ç•¥æ”¯æŒ

**å®‰å…¨ä¸­é—´ä»¶**
```json
{
  "helmet": "^7.0.0",
  "cors": "^2.8.5",
  "express-mongo-sanitize": "^2.2.0"
}
```
- **helmet**ï¼šHTTPå®‰å…¨å¤´è®¾ç½®
- **cors**ï¼šè·¨åŸŸèµ„æºå…±äº«é…ç½®
- **mongo-sanitize**ï¼šé˜²æ­¢NoSQLæ³¨å…¥

#### 2.2.4 APIæ–‡æ¡£å’Œæµ‹è¯•

**APIæ–‡æ¡£**
```json
{
  "swagger-jsdoc": "^6.2.8",
  "swagger-ui-express": "^5.0.0"
}
```
- **swagger-jsdoc**ï¼šä»£ç æ³¨é‡Šç”ŸæˆAPIæ–‡æ¡£
- **swagger-ui-express**ï¼šAPIæ–‡æ¡£ç•Œé¢

**æµ‹è¯•æ¡†æ¶**
```json
{
  "jest": "^29.6.4",
  "supertest": "^6.3.3",
  "eslint": "^8.47.0"
}
```
- **Jest**ï¼šå•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- **Supertest**ï¼šAPIæµ‹è¯•
- **ESLint**ï¼šä»£ç è´¨é‡æ£€æŸ¥

#### 2.2.5 æ—¥å¿—å’Œç›‘æ§

**æ—¥å¿—ç®¡ç†**
```json
{
  "winston": "^3.10.0",
  "morgan": "^1.10.0"
}
```
- **winston**ï¼šç»“æ„åŒ–æ—¥å¿—è®°å½•
- **morgan**ï¼šHTTPè¯·æ±‚æ—¥å¿—

**æ€§èƒ½ç›‘æ§**
```json
{
  "prom-client": "^14.2.0"
}
```
- **prometheuså®¢æˆ·ç«¯**ï¼šæŒ‡æ ‡æ”¶é›†å’Œç›‘æ§

### 2.3 å‰ç«¯æŠ€æœ¯æ ˆ

#### 2.3.1 æ ¸å¿ƒæ¡†æ¶

**React 18.x**
```json
{
  "react": "^18.2.0",
  "react-dom": "^18.2.0",
  "react-router-dom": "^6.15.0"
}
```
- **é€‰æ‹©ç†ç”±**ï¼šç»„ä»¶åŒ–ã€è™šæ‹ŸDOMã€ç”Ÿæ€å®Œå–„
- **Router**ï¼šå•é¡µåº”ç”¨è·¯ç”±ç®¡ç†
- **Hooks**ï¼šå‡½æ•°å¼ç»„ä»¶çŠ¶æ€ç®¡ç†

**TypeScript**
```json
{
  "typescript": "^5.1.6",
  "@types/react": "^18.2.20"
}
```
- **é€‰æ‹©ç†ç”±**ï¼šç±»å‹å®‰å…¨ã€IDEæ”¯æŒã€ä»£ç å¯ç»´æŠ¤æ€§
- **é…ç½®**ï¼šä¸¥æ ¼æ¨¡å¼ï¼Œæ”¯æŒES2020

#### 2.3.2 UIç»„ä»¶å’Œæ ·å¼

**Ant Design**
```json
{
  "antd": "^5.8.6",
  "@ant-design/icons": "^5.2.6"
}
```
- **é€‰æ‹©ç†ç”±**ï¼šä¸°å¯Œçš„ç»„ä»¶åº“ã€ä¼ä¸šçº§è®¾è®¡è¯­è¨€
- **ç»„ä»¶**ï¼šè¡¨å•ã€è¡¨æ ¼ã€å¯¼èˆªã€åé¦ˆç»„ä»¶

**æ ·å¼æ–¹æ¡ˆ**
```json
{
  "styled-components": "^6.0.7",
  "tailwindcss": "^3.3.3"
}
```
- **styled-components**ï¼šCSS-in-JSè§£å†³æ–¹æ¡ˆ
- **Tailwind CSS**ï¼šåŸå­åŒ–CSSæ¡†æ¶

#### 2.3.3 çŠ¶æ€ç®¡ç†

**Redux Toolkit**
```json
{
  "redux": "^4.2.1",
  "@reduxjs/toolkit": "^1.9.5",
  "react-redux": "^8.1.2"
}
```
- **é€‰æ‹©ç†ç”±**ï¼šå¯é¢„æµ‹çš„çŠ¶æ€ç®¡ç†ã€æ—¶é—´æ—…è¡Œè°ƒè¯•
- **RTK Query**ï¼šæ•°æ®è·å–å’Œç¼“å­˜

**React Query**
```json
{
  "@tanstack/react-query": "^4.32.6"
}
```
- **é€‰æ‹©ç†ç”±**ï¼šæœåŠ¡ç«¯çŠ¶æ€ç®¡ç†ã€è‡ªåŠ¨ç¼“å­˜ã€é‡æ–°è·å–

#### 2.3.4 å¼€å‘å’Œæ„å»ºå·¥å…·

**Vite**
```json
{
  "vite": "^4.4.9",
  "@vitejs/plugin-react": "^4.0.4"
}
```
- **é€‰æ‹©ç†ç”±**ï¼šå¿«é€Ÿçš„å¼€å‘æœåŠ¡å™¨ã€çƒ­æ›´æ–°ã€ç°ä»£åŒ–æ„å»º
- **æ’ä»¶ç”Ÿæ€**ï¼šReactæ”¯æŒã€TypeScriptæ”¯æŒ

**ä»£ç è´¨é‡å·¥å…·**
```json
{
  "eslint": "^8.47.0",
  "prettier": "^3.0.2",
  "husky": "^8.0.3",
  "lint-staged": "^13.2.3"
}
```
- **ESLint**ï¼šä»£ç è§„èŒƒæ£€æŸ¥
- **Prettier**ï¼šä»£ç æ ¼å¼åŒ–
- **Husky**ï¼šGité’©å­ç®¡ç†
- **lint-staged**ï¼šæš‚å­˜æ–‡ä»¶æ£€æŸ¥

### 2.4 DevOpså’ŒåŸºç¡€è®¾æ–½

#### 2.4.1 å®¹å™¨åŒ–

**Docker**
```dockerfile
# Dockerfileç¤ºä¾‹
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
EXPOSE 3000
CMD ["npm", "start"]
```

**Docker Compose**
```yaml
# docker-compose.yml
version: '3.8'
services:
  app:
    build: .
    ports:
      - "3000:3000"
  postgres:
    image: postgres:15
    environment:
      POSTGRES_DB: myapp
      POSTGRES_PASSWORD: password
  redis:
    image: redis:7-alpine
```

#### 2.4.2 CI/CDå·¥å…·

**GitHub Actions / GitLab CI**
- è‡ªåŠ¨åŒ–æµ‹è¯•å’Œéƒ¨ç½²
- ä»£ç è´¨é‡æ£€æŸ¥
- å®‰å…¨æ‰«æ
- Dockeré•œåƒæ„å»º

**éƒ¨ç½²å·¥å…·**
- **Kubernetes**ï¼šå®¹å™¨ç¼–æ’
- **Helm**ï¼šåº”ç”¨åŒ…ç®¡ç†
- **Terraform**ï¼šåŸºç¡€è®¾æ–½å³ä»£ç 

#### 2.4.3 ç›‘æ§å’Œæ—¥å¿—

**ç›‘æ§ç³»ç»Ÿ**
- **Prometheus**ï¼šæŒ‡æ ‡æ”¶é›†
- **Grafana**ï¼šå¯è§†åŒ–ç›‘æ§é¢æ¿
- **AlertManager**ï¼šå‘Šè­¦ç®¡ç†

**æ—¥å¿—ç³»ç»Ÿ**
- **ELK Stack**ï¼šæ—¥å¿—æ”¶é›†å’Œåˆ†æ
- **Fluentd**ï¼šæ—¥å¿—è·¯ç”±
- **Filebeat**ï¼šæ—¥å¿—é‡‡é›†

### 2.5 ç¬¬ä¸‰æ–¹æœåŠ¡å’Œé›†æˆ

#### 2.5.1 äº‘æœåŠ¡

**AWSæœåŠ¡**
- **EC2**ï¼šè™šæ‹ŸæœåŠ¡å™¨
- **RDS**ï¼šæ‰˜ç®¡æ•°æ®åº“
- **S3**ï¼šå¯¹è±¡å­˜å‚¨
- **CloudFront**ï¼šCDNåˆ†å‘
- **Lambda**ï¼šæ— æœåŠ¡å™¨è®¡ç®—

**é˜¿é‡Œäº‘æœåŠ¡**
- **ECS**ï¼šäº‘æœåŠ¡å™¨
- **RDS**ï¼šäº‘æ•°æ®åº“
- **OSS**ï¼šå¯¹è±¡å­˜å‚¨
- **CDN**ï¼šå†…å®¹åˆ†å‘ç½‘ç»œ

#### 2.5.2 ç¬¬ä¸‰æ–¹é›†æˆ

**æ”¯ä»˜æœåŠ¡**
```json
{
  "stripe": "^12.18.0",
  "alipay-sdk": "^3.4.0"
}
```

**æ¶ˆæ¯é€šçŸ¥**
```json
{
  "nodemailer": "^6.9.4",
  "twilio": "^4.14.0"
}
```

**æ–‡ä»¶ä¸Šä¼ **
```json
{
  "multer": "^1.4.5-lts.1",
  "aws-sdk": "^2.1447.0"
}
```

### 2.6 ä¾èµ–ç‰ˆæœ¬ç®¡ç†

#### 2.6.1 ç‰ˆæœ¬é”å®šç­–ç•¥

**package.jsonç‰ˆæœ¬èŒƒå›´**
```json
{
  "dependencies": {
    "express": "^4.18.2",
    "react": "~18.2.0",
    "lodash": "4.17.21"
  }
}
```

**ç‰ˆæœ¬ç¬¦å·è¯´æ˜**
- `^4.18.2`ï¼šå…¼å®¹æ€§æ›´æ–°ï¼ˆ4.x.xï¼‰
- `~18.2.0`ï¼šè¡¥ä¸æ›´æ–°ï¼ˆ18.2.xï¼‰
- `4.17.21`ï¼šç²¾ç¡®ç‰ˆæœ¬

#### 2.6.2 ä¾èµ–æ›´æ–°ç­–ç•¥

**å®šæœŸæ›´æ–°è®¡åˆ’**
- **æœˆåº¦**ï¼šè¡¥ä¸ç‰ˆæœ¬æ›´æ–°
- **å­£åº¦**ï¼šå°ç‰ˆæœ¬æ›´æ–°
- **å¹´åº¦**ï¼šä¸»ç‰ˆæœ¬æ›´æ–°

**å®‰å…¨æ›´æ–°**
- ä½¿ç”¨`npm audit`æ£€æŸ¥å®‰å…¨æ¼æ´
- åŠæ—¶åº”ç”¨å®‰å…¨è¡¥ä¸
- ç›‘æ§CVEæ•°æ®åº“

### 2.7 æ€§èƒ½å’Œä¼˜åŒ–

#### 2.7.1 å‰ç«¯ä¼˜åŒ–

**ä»£ç åˆ†å‰²**
```javascript
// React lazy loading
const ProductPage = lazy(() => import('./pages/ProductPage'));
```

**èµ„æºä¼˜åŒ–**
- å›¾ç‰‡å‹ç¼©å’Œæ ¼å¼ä¼˜åŒ–
- CSSå’ŒJSæ–‡ä»¶å‹ç¼©
- æµè§ˆå™¨ç¼“å­˜ç­–ç•¥

#### 2.7.2 åç«¯ä¼˜åŒ–

**æ•°æ®åº“ä¼˜åŒ–**
- ç´¢å¼•ä¼˜åŒ–
- æŸ¥è¯¢ä¼˜åŒ–
- è¿æ¥æ± é…ç½®

**APIä¼˜åŒ–**
- å“åº”ç¼“å­˜
- åˆ†é¡µæŸ¥è¯¢
- æ•°æ®å‹ç¼©

---

## 3. æœ¬åœ°å¼€å‘ç¯å¢ƒæ­å»ºæŒ‡å—

### 3.1 ç¯å¢ƒè¦æ±‚

#### 3.1.1 ç³»ç»Ÿè¦æ±‚

**æ“ä½œç³»ç»Ÿæ”¯æŒ**
- Windows 10/11 (x64)
- macOS 12.0+ (Intel/Apple Silicon)
- Linux (Ubuntu 20.04+, CentOS 8+)

**ç¡¬ä»¶è¦æ±‚**
- CPU: 4æ ¸å¿ƒä»¥ä¸Š
- å†…å­˜: 8GBä»¥ä¸Šï¼ˆæ¨è16GBï¼‰
- ç¡¬ç›˜: 20GBå¯ç”¨ç©ºé—´
- ç½‘ç»œ: ç¨³å®šçš„ç½‘ç»œè¿æ¥

#### 3.1.2 å¿…éœ€è½¯ä»¶ç‰ˆæœ¬

| è½¯ä»¶ | ç‰ˆæœ¬è¦æ±‚ | ä¸‹è½½åœ°å€ |
|------|----------|----------|
| Node.js | 18.0.0+ | https://nodejs.org |
| npm | 9.0.0+ | éšNode.jså®‰è£… |
| Git | 2.30.0+ | https://git-scm.com |
| Docker | 20.10.0+ | https://docker.com |
| Docker Compose | 2.0.0+ | https://docs.docker.com/compose |

### 3.2 è½¯ä»¶å®‰è£…æŒ‡å—

#### 3.2.1 Node.jså®‰è£…

**Windowså®‰è£…**
```bash
# ä¸‹è½½å¹¶å®‰è£…Node.js LTSç‰ˆæœ¬
# è®¿é—® https://nodejs.org ä¸‹è½½Windowså®‰è£…åŒ…
# è¿è¡Œå®‰è£…ç¨‹åºï¼ŒæŒ‰ç…§æç¤ºå®Œæˆå®‰è£…

# éªŒè¯å®‰è£…
node --version
npm --version
```

**macOSå®‰è£…**
```bash
# ä½¿ç”¨Homebrewå®‰è£…
brew install node@18

# æˆ–ä¸‹è½½å®˜æ–¹å®‰è£…åŒ…
# è®¿é—® https://nodejs.org ä¸‹è½½macOSå®‰è£…åŒ…

# éªŒè¯å®‰è£…
node --version
npm --version
```

**Linuxå®‰è£…**
```bash
# Ubuntu/Debian
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# CentOS/RHEL
curl -fsSL https://rpm.nodesource.com/setup_18.x | sudo bash -
sudo yum install -y nodejs

# éªŒè¯å®‰è£…
node --version
npm --version
```

#### 3.2.2 Dockerå®‰è£…

**Windowså®‰è£…**
```bash
# ä¸‹è½½Docker Desktop for Windows
# è®¿é—® https://docs.docker.com/desktop/windows/install/
# ä¸‹è½½å¹¶è¿è¡Œå®‰è£…ç¨‹åº

# éªŒè¯å®‰è£…
docker --version
docker-compose --version
```

**macOSå®‰è£…**
```bash
# ä¸‹è½½Docker Desktop for Mac
# è®¿é—® https://docs.docker.com/desktop/mac/install/

# æˆ–ä½¿ç”¨Homebrew
brew install --cask docker

# éªŒè¯å®‰è£…
docker --version
docker-compose --version
```

**Linuxå®‰è£…**
```bash
# Ubuntuå®‰è£…Docker
sudo apt-get update
sudo apt-get install -y apt-transport-https ca-certificates curl gnupg lsb-release

curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg

echo "deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

sudo apt-get update
sudo apt-get install -y docker-ce docker-ce-cli containerd.io

# å®‰è£…Docker Compose
sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose

# éªŒè¯å®‰è£…
docker --version
docker-compose --version
```

#### 3.2.3 å¼€å‘å·¥å…·æ¨è

**ä»£ç ç¼–è¾‘å™¨**
```bash
# Visual Studio Code (æ¨è)
# ä¸‹è½½åœ°å€ï¼šhttps://code.visualstudio.com/

# æ¨èæ‰©å±•æ’ä»¶
# - ES7+ React/Redux/React-Native snippets
# - Prettier - Code formatter
# - ESLint
# - Auto Rename Tag
# - Thunder Client (APIæµ‹è¯•)
# - Docker
# - GitLens
```

**æ•°æ®åº“ç®¡ç†å·¥å…·**
```bash
# DBeaver (å…è´¹ï¼Œæ”¯æŒå¤šç§æ•°æ®åº“)
# ä¸‹è½½åœ°å€ï¼šhttps://dbeaver.io/

# pgAdmin (PostgreSQLä¸“ç”¨)
# ä¸‹è½½åœ°å€ï¼šhttps://www.pgadmin.org/

# Redis Desktop Manager
# ä¸‹è½½åœ°å€ï¼šhttps://resp.app/
```

### 3.3 é¡¹ç›®å…‹éš†å’Œå®‰è£…

#### 3.3.1 ä»£ç å…‹éš†

```bash
# å…‹éš†é¡¹ç›®ä»£ç 
git clone https://github.com/your-organization/your-project.git
cd your-project

# æŸ¥çœ‹åˆ†æ”¯
git branch -a

# åˆ‡æ¢åˆ°å¼€å‘åˆ†æ”¯
git checkout develop
```

#### 3.3.2 ç¯å¢ƒé…ç½®

**åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶**
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘ç¯å¢ƒå˜é‡
nano .env
```

**ç¯å¢ƒå˜é‡é…ç½®ç¤ºä¾‹**
```bash
# .env æ–‡ä»¶å†…å®¹
# åº”ç”¨é…ç½®
NODE_ENV=development
PORT=3000
APP_NAME=MyApp
APP_URL=http://localhost:3000

# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=5432
DB_NAME=myapp_dev
DB_USERNAME=postgres
DB_PASSWORD=password

# Redisé…ç½®
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# JWTé…ç½®
JWT_SECRET=your-super-secret-jwt-key
JWT_EXPIRES_IN=7d
JWT_REFRESH_EXPIRES_IN=30d

# é‚®ä»¶é…ç½®
MAIL_HOST=smtp.gmail.com
MAIL_PORT=587
MAIL_USERNAME=your-email@gmail.com
MAIL_PASSWORD=your-app-password

# æ–‡ä»¶ä¸Šä¼ é…ç½®
UPLOAD_PATH=./uploads
MAX_FILE_SIZE=10485760

# ç¬¬ä¸‰æ–¹æœåŠ¡é…ç½®
AWS_ACCESS_KEY_ID=your-aws-access-key
AWS_SECRET_ACCESS_KEY=your-aws-secret-key
AWS_REGION=us-east-1
AWS_S3_BUCKET=your-s3-bucket

# APIé…ç½®
API_RATE_LIMIT=100
API_RATE_WINDOW=15
```

#### 3.3.3 ä¾èµ–å®‰è£…

**åç«¯ä¾èµ–å®‰è£…**
```bash
# å®‰è£…åç«¯ä¾èµ–
npm install

# æˆ–ä½¿ç”¨npm ciè¿›è¡Œå¿«é€Ÿå®‰è£…
npm ci

# å…¨å±€å®‰è£…å¼€å‘å·¥å…·
npm install -g nodemon
npm install -g sequelize-cli
```

**å‰ç«¯ä¾èµ–å®‰è£…**
```bash
# è¿›å…¥å‰ç«¯ç›®å½•
cd frontend

# å®‰è£…å‰ç«¯ä¾èµ–
npm install

# è¿”å›é¡¹ç›®æ ¹ç›®å½•
cd ..
```

### 3.4 æ•°æ®åº“è®¾ç½®

#### 3.4.1 ä½¿ç”¨Dockerå¯åŠ¨æ•°æ®åº“

**å¯åŠ¨æ•°æ®åº“æœåŠ¡**
```bash
# å¯åŠ¨PostgreSQLå’ŒRedis
docker-compose up -d postgres redis

# æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs postgres
docker-compose logs redis
```

**docker-compose.ymlç¤ºä¾‹**
```yaml
version: '3.8'

services:
  postgres:
    image: postgres:15
    container_name: myapp_postgres
    environment:
      POSTGRES_DB: myapp_dev
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./database/init.sql:/docker-entrypoint-initdb.d/init.sql
    networks:
      - myapp_network

  redis:
    image: redis:7-alpine
    container_name: myapp_redis
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
    networks:
      - myapp_network

volumes:
  postgres_data:
  redis_data:

networks:
  myapp_network:
    driver: bridge
```

#### 3.4.2 æ•°æ®åº“åˆå§‹åŒ–

**è¿è¡Œæ•°æ®åº“è¿ç§»**
```bash
# åˆ›å»ºæ•°æ®åº“ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
npm run db:create

# è¿è¡Œè¿ç§»
npm run db:migrate

# è¿è¡Œç§å­æ•°æ®
npm run db:seed
```

**package.jsonè„šæœ¬é…ç½®**
```json
{
  "scripts": {
    "db:create": "sequelize-cli db:create",
    "db:migrate": "sequelize-cli db:migrate",
    "db:migrate:undo": "sequelize-cli db:migrate:undo",
    "db:seed": "sequelize-cli db:seed:all",
    "db:seed:undo": "sequelize-cli db:seed:undo:all",
    "db:reset": "npm run db:migrate:undo:all && npm run db:migrate && npm run db:seed"
  }
}
```

#### 3.4.3 æ•°æ®åº“è¿æ¥æµ‹è¯•

**è¿æ¥æµ‹è¯•è„šæœ¬**
```javascript
// scripts/test-db.js
const { Sequelize } = require('sequelize');
require('dotenv').config();

const sequelize = new Sequelize(
  process.env.DB_NAME,
  process.env.DB_USERNAME,
  process.env.DB_PASSWORD,
  {
    host: process.env.DB_HOST,
    port: process.env.DB_PORT,
    dialect: 'postgres'
  }
);

async function testConnection() {
  try {
    await sequelize.authenticate();
    console.log('âœ… æ•°æ®åº“è¿æ¥æˆåŠŸ');
  } catch (error) {
    console.error('âŒ æ•°æ®åº“è¿æ¥å¤±è´¥:', error.message);
  } finally {
    await sequelize.close();
  }
}

testConnection();
```

**è¿è¡Œè¿æ¥æµ‹è¯•**
```bash
# æµ‹è¯•æ•°æ®åº“è¿æ¥
node scripts/test-db.js
```

### 3.5 å¼€å‘æœåŠ¡å™¨å¯åŠ¨

#### 3.5.1 å¯åŠ¨åç«¯æœåŠ¡

**å¼€å‘æ¨¡å¼å¯åŠ¨**
```bash
# ä½¿ç”¨nodemonå¯åŠ¨ï¼ˆæ”¯æŒçƒ­é‡è½½ï¼‰
npm run dev

# æˆ–ç›´æ¥å¯åŠ¨
npm start

# æŒ‡å®šç«¯å£å¯åŠ¨
PORT=3001 npm run dev
```

**package.jsonå¯åŠ¨è„šæœ¬**
```json
{
  "scripts": {
    "start": "node src/app.js",
    "dev": "nodemon src/app.js",
    "dev:debug": "DEBUG=* nodemon src/app.js",
    "test": "jest",
    "test:watch": "jest --watch",
    "lint": "eslint src/",
    "lint:fix": "eslint src/ --fix"
  }
}
```

#### 3.5.2 å¯åŠ¨å‰ç«¯æœåŠ¡

```bash
# è¿›å…¥å‰ç«¯ç›®å½•
cd frontend

# å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨
npm run dev

# æˆ–ä½¿ç”¨Viteå¯åŠ¨
npx vite

# æŒ‡å®šç«¯å£å¯åŠ¨
npm run dev -- --port 3001
```

**å‰ç«¯package.jsonè„šæœ¬**
```json
{
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "build:staging": "vite build --mode staging",
    "build:production": "vite build --mode production",
    "preview": "vite preview",
    "test": "vitest",
    "test:ui": "vitest --ui",
    "lint": "eslint src/",
    "lint:fix": "eslint src/ --fix",
    "type-check": "tsc --noEmit"
  }
}
```

### 3.6 å¼€å‘ç¯å¢ƒéªŒè¯

#### 3.6.1 æœåŠ¡çŠ¶æ€æ£€æŸ¥

**åç«¯æœåŠ¡æ£€æŸ¥**
```bash
# æ£€æŸ¥åç«¯æœåŠ¡
curl http://localhost:3000/api/health

# æŸ¥çœ‹APIæ–‡æ¡£
open http://localhost:3000/api-docs
```

**å‰ç«¯æœåŠ¡æ£€æŸ¥**
```bash
# æ£€æŸ¥å‰ç«¯æœåŠ¡
open http://localhost:3001
```

#### 3.6.2 æ•°æ®åº“è¿æ¥æ£€æŸ¥

**PostgreSQLè¿æ¥æ£€æŸ¥**
```bash
# ä½¿ç”¨psqlè¿æ¥
psql -h localhost -p 5432 -U postgres -d myapp_dev

# æŸ¥çœ‹è¡¨ç»“æ„
\dt

# é€€å‡º
\q
```

**Redisè¿æ¥æ£€æŸ¥**
```bash
# ä½¿ç”¨redis-cliè¿æ¥
redis-cli -h localhost -p 6379

# æµ‹è¯•è¿æ¥
ping

# é€€å‡º
exit
```

#### 3.6.3 è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œåç«¯æµ‹è¯•
npm test

# è¿è¡Œå‰ç«¯æµ‹è¯•
cd frontend
npm test

# è¿è¡Œæµ‹è¯•è¦†ç›–ç‡
npm run test:coverage
```

### 3.7 å¸¸è§é—®é¢˜è§£å†³

#### 3.7.1 ç«¯å£å ç”¨é—®é¢˜

```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
lsof -i :3000
netstat -tulpn | grep :3000

# æ€æ­»å ç”¨ç«¯å£çš„è¿›ç¨‹
kill -9 <PID>

# Windowsä¸‹æŸ¥çœ‹ç«¯å£å ç”¨
netstat -ano | findstr :3000
taskkill /PID <PID> /F
```

#### 3.7.2 ä¾èµ–å®‰è£…é—®é¢˜

```bash
# æ¸…é™¤npmç¼“å­˜
npm cache clean --force

# åˆ é™¤node_modulesé‡æ–°å®‰è£…
rm -rf node_modules package-lock.json
npm install

# ä½¿ç”¨npm ciè¿›è¡Œå¹²å‡€å®‰è£…
npm ci
```

#### 3.7.3 æ•°æ®åº“è¿æ¥é—®é¢˜

**PostgreSQLè¿æ¥å¤±è´¥**
```bash
# æ£€æŸ¥Dockerå®¹å™¨çŠ¶æ€
docker ps
docker logs myapp_postgres

# é‡å¯PostgreSQLå®¹å™¨
docker-compose restart postgres

# æ£€æŸ¥é˜²ç«å¢™è®¾ç½®ï¼ˆLinuxï¼‰
sudo ufw status
sudo ufw allow 5432
```

**Redisè¿æ¥å¤±è´¥**
```bash
# æ£€æŸ¥RedisçŠ¶æ€
docker logs myapp_redis

# é‡å¯Rediså®¹å™¨
docker-compose restart redis
```

### 3.8 IDEé…ç½®

#### 3.8.1 VS Codeé…ç½®

**æ¨èæ‰©å±•åˆ—è¡¨**
```json
// .vscode/extensions.json
{
  "recommendations": [
    "ms-vscode.vscode-typescript-next",
    "bradlc.vscode-tailwindcss",
    "esbenp.prettier-vscode",
    "ms-vscode.vscode-eslint",
    "formulahendry.auto-rename-tag",
    "ms-azuretools.vscode-docker",
    "eamodio.gitlens",
    "rangav.vscode-thunder-client"
  ]
}
```

**VS Codeè®¾ç½®**
```json
// .vscode/settings.json
{
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "emmet.includeLanguages": {
    "javascript": "javascriptreact",
    "typescript": "typescriptreact"
  },
  "files.associations": {
    "*.css": "tailwindcss"
  }
}
```

**è°ƒè¯•é…ç½®**
```json
// .vscode/launch.json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Launch Backend",
      "type": "node",
      "request": "launch",
      "program": "${workspaceFolder}/src/app.js",
      "env": {
        "NODE_ENV": "development"
      },
      "console": "integratedTerminal"
    }
  ]
}
```

#### 3.8.2 Gité…ç½®

**Gité’©å­é…ç½®**
```bash
# åˆå§‹åŒ–husky
npx husky-init && npm install

# æ·»åŠ pre-commité’©å­
npx husky add .husky/pre-commit "npm run lint"
npx husky add .husky/pre-push "npm test"
```

**.gitignoreæ–‡ä»¶**
```
# Dependencies
node_modules/
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# Production build
/build
/dist

# Environment variables
.env
.env.local
.env.staging
.env.production

# Logs
logs/
*.log

# Database
*.db
*.sqlite

# IDE
.vscode/
.idea/
*.swp
*.swo

# OS
.DS_Store
Thumbs.db

# Docker
.docker/

# Coverage
coverage/
```

ç°åœ¨å¼€å‘ç¯å¢ƒæ­å»ºæŒ‡å—å·²ç»å®Œæˆï¼Œæ¥ä¸‹æ¥ç»§ç»­ç¼–å†™éƒ¨ç½²é…ç½®è¯´æ˜ã€‚

---

## 4. éƒ¨ç½²é…ç½®è¯´æ˜

### 4.1 éƒ¨ç½²æ¶æ„æ¦‚è¿°

æœ¬é¡¹ç›®æ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼ï¼ŒåŒ…æ‹¬ä¼ ç»ŸæœåŠ¡å™¨éƒ¨ç½²ã€å®¹å™¨åŒ–éƒ¨ç½²å’Œäº‘åŸç”Ÿéƒ¨ç½²ã€‚æ¨èä½¿ç”¨å®¹å™¨åŒ–éƒ¨ç½²æ–¹å¼ï¼Œä¾¿äºç®¡ç†å’Œæ‰©å±•ã€‚

### 4.2 éƒ¨ç½²ç¯å¢ƒåˆ†ç±»

#### 4.2.1 ç¯å¢ƒç±»å‹

**å¼€å‘ç¯å¢ƒï¼ˆDevelopmentï¼‰**
- **ç”¨é€”**ï¼šæ—¥å¸¸å¼€å‘å’Œæµ‹è¯•
- **ç‰¹ç‚¹**ï¼šå®æ—¶é‡è½½ã€è¯¦ç»†æ—¥å¿—ã€è°ƒè¯•æ¨¡å¼
- **åŸŸå**ï¼šdev.yourapp.com
- **æ•°æ®åº“**ï¼šç‹¬ç«‹çš„å¼€å‘æ•°æ®åº“

**é¢„å‘å¸ƒç¯å¢ƒï¼ˆStagingï¼‰**
- **ç”¨é€”**ï¼šåŠŸèƒ½æµ‹è¯•å’Œé›†æˆæµ‹è¯•
- **ç‰¹ç‚¹**ï¼šæ¥è¿‘ç”Ÿäº§ç¯å¢ƒé…ç½®
- **åŸŸå**ï¼šstaging.yourapp.com
- **æ•°æ®åº“**ï¼šç”Ÿäº§æ•°æ®çš„å‰¯æœ¬

**ç”Ÿäº§ç¯å¢ƒï¼ˆProductionï¼‰**
- **ç”¨é€”**ï¼šæ­£å¼è¿è¡Œç¯å¢ƒ
- **ç‰¹ç‚¹**ï¼šé«˜å¯ç”¨ã€æ€§èƒ½ä¼˜åŒ–ã€å®‰å…¨åŠ å›º
- **åŸŸå**ï¼šyourapp.com
- **æ•°æ®åº“**ï¼šç”Ÿäº§æ•°æ®åº“

#### 4.2.2 ç¯å¢ƒé…ç½®å·®å¼‚

| é…ç½®é¡¹ | å¼€å‘ç¯å¢ƒ | é¢„å‘å¸ƒç¯å¢ƒ | ç”Ÿäº§ç¯å¢ƒ |
|--------|----------|------------|----------|
| æ—¥å¿—çº§åˆ« | debug | info | error |
| ç¼“å­˜ç­–ç•¥ | å…³é—­ | å¼€å¯ | å¼€å¯ |
| ä»£ç å‹ç¼© | å¦ | æ˜¯ | æ˜¯ |
| HTTPS | å¦ | æ˜¯ | æ˜¯ |
| æ•°æ®åº“è¿æ¥æ±  | 5 | 10 | 20 |
| Redisé›†ç¾¤ | å•å®ä¾‹ | ä¸»ä» | é›†ç¾¤ |

### 4.3 Dockeréƒ¨ç½²

#### 4.3.1 Dockerfileä¼˜åŒ–

**åç«¯Dockerfile**
```dockerfile
# å¤šé˜¶æ®µæ„å»º - æ„å»ºé˜¶æ®µ
FROM node:18-alpine AS builder

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# å¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY package*.json ./
COPY .npmrc ./

# å®‰è£…ä¾èµ–ï¼ˆä»…ç”Ÿäº§ä¾èµ–ï¼‰
RUN npm ci --only=production

# å¤åˆ¶æºä»£ç 
COPY . .

# æ„å»ºåº”ç”¨
RUN npm run build

# è¿è¡Œé˜¶æ®µ
FROM node:18-alpine AS runner

# åˆ›å»ºérootç”¨æˆ·
RUN addgroup --system --gid 1001 nodejs
RUN adduser --system --uid 1001 nextjs

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# å¤åˆ¶æ„å»ºäº§ç‰©
COPY --from=builder --chown=nextjs:nodejs /app/dist ./dist
COPY --from=builder --chown=nextjs:nodejs /app/node_modules ./node_modules
COPY --from=builder --chown=nextjs:nodejs /app/package.json ./package.json

# åˆ›å»ºæ—¥å¿—ç›®å½•
RUN mkdir -p logs && chown nextjs:nodejs logs

# åˆ‡æ¢åˆ°érootç”¨æˆ·
USER nextjs

# æš´éœ²ç«¯å£
EXPOSE 3000

# å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
  CMD curl -f http://localhost:3000/api/health || exit 1

# å¯åŠ¨åº”ç”¨
CMD ["npm", "start"]
```

**å‰ç«¯Dockerfile**
```dockerfile
# æ„å»ºé˜¶æ®µ
FROM node:18-alpine AS builder

WORKDIR /app

# å¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY package*.json ./
RUN npm ci

# å¤åˆ¶æºä»£ç å¹¶æ„å»º
COPY . .
RUN npm run build

# Nginxè¿è¡Œé˜¶æ®µ
FROM nginx:alpine AS runner

# å¤åˆ¶nginxé…ç½®
COPY nginx.conf /etc/nginx/nginx.conf

# å¤åˆ¶æ„å»ºäº§ç‰©
COPY --from=builder /app/dist /usr/share/nginx/html

# æš´éœ²ç«¯å£
EXPOSE 80

# å¯åŠ¨nginx
CMD ["nginx", "-g", "daemon off;"]
```

#### 4.3.2 Docker Composeç”Ÿäº§é…ç½®

**docker-compose.prod.yml**
```yaml
version: '3.8'

services:
  # Nginxåå‘ä»£ç†
  nginx:
    image: nginx:alpine
    container_name: myapp_nginx
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./nginx/ssl:/etc/nginx/ssl:ro
      - ./logs/nginx:/var/log/nginx
    depends_on:
      - backend
      - frontend
    networks:
      - myapp_network
    restart: unless-stopped

  # å‰ç«¯åº”ç”¨
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    container_name: myapp_frontend
    networks:
      - myapp_network
    restart: unless-stopped

  # åç«¯åº”ç”¨
  backend:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: myapp_backend
    environment:
      - NODE_ENV=production
      - DB_HOST=postgres
      - REDIS_HOST=redis
    depends_on:
      - postgres
      - redis
    volumes:
      - ./logs:/app/logs
      - ./uploads:/app/uploads
    networks:
      - myapp_network
    restart: unless-stopped

  # PostgreSQLæ•°æ®åº“
  postgres:
    image: postgres:15
    container_name: myapp_postgres
    environment:
      POSTGRES_DB: ${DB_NAME}
      POSTGRES_USER: ${DB_USERNAME}
      POSTGRES_PASSWORD: ${DB_PASSWORD}
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./database/backup:/backup
    networks:
      - myapp_network
    restart: unless-stopped

  # Redisç¼“å­˜
  redis:
    image: redis:7-alpine
    container_name: myapp_redis
    command: redis-server --requirepass ${REDIS_PASSWORD}
    volumes:
      - redis_data:/data
    networks:
      - myapp_network
    restart: unless-stopped

  # ç›‘æ§æœåŠ¡
  prometheus:
    image: prom/prometheus
    container_name: myapp_prometheus
    ports:
      - "9090:9090"
    volumes:
      - ./monitoring/prometheus.yml:/etc/prometheus/prometheus.yml:ro
    networks:
      - myapp_network
    restart: unless-stopped

  grafana:
    image: grafana/grafana
    container_name: myapp_grafana
    ports:
      - "3000:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=${GRAFANA_PASSWORD}
    volumes:
      - grafana_data:/var/lib/grafana
    networks:
      - myapp_network
    restart: unless-stopped

volumes:
  postgres_data:
  redis_data:
  grafana_data:

networks:
  myapp_network:
    driver: bridge
```

#### 4.3.3 Nginxé…ç½®

**nginx/nginx.conf**
```nginx
user nginx;
worker_processes auto;
error_log /var/log/nginx/error.log warn;
pid /var/run/nginx.pid;

events {
    worker_connections 1024;
    use epoll;
    multi_accept on;
}

http {
    include /etc/nginx/mime.types;
    default_type application/octet-stream;

    # æ—¥å¿—æ ¼å¼
    log_format main '$remote_addr - $remote_user [$time_local] "$request" '
                    '$status $body_bytes_sent "$http_referer" '
                    '"$http_user_agent" "$http_x_forwarded_for"';

    access_log /var/log/nginx/access.log main;

    # åŸºç¡€é…ç½®
    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;
    keepalive_timeout 65;
    types_hash_max_size 2048;
    client_max_body_size 16M;

    # Gzipå‹ç¼©
    gzip on;
    gzip_vary on;
    gzip_comp_level 6;
    gzip_min_length 1000;
    gzip_types
        text/plain
        text/css
        text/xml
        text/javascript
        application/json
        application/javascript
        application/xml+rss
        application/atom+xml
        image/svg+xml;

    # å®‰å…¨å¤´
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-XSS-Protection "1; mode=block" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header Referrer-Policy "no-referrer-when-downgrade" always;

    # ä¸Šæ¸¸æœåŠ¡å™¨
    upstream backend {
        server backend:3000;
        keepalive 32;
    }

    # é™åˆ¶è¯·æ±‚
    limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;

    # HTTPé‡å®šå‘åˆ°HTTPS
    server {
        listen 80;
        server_name yourapp.com www.yourapp.com;
        return 301 https://$server_name$request_uri;
    }

    # HTTPSä¸»ç«™
    server {
        listen 443 ssl http2;
        server_name yourapp.com www.yourapp.com;

        # SSLé…ç½®
        ssl_certificate /etc/nginx/ssl/cert.pem;
        ssl_certificate_key /etc/nginx/ssl/key.pem;
        ssl_session_timeout 1d;
        ssl_session_cache shared:SSL:10m;
        ssl_session_tickets off;

        # SSLåè®®é…ç½®
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384;
        ssl_prefer_server_ciphers off;

        # HSTS
        add_header Strict-Transport-Security "max-age=63072000" always;

        # é™æ€æ–‡ä»¶
        location / {
            proxy_pass http://frontend:80;
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection 'upgrade';
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_cache_bypass $http_upgrade;
        }

        # APIæ¥å£
        location /api {
            limit_req zone=api burst=20 nodelay;
            
            proxy_pass http://backend;
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection 'upgrade';
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_cache_bypass $http_upgrade;
            
            # è¶…æ—¶è®¾ç½®
            proxy_connect_timeout 30s;
            proxy_send_timeout 60s;
            proxy_read_timeout 60s;
        }

        # é™æ€èµ„æºç¼“å­˜
        location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
            expires 1y;
            add_header Cache-Control "public, immutable";
            try_files $uri =404;
        }

        # å¥åº·æ£€æŸ¥
        location /health {
            access_log off;
            return 200 "healthy\n";
            add_header Content-Type text/plain;
        }
    }
}
```

### 4.4 Kuberneteséƒ¨ç½²

#### 4.4.1 åŸºç¡€é…ç½®æ–‡ä»¶

**namespace.yaml**
```yaml
apiVersion: v1
kind: Namespace
metadata:
  name: myapp
  labels:
    name: myapp
```

**configmap.yaml**
```yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: myapp-config
  namespace: myapp
data:
  NODE_ENV: "production"
  DB_HOST: "postgres-service"
  REDIS_HOST: "redis-service"
  API_RATE_LIMIT: "100"
```

**secret.yaml**
```yaml
apiVersion: v1
kind: Secret
metadata:
  name: myapp-secrets
  namespace: myapp
type: Opaque
data:
  DB_PASSWORD: <base64-encoded-password>
  JWT_SECRET: <base64-encoded-jwt-secret>
  REDIS_PASSWORD: <base64-encoded-redis-password>
```

#### 4.4.2 åº”ç”¨éƒ¨ç½²é…ç½®

**backend-deployment.yaml**
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: backend-deployment
  namespace: myapp
spec:
  replicas: 3
  selector:
    matchLabels:
      app: backend
  template:
    metadata:
      labels:
        app: backend
    spec:
      containers:
      - name: backend
        image: myapp/backend:latest
        ports:
        - containerPort: 3000
        env:
        - name: NODE_ENV
          valueFrom:
            configMapKeyRef:
              name: myapp-config
              key: NODE_ENV
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              name: myapp-secrets
              key: DB_PASSWORD
        resources:
          limits:
            cpu: 500m
            memory: 512Mi
          requests:
            cpu: 250m
            memory: 256Mi
        livenessProbe:
          httpGet:
            path: /api/health
            port: 3000
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /api/ready
            port: 3000
          initialDelaySeconds: 5
          periodSeconds: 5
---
apiVersion: v1
kind: Service
metadata:
  name: backend-service
  namespace: myapp
spec:
  selector:
    app: backend
  ports:
    - protocol: TCP
      port: 80
      targetPort: 3000
  type: ClusterIP
```

**frontend-deployment.yaml**
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: frontend-deployment
  namespace: myapp
spec:
  replicas: 2
  selector:
    matchLabels:
      app: frontend
  template:
    metadata:
      labels:
        app: frontend
    spec:
      containers:
      - name: frontend
        image: myapp/frontend:latest
        ports:
        - containerPort: 80
        resources:
          limits:
            cpu: 200m
            memory: 256Mi
          requests:
            cpu: 100m
            memory: 128Mi
---
apiVersion: v1
kind: Service
metadata:
  name: frontend-service
  namespace: myapp
spec:
  selector:
    app: frontend
  ports:
    - protocol: TCP
      port: 80
      targetPort: 80
  type: ClusterIP
```

#### 4.4.3 Ingressé…ç½®

**ingress.yaml**
```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: myapp-ingress
  namespace: myapp
  annotations:
    kubernetes.io/ingress.class: nginx
    cert-manager.io/cluster-issuer: letsencrypt-prod
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/rate-limit: "100"
spec:
  tls:
  - hosts:
    - yourapp.com
    - www.yourapp.com
    secretName: myapp-tls
  rules:
  - host: yourapp.com
    http:
      paths:
      - path: /api
        pathType: Prefix
        backend:
          service:
            name: backend-service
            port:
              number: 80
      - path: /
        pathType: Prefix
        backend:
          service:
            name: frontend-service
            port:
              number: 80
  - host: www.yourapp.com
    http:
      paths:
      - path: /api
        pathType: Prefix
        backend:
          service:
            name: backend-service
            port:
              number: 80
      - path: /
        pathType: Prefix
        backend:
          service:
            name: frontend-service
            port:
              number: 80
```

### 4.5 CI/CDæµæ°´çº¿

#### 4.5.1 GitHub Actionsé…ç½®

**.github/workflows/deploy.yml**
```yaml
name: CI/CD Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

env:
  NODE_VERSION: '18'
  DOCKER_REGISTRY: ghcr.io
  IMAGE_NAME: myapp

jobs:
  test:
    runs-on: ubuntu-latest
    
    services:
      postgres:
        image: postgres:15
        env:
          POSTGRES_PASSWORD: password
          POSTGRES_DB: test_db
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 5432:5432

      redis:
        image: redis:7
        options: >-
          --health-cmd "redis-cli ping"
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 6379:6379

    steps:
    - uses: actions/checkout@v3
    
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: ${{ env.NODE_VERSION }}
        cache: 'npm'
    
    - name: Install dependencies
      run: npm ci
    
    - name: Run lint
      run: npm run lint
    
    - name: Run tests
      run: npm test
      env:
        NODE_ENV: test
        DB_HOST: localhost
        DB_PORT: 5432
        REDIS_HOST: localhost
        REDIS_PORT: 6379
    
    - name: Frontend tests
      run: |
        cd frontend
        npm ci
        npm test
    
    - name: Upload coverage to Codecov
      uses: codecov/codecov-action@v3

  build:
    needs: test
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up Docker Buildx
      uses: docker/setup-buildx-action@v2
    
    - name: Login to Container Registry
      uses: docker/login-action@v2
      with:
        registry: ${{ env.DOCKER_REGISTRY }}
        username: ${{ github.actor }}
        password: ${{ secrets.GITHUB_TOKEN }}
    
    - name: Extract metadata
      id: meta
      uses: docker/metadata-action@v4
      with:
        images: ${{ env.DOCKER_REGISTRY }}/${{ github.repository }}/${{ env.IMAGE_NAME }}
        tags: |
          type=ref,event=branch
          type=ref,event=pr
          type=sha
    
    - name: Build and push Backend image
      uses: docker/build-push-action@v4
      with:
        context: .
        file: ./Dockerfile
        push: true
        tags: ${{ steps.meta.outputs.tags }}-backend
        labels: ${{ steps.meta.outputs.labels }}
        cache-from: type=gha
        cache-to: type=gha,mode=max
    
    - name: Build and push Frontend image
      uses: docker/build-push-action@v4
      with:
        context: ./frontend
        file: ./frontend/Dockerfile
        push: true
        tags: ${{ steps.meta.outputs.tags }}-frontend
        labels: ${{ steps.meta.outputs.labels }}
        cache-from: type=gha
        cache-to: type=gha,mode=max

  deploy:
    needs: build
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Deploy to staging
      run: |
        echo "Deploying to staging environment"
        # è¿™é‡Œæ·»åŠ éƒ¨ç½²åˆ°é¢„å‘å¸ƒç¯å¢ƒçš„è„šæœ¬
    
    - name: Deploy to production
      if: github.event_name == 'push'
      run: |
        echo "Deploying to production environment"
        # è¿™é‡Œæ·»åŠ éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒçš„è„šæœ¬
```

#### 4.5.2 éƒ¨ç½²è„šæœ¬

**scripts/deploy.sh**
```bash
#!/bin/bash

set -e

# é…ç½®å˜é‡
ENVIRONMENT=${1:-staging}
IMAGE_TAG=${2:-latest}
NAMESPACE="myapp-${ENVIRONMENT}"

echo "ğŸš€ éƒ¨ç½²åˆ° ${ENVIRONMENT} ç¯å¢ƒ"

# æ£€æŸ¥kubectlè¿æ¥
kubectl cluster-info

# åˆ›å»ºå‘½åç©ºé—´ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
kubectl create namespace ${NAMESPACE} --dry-run=client -o yaml | kubectl apply -f -

# åº”ç”¨é…ç½®æ–‡ä»¶
echo "ğŸ“ åº”ç”¨é…ç½®æ–‡ä»¶..."
envsubst < k8s/configmap.yaml | kubectl apply -f -
envsubst < k8s/secret.yaml | kubectl apply -f -

# éƒ¨ç½²åº”ç”¨
echo "ğŸ¯ éƒ¨ç½²åº”ç”¨..."
envsubst < k8s/backend-deployment.yaml | kubectl apply -f -
envsubst < k8s/frontend-deployment.yaml | kubectl apply -f -

# åº”ç”¨Ingress
if [ "$ENVIRONMENT" = "production" ]; then
    echo "ğŸŒ é…ç½®Ingress..."
    envsubst < k8s/ingress.yaml | kubectl apply -f -
fi

# ç­‰å¾…éƒ¨ç½²å®Œæˆ
echo "â³ ç­‰å¾…éƒ¨ç½²å®Œæˆ..."
kubectl rollout status deployment/backend-deployment -n ${NAMESPACE}
kubectl rollout status deployment/frontend-deployment -n ${NAMESPACE}

echo "âœ… éƒ¨ç½²å®Œæˆï¼"

# æ˜¾ç¤ºæœåŠ¡çŠ¶æ€
kubectl get pods -n ${NAMESPACE}
kubectl get services -n ${NAMESPACE}
```

### 4.6 ç¯å¢ƒå˜é‡ç®¡ç†

#### 4.6.1 ç¯å¢ƒå˜é‡åˆ†ç±»

**å…¬å¼€é…ç½®**
```bash
# åº”ç”¨é…ç½®
NODE_ENV=production
PORT=3000
APP_NAME=MyApp
LOG_LEVEL=info

# åŠŸèƒ½å¼€å…³
FEATURE_REGISTRATION=true
FEATURE_EMAIL_VERIFICATION=true
FEATURE_SOCIAL_LOGIN=false
```

**æ•æ„Ÿé…ç½®**
```bash
# æ•°æ®åº“é…ç½®
DB_PASSWORD=<encrypted>
JWT_SECRET=<encrypted>
REDIS_PASSWORD=<encrypted>

# ç¬¬ä¸‰æ–¹æœåŠ¡å¯†é’¥
AWS_SECRET_ACCESS_KEY=<encrypted>
STRIPE_SECRET_KEY=<encrypted>
EMAIL_PASSWORD=<encrypted>
```

#### 4.6.2 å¯†é’¥ç®¡ç†ç­–ç•¥

**Kubernetes Secrets**
```bash
# åˆ›å»ºå¯†é’¥
kubectl create secret generic myapp-secrets \
  --from-literal=db-password=<password> \
  --from-literal=jwt-secret=<secret> \
  --namespace=myapp

# ä»æ–‡ä»¶åˆ›å»ºå¯†é’¥
kubectl create secret generic myapp-secrets \
  --from-file=.env.secret \
  --namespace=myapp
```

**Vaulté›†æˆ**
```javascript
// config/vault.js
const vault = require('node-vault')({
  endpoint: process.env.VAULT_ENDPOINT,
  token: process.env.VAULT_TOKEN
});

async function getSecrets() {
  try {
    const result = await vault.read('secret/data/myapp');
    return result.data.data;
  } catch (error) {
    console.error('Vaultè¯»å–å¤±è´¥:', error);
    throw error;
  }
}

module.exports = { getSecrets };
```

### 4.7 ç›‘æ§å’Œå‘Šè­¦

#### 4.7.1 Prometheusé…ç½®

**monitoring/prometheus.yml**
```yaml
global:
  scrape_interval: 15s
  evaluation_interval: 15s

rule_files:
  - "rules/*.yml"

alerting:
  alertmanagers:
    - static_configs:
        - targets:
          - alertmanager:9093

scrape_configs:
  - job_name: 'myapp-backend'
    static_configs:
      - targets: ['backend:3000']
    metrics_path: '/metrics'
    scrape_interval: 30s

  - job_name: 'postgres'
    static_configs:
      - targets: ['postgres-exporter:9187']

  - job_name: 'redis'
    static_configs:
      - targets: ['redis-exporter:9121']

  - job_name: 'nginx'
    static_configs:
      - targets: ['nginx-exporter:9113']
```

#### 4.7.2 å‘Šè­¦è§„åˆ™

**monitoring/rules/app.yml**
```yaml
groups:
  - name: myapp.rules
    rules:
      - alert: HighErrorRate
        expr: rate(http_requests_total{status=~"5.."}[5m]) > 0.1
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "é«˜é”™è¯¯ç‡å‘Šè­¦"
          description: "åº”ç”¨é”™è¯¯ç‡è¶…è¿‡10%ï¼ŒæŒç»­5åˆ†é’Ÿ"

      - alert: HighResponseTime
        expr: histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m])) > 1
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "å“åº”æ—¶é—´è¿‡é•¿"
          description: "95%è¯·æ±‚å“åº”æ—¶é—´è¶…è¿‡1ç§’"

      - alert: DatabaseConnectionsHigh
        expr: pg_stat_database_numbackends > 80
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "æ•°æ®åº“è¿æ¥æ•°è¿‡é«˜"
          description: "æ•°æ®åº“è¿æ¥æ•°è¶…è¿‡80"
```

### 4.8 å¤‡ä»½å’Œæ¢å¤

#### 4.8.1 æ•°æ®åº“å¤‡ä»½

**scripts/backup-db.sh**
```bash
#!/bin/bash

# é…ç½®
DB_NAME="myapp"
DB_USER="postgres"
BACKUP_DIR="/backup"
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_FILE="${BACKUP_DIR}/db_backup_${DATE}.sql"

# åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p ${BACKUP_DIR}

# æ‰§è¡Œå¤‡ä»½
pg_dump -h localhost -U ${DB_USER} -d ${DB_NAME} > ${BACKUP_FILE}

# å‹ç¼©å¤‡ä»½æ–‡ä»¶
gzip ${BACKUP_FILE}

# åˆ é™¤30å¤©å‰çš„å¤‡ä»½
find ${BACKUP_DIR} -name "db_backup_*.sql.gz" -mtime +30 -delete

echo "æ•°æ®åº“å¤‡ä»½å®Œæˆ: ${BACKUP_FILE}.gz"
```

#### 4.8.2 è‡ªåŠ¨å¤‡ä»½é…ç½®

**crontabé…ç½®**
```bash
# ç¼–è¾‘crontab
crontab -e

# æ·»åŠ å®šæ—¶å¤‡ä»½ä»»åŠ¡
# æ¯å¤©å‡Œæ™¨2ç‚¹æ‰§è¡Œæ•°æ®åº“å¤‡ä»½
0 2 * * * /app/scripts/backup-db.sh

# æ¯å‘¨æ—¥å‡Œæ™¨3ç‚¹æ‰§è¡Œå®Œæ•´å¤‡ä»½
0 3 * * 0 /app/scripts/full-backup.sh
```

**Kubernetes CronJob**
```yaml
apiVersion: batch/v1
kind: CronJob
metadata:
  name: db-backup
  namespace: myapp
spec:
  schedule: "0 2 * * *"
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: postgres-backup
            image: postgres:15
            command:
            - /bin/bash
            - -c
            - |
              pg_dump -h postgres-service -U postgres myapp | gzip > /backup/backup_$(date +%Y%m%d_%H%M%S).sql.gz
            env:
            - name: PGPASSWORD
              valueFrom:
                secretKeyRef:
                  name: myapp-secrets
                  key: DB_PASSWORD
            volumeMounts:
            - name: backup-volume
              mountPath: /backup
          volumes:
          - name: backup-volume
            persistentVolumeClaim:
              claimName: backup-pvc
          restartPolicy: OnFailure
```

---

## 5. APIæ¥å£æ–‡æ¡£

### 5.1 APIæ¦‚è¿°

æœ¬APIé‡‡ç”¨RESTfulè®¾è®¡é£æ ¼ï¼Œä½¿ç”¨JSONæ ¼å¼è¿›è¡Œæ•°æ®äº¤æ¢ï¼Œæ”¯æŒæ ‡å‡†HTTPæ–¹æ³•ï¼Œå¹¶æä¾›å®Œæ•´çš„è®¤è¯å’Œæˆæƒæœºåˆ¶ã€‚

#### 5.1.1 åŸºç¡€ä¿¡æ¯

**APIåŸºç¡€ä¿¡æ¯**
- **åŸºç¡€URL**: `https://api.yourapp.com/v1`
- **åè®®**: HTTPS
- **æ•°æ®æ ¼å¼**: JSON
- **å­—ç¬¦ç¼–ç **: UTF-8
- **APIç‰ˆæœ¬**: v1.0.0

**è¯·æ±‚å¤´è¦æ±‚**
```http
Content-Type: application/json
Accept: application/json
Authorization: Bearer <JWT_TOKEN>
```

#### 5.1.2 å“åº”æ ¼å¼

**æˆåŠŸå“åº”æ ¼å¼**
```json
{
  "success": true,
  "data": {
    // å“åº”æ•°æ®
  },
  "message": "æ“ä½œæˆåŠŸ",
  "timestamp": "2025-08-26T17:22:40Z"
}
```

**é”™è¯¯å“åº”æ ¼å¼**
```json
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "è¯·æ±‚å‚æ•°éªŒè¯å¤±è´¥",
    "details": [
      {
        "field": "email",
        "message": "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®"
      }
    ]
  },
  "timestamp": "2025-08-26T17:22:40Z"
}
```

#### 5.1.3 HTTPçŠ¶æ€ç 

| çŠ¶æ€ç  | å«ä¹‰ | è¯´æ˜ |
|--------|------|------|
| 200 | OK | è¯·æ±‚æˆåŠŸ |
| 201 | Created | åˆ›å»ºæˆåŠŸ |
| 400 | Bad Request | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401 | Unauthorized | æœªè®¤è¯æˆ–è®¤è¯å¤±è´¥ |
| 403 | Forbidden | æ²¡æœ‰æƒé™è®¿é—® |
| 404 | Not Found | èµ„æºä¸å­˜åœ¨ |
| 409 | Conflict | èµ„æºå†²çª |
| 422 | Unprocessable Entity | è¯·æ±‚æ ¼å¼æ­£ç¡®ä½†è¯­ä¹‰é”™è¯¯ |
| 500 | Internal Server Error | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

### 5.2 è®¤è¯å’Œæˆæƒ

#### 5.2.1 JWTè®¤è¯

**è·å–è®¿é—®ä»¤ç‰Œ**
```http
POST /auth/login
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "password123"
}
```

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "token_type": "Bearer",
    "expires_in": 3600,
    "user": {
      "id": 1,
      "email": "user@example.com",
      "name": "John Doe",
      "role": "user"
    }
  }
}
```

**åˆ·æ–°ä»¤ç‰Œ**
```http
POST /auth/refresh
Content-Type: application/json

{
  "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

#### 5.2.2 æƒé™çº§åˆ«

| è§’è‰² | æƒé™æè¿° |
|------|----------|
| admin | ç³»ç»Ÿç®¡ç†å‘˜ï¼Œæ‹¥æœ‰æ‰€æœ‰æƒé™ |
| manager | ç®¡ç†å‘˜ï¼Œå¯ç®¡ç†ç”¨æˆ·å’Œå†…å®¹ |
| user | æ™®é€šç”¨æˆ·ï¼ŒåŸºæœ¬æ“ä½œæƒé™ |
| guest | è®¿å®¢ï¼Œä»…è¯»å–æƒé™ |

### 5.3 ç”¨æˆ·ç®¡ç†API

#### 5.3.1 ç”¨æˆ·æ³¨å†Œ

```http
POST /users/register
Content-Type: application/json

{
  "username": "johndoe",
  "email": "john@example.com",
  "password": "password123",
  "full_name": "John Doe",
  "phone": "+1234567890"
}
```

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "id": 123,
    "username": "johndoe",
    "email": "john@example.com",
    "full_name": "John Doe",
    "phone": "+1234567890",
    "role": "user",
    "is_active": false,
    "created_at": "2025-08-26T17:22:40Z"
  },
  "message": "æ³¨å†ŒæˆåŠŸï¼Œè¯·æŸ¥æ”¶é‚®ç®±éªŒè¯é‚®ä»¶"
}
```

#### 5.3.2 è·å–ç”¨æˆ·ä¿¡æ¯

```http
GET /users/{id}
Authorization: Bearer <JWT_TOKEN>
```

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "id": 123,
    "username": "johndoe",
    "email": "john@example.com",
    "full_name": "John Doe",
    "phone": "+1234567890",
    "role": "user",
    "is_active": true,
    "last_login": "2025-08-26T16:00:00Z",
    "created_at": "2025-08-26T10:00:00Z",
    "updated_at": "2025-08-26T16:00:00Z"
  }
}
```

#### 5.3.3 æ›´æ–°ç”¨æˆ·ä¿¡æ¯

```http
PUT /users/{id}
Authorization: Bearer <JWT_TOKEN>
Content-Type: application/json

{
  "full_name": "John Smith",
  "phone": "+1987654321"
}
```

#### 5.3.4 ç”¨æˆ·åˆ—è¡¨ï¼ˆåˆ†é¡µï¼‰

```http
GET /users?page=1&limit=20&sort=created_at&order=desc&search=john
Authorization: Bearer <JWT_TOKEN>
```

**æŸ¥è¯¢å‚æ•°**
- `page`: é¡µç ï¼ˆé»˜è®¤1ï¼‰
- `limit`: æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤20ï¼Œæœ€å¤§100ï¼‰
- `sort`: æ’åºå­—æ®µï¼ˆid, created_at, usernameï¼‰
- `order`: æ’åºé¡ºåºï¼ˆasc, descï¼‰
- `search`: æœç´¢å…³é”®è¯
- `role`: è§’è‰²ç­›é€‰
- `is_active`: çŠ¶æ€ç­›é€‰

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "users": [
      {
        "id": 123,
        "username": "johndoe",
        "email": "john@example.com",
        "full_name": "John Doe",
        "role": "user",
        "is_active": true,
        "created_at": "2025-08-26T10:00:00Z"
      }
    ],
    "pagination": {
      "current_page": 1,
      "per_page": 20,
      "total": 150,
      "total_pages": 8,
      "has_next": true,
      "has_prev": false
    }
  }
}
```

### 5.4 äº§å“ç®¡ç†API

#### 5.4.1 åˆ›å»ºäº§å“

```http
POST /products
Authorization: Bearer <JWT_TOKEN>
Content-Type: application/json

{
  "name": "iPhone 15 Pro",
  "description": "æœ€æ–°æ¬¾iPhoneï¼Œé…å¤‡A17èŠ¯ç‰‡",
  "price": 999.99,
  "category_id": 1,
  "specifications": {
    "color": "æ·±ç©ºé»‘",
    "storage": "256GB",
    "screen_size": "6.1è‹±å¯¸"
  },
  "stock_quantity": 100,
  "images": [
    "https://example.com/image1.jpg",
    "https://example.com/image2.jpg"
  ]
}
```

#### 5.4.2 è·å–äº§å“è¯¦æƒ…

```http
GET /products/{id}
```

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "id": 456,
    "name": "iPhone 15 Pro",
    "description": "æœ€æ–°æ¬¾iPhoneï¼Œé…å¤‡A17èŠ¯ç‰‡",
    "price": 999.99,
    "category": {
      "id": 1,
      "name": "æ™ºèƒ½æ‰‹æœº",
      "parent_id": null
    },
    "specifications": {
      "color": "æ·±ç©ºé»‘",
      "storage": "256GB",
      "screen_size": "6.1è‹±å¯¸"
    },
    "stock_quantity": 95,
    "images": [
      {
        "id": 1,
        "url": "https://example.com/image1.jpg",
        "alt": "iPhone 15 Pro æ­£é¢"
      }
    ],
    "ratings": {
      "average": 4.5,
      "count": 128
    },
    "status": "active",
    "created_by": {
      "id": 1,
      "username": "admin",
      "full_name": "Administrator"
    },
    "created_at": "2025-08-26T10:00:00Z",
    "updated_at": "2025-08-26T15:30:00Z"
  }
}
```

#### 5.4.3 äº§å“åˆ—è¡¨

```http
GET /products?page=1&limit=20&category=1&price_min=100&price_max=1000&sort=price&order=asc
```

**æŸ¥è¯¢å‚æ•°**
- `page`: é¡µç 
- `limit`: æ¯é¡µæ•°é‡
- `category`: åˆ†ç±»ç­›é€‰
- `price_min`: æœ€ä½ä»·æ ¼
- `price_max`: æœ€é«˜ä»·æ ¼
- `sort`: æ’åºå­—æ®µï¼ˆprice, created_at, name, ratingsï¼‰
- `order`: æ’åºé¡ºåº
- `search`: æœç´¢å…³é”®è¯
- `status`: çŠ¶æ€ç­›é€‰ï¼ˆactive, inactiveï¼‰

### 5.5 è®¢å•ç®¡ç†API

#### 5.5.1 åˆ›å»ºè®¢å•

```http
POST /orders
Authorization: Bearer <JWT_TOKEN>
Content-Type: application/json

{
  "items": [
    {
      "product_id": 456,
      "quantity": 2,
      "unit_price": 999.99
    },
    {
      "product_id": 789,
      "quantity": 1,
      "unit_price": 299.99
    }
  ],
  "shipping_address": {
    "name": "John Doe",
    "street": "123 Main St",
    "city": "New York",
    "state": "NY",
    "zip_code": "10001",
    "country": "USA",
    "phone": "+1234567890"
  },
  "billing_address": {
    "name": "John Doe",
    "street": "123 Main St",
    "city": "New York",
    "state": "NY",
    "zip_code": "10001",
    "country": "USA"
  },
  "payment_method": "credit_card",
  "shipping_method": "standard",
  "notes": "è¯·å°å¿ƒå¤„ç†"
}
```

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "id": 789,
    "order_number": "ORD-2025-08-26-001",
    "status": "pending",
    "total_amount": 2299.97,
    "items": [
      {
        "id": 1,
        "product": {
          "id": 456,
          "name": "iPhone 15 Pro",
          "image": "https://example.com/image1.jpg"
        },
        "quantity": 2,
        "unit_price": 999.99,
        "total_price": 1999.98
      }
    ],
    "shipping_address": {
      "name": "John Doe",
      "street": "123 Main St",
      "city": "New York",
      "state": "NY",
      "zip_code": "10001",
      "country": "USA"
    },
    "payment_status": "pending",
    "created_at": "2025-08-26T17:22:40Z"
  },
  "message": "è®¢å•åˆ›å»ºæˆåŠŸ"
}
```

#### 5.5.2 è®¢å•çŠ¶æ€æ›´æ–°

```http
PATCH /orders/{id}/status
Authorization: Bearer <JWT_TOKEN>
Content-Type: application/json

{
  "status": "processing",
  "notes": "è®¢å•å·²ç¡®è®¤ï¼Œæ­£åœ¨å¤„ç†ä¸­"
}
```

**è®¢å•çŠ¶æ€æµç¨‹**
```
pending â†’ confirmed â†’ processing â†’ shipped â†’ delivered
     â†“         â†“           â†“         â†“
  cancelled cancelled  cancelled  returned
```

### 5.6 æ–‡ä»¶ä¸Šä¼ API

#### 5.6.1 å•æ–‡ä»¶ä¸Šä¼ 

```http
POST /files/upload
Authorization: Bearer <JWT_TOKEN>
Content-Type: multipart/form-data

{
  "file": <binary_data>,
  "category": "product_image",
  "alt_text": "äº§å“å›¾ç‰‡æè¿°"
}
```

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "id": 123,
    "original_name": "iphone.jpg",
    "stored_name": "uploads/2025/08/26/abc123.jpg",
    "url": "https://cdn.yourapp.com/uploads/2025/08/26/abc123.jpg",
    "mime_type": "image/jpeg",
    "file_size": 1048576,
    "file_hash": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",
    "category": "product_image",
    "alt_text": "äº§å“å›¾ç‰‡æè¿°",
    "created_at": "2025-08-26T17:22:40Z"
  }
}
```

#### 5.6.2 å¤šæ–‡ä»¶ä¸Šä¼ 

```http
POST /files/batch-upload
Authorization: Bearer <JWT_TOKEN>
Content-Type: multipart/form-data

{
  "files[]": [<binary_data_1>, <binary_data_2>],
  "category": "gallery"
}
```

### 5.7 æœç´¢API

#### 5.7.1 å…¨æ–‡æœç´¢

```http
GET /search?q=iPhone&type=products&page=1&limit=20
```

**æŸ¥è¯¢å‚æ•°**
- `q`: æœç´¢å…³é”®è¯ï¼ˆå¿…éœ€ï¼‰
- `type`: æœç´¢ç±»å‹ï¼ˆproducts, users, ordersï¼‰
- `page`: é¡µç 
- `limit`: æ¯é¡µæ•°é‡
- `category`: åˆ†ç±»ç­›é€‰ï¼ˆä»…äº§å“æœç´¢ï¼‰
- `price_range`: ä»·æ ¼èŒƒå›´ï¼ˆä»…äº§å“æœç´¢ï¼‰

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "results": [
      {
        "type": "product",
        "id": 456,
        "title": "iPhone 15 Pro",
        "description": "æœ€æ–°æ¬¾iPhoneï¼Œé…å¤‡A17èŠ¯ç‰‡",
        "price": 999.99,
        "image": "https://example.com/image1.jpg",
        "relevance_score": 0.95
      }
    ],
    "pagination": {
      "current_page": 1,
      "per_page": 20,
      "total": 25,
      "total_pages": 2
    },
    "search_time": 0.15,
    "suggestions": [
      "iPhone 15",
      "iPhone Pro",
      "iPhone 15 Pro Max"
    ]
  }
}
```

### 5.8 APIé™æµå’Œç¼“å­˜

#### 5.8.1 é™æµç­–ç•¥

**é™æµè§„åˆ™**
```http
# å“åº”å¤´ä¸­åŒ…å«é™æµä¿¡æ¯
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 95
X-RateLimit-Reset: 1693065760
```

| ç«¯ç‚¹ç±»å‹ | é™åˆ¶ | çª—å£æ—¶é—´ |
|----------|------|----------|
| è®¤è¯ç«¯ç‚¹ | 10æ¬¡/åˆ†é’Ÿ | 1åˆ†é’Ÿ |
| è¯»å–ç«¯ç‚¹ | 100æ¬¡/åˆ†é’Ÿ | 1åˆ†é’Ÿ |
| å†™å…¥ç«¯ç‚¹ | 30æ¬¡/åˆ†é’Ÿ | 1åˆ†é’Ÿ |
| æ–‡ä»¶ä¸Šä¼  | 10æ¬¡/åˆ†é’Ÿ | 1åˆ†é’Ÿ |

#### 5.8.2 ç¼“å­˜æœºåˆ¶

**ç¼“å­˜å¤´ä¿¡æ¯**
```http
Cache-Control: public, max-age=300
ETag: "abc123def456"
Last-Modified: Mon, 26 Aug 2025 17:22:40 GMT
```

**ç¼“å­˜ç­–ç•¥**
- é™æ€èµ„æºï¼š1å¹´ç¼“å­˜
- APIå“åº”ï¼š5åˆ†é’Ÿç¼“å­˜
- ç”¨æˆ·æ•°æ®ï¼šä¸ç¼“å­˜
- äº§å“åˆ—è¡¨ï¼š1å°æ—¶ç¼“å­˜

### 5.9 WebSocket API

#### 5.9.1 è¿æ¥å»ºç«‹

```javascript
// å»ºç«‹WebSocketè¿æ¥
const ws = new WebSocket('wss://api.yourapp.com/ws');

// è®¤è¯
ws.onopen = function() {
  ws.send(JSON.stringify({
    type: 'auth',
    token: 'Bearer ' + jwt_token
  }));
};
```

#### 5.9.2 å®æ—¶é€šçŸ¥

**è®¢å•çŠ¶æ€æ›´æ–°é€šçŸ¥**
```json
{
  "type": "order_update",
  "data": {
    "order_id": 789,
    "status": "shipped",
    "tracking_number": "1234567890",
    "message": "æ‚¨çš„è®¢å•å·²å‘è´§"
  },
  "timestamp": "2025-08-26T17:22:40Z"
}
```

**ç³»ç»Ÿé€šçŸ¥**
```json
{
  "type": "system_notification",
  "data": {
    "title": "ç³»ç»Ÿç»´æŠ¤é€šçŸ¥",
    "message": "ç³»ç»Ÿå°†åœ¨ä»Šæ™š23:00-01:00è¿›è¡Œç»´æŠ¤",
    "level": "info"
  },
  "timestamp": "2025-08-26T17:22:40Z"
}
```

### 5.10 é”™è¯¯å¤„ç†

#### 5.10.1 é”™è¯¯ä»£ç 

| é”™è¯¯ä»£ç  | HTTPçŠ¶æ€ | æè¿° |
|----------|----------|------|
| VALIDATION_ERROR | 400 | è¯·æ±‚å‚æ•°éªŒè¯å¤±è´¥ |
| AUTHENTICATION_FAILED | 401 | è®¤è¯å¤±è´¥ |
| TOKEN_EXPIRED | 401 | ä»¤ç‰Œå·²è¿‡æœŸ |
| PERMISSION_DENIED | 403 | æƒé™ä¸è¶³ |
| RESOURCE_NOT_FOUND | 404 | èµ„æºä¸å­˜åœ¨ |
| DUPLICATE_RESOURCE | 409 | èµ„æºå·²å­˜åœ¨ |
| RATE_LIMIT_EXCEEDED | 429 | è¯·æ±‚é¢‘ç‡è¶…é™ |
| INTERNAL_ERROR | 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

#### 5.10.2 é”™è¯¯å“åº”ç¤ºä¾‹

```json
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "è¯·æ±‚å‚æ•°éªŒè¯å¤±è´¥",
    "details": [
      {
        "field": "email",
        "message": "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®",
        "value": "invalid-email"
      },
      {
        "field": "password",
        "message": "å¯†ç é•¿åº¦è‡³å°‘8ä½",
        "value": "****"
      }
    ]
  },
  "request_id": "req_abc123def456",
  "timestamp": "2025-08-26T17:22:40Z"
}
```

---

## 6. æ•°æ®åº“ç»“æ„è¯´æ˜

### 6.1 æ•°æ®åº“è®¾è®¡åŸåˆ™

#### 6.1.1 è®¾è®¡åŸåˆ™

**è§„èŒƒåŒ–åŸåˆ™**
- éµå¾ªç¬¬ä¸‰èŒƒå¼ï¼ˆ3NFï¼‰ï¼Œé¿å…æ•°æ®å†—ä½™
- é€‚å½“çš„åè§„èŒƒåŒ–ä»¥æé«˜æŸ¥è¯¢æ€§èƒ½
- ä½¿ç”¨å¤–é”®çº¦æŸä¿è¯æ•°æ®å®Œæ•´æ€§

**æ€§èƒ½ä¼˜åŒ–åŸåˆ™**
- åˆç†è®¾è®¡ç´¢å¼•ç­–ç•¥
- åˆ†åŒºè¡¨å¤„ç†å¤§æ•°æ®é‡
- è¯»å†™åˆ†ç¦»æ¶æ„æ”¯æŒ

**æ‰©å±•æ€§åŸåˆ™**
- æ”¯æŒæ°´å¹³å’Œå‚ç›´æ‰©å±•
- é¢„ç•™æ‰©å±•å­—æ®µ
- æ¨¡å—åŒ–è¡¨ç»“æ„è®¾è®¡

#### 6.1.2 æ•°æ®åº“é…ç½®

**PostgreSQLé…ç½®**
```sql
-- æ•°æ®åº“åˆ›å»º
CREATE DATABASE myapp_production
  WITH 
  ENCODING = 'UTF8'
  LC_COLLATE = 'en_US.UTF-8'
  LC_CTYPE = 'en_US.UTF-8'
  TEMPLATE = template0;

-- ç”¨æˆ·åˆ›å»º
CREATE USER myapp_user WITH PASSWORD 'secure_password';
GRANT ALL PRIVILEGES ON DATABASE myapp_production TO myapp_user;
```

**è¿æ¥æ± é…ç½®**
```javascript
// config/database.js
module.exports = {
  development: {
    username: 'postgres',
    password: 'password',
    database: 'myapp_dev',
    host: '127.0.0.1',
    port: 5432,
    dialect: 'postgres',
    pool: {
      max: 5,
      min: 0,
      acquire: 30000,
      idle: 10000
    }
  },
  production: {
    username: process.env.DB_USERNAME,
    password: process.env.DB_PASSWORD,
    database: process.env.DB_NAME,
    host: process.env.DB_HOST,
    port: process.env.DB_PORT,
    dialect: 'postgres',
    pool: {
      max: 20,
      min: 5,
      acquire: 30000,
      idle: 10000
    }
  }
};
```

### 6.2 æ ¸å¿ƒæ•°æ®è¡¨ç»“æ„

#### 6.2.1 ç”¨æˆ·ç›¸å…³è¡¨

**usersè¡¨ - ç”¨æˆ·åŸºç¡€ä¿¡æ¯**
```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    full_name VARCHAR(100),
    phone VARCHAR(20),
    role user_role DEFAULT 'user',
    is_active BOOLEAN DEFAULT false,
    email_verified_at TIMESTAMP,
    last_login TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- åˆ›å»ºæšä¸¾ç±»å‹
CREATE TYPE user_role AS ENUM ('admin', 'manager', 'user', 'guest');

-- ç´¢å¼•
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_username ON users(username);
CREATE INDEX idx_users_role ON users(role);
CREATE INDEX idx_users_created_at ON users(created_at);
```

**user_profilesè¡¨ - ç”¨æˆ·è¯¦ç»†èµ„æ–™**
```sql
CREATE TABLE user_profiles (
    id SERIAL PRIMARY KEY,
    user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    avatar_url VARCHAR(500),
    bio TEXT,
    birth_date DATE,
    gender gender_type,
    country VARCHAR(100),
    city VARCHAR(100),
    timezone VARCHAR(50) DEFAULT 'UTC',
    language VARCHAR(10) DEFAULT 'en',
    preferences JSONB DEFAULT '{}',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TYPE gender_type AS ENUM ('male', 'female', 'other', 'prefer_not_to_say');

-- å”¯ä¸€çº¦æŸå’Œç´¢å¼•
CREATE UNIQUE INDEX idx_user_profiles_user_id ON user_profiles(user_id);
```

**user_sessionsè¡¨ - ç”¨æˆ·ä¼šè¯ç®¡ç†**
```sql
CREATE TABLE user_sessions (
    id VARCHAR(128) PRIMARY KEY,
    user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    access_token TEXT NOT NULL,
    refresh_token TEXT,
    expires_at TIMESTAMP NOT NULL,
    client_info JSONB,
    ip_address INET,
    is_active BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ç´¢å¼•
CREATE INDEX idx_user_sessions_user_id ON user_sessions(user_id);
CREATE INDEX idx_user_sessions_expires_at ON user_sessions(expires_at);
CREATE INDEX idx_user_sessions_active ON user_sessions(is_active);
```

#### 6.2.2 äº§å“ç›¸å…³è¡¨

**categoriesè¡¨ - äº§å“åˆ†ç±»**
```sql
CREATE TABLE categories (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    slug VARCHAR(100) UNIQUE NOT NULL,
    description TEXT,
    parent_id INTEGER REFERENCES categories(id),
    sort_order INTEGER DEFAULT 0,
    is_active BOOLEAN DEFAULT true,
    meta_title VARCHAR(150),
    meta_description VARCHAR(300),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ç´¢å¼•
CREATE INDEX idx_categories_parent_id ON categories(parent_id);
CREATE INDEX idx_categories_slug ON categories(slug);
CREATE INDEX idx_categories_active ON categories(is_active);
```

**productsè¡¨ - äº§å“åŸºç¡€ä¿¡æ¯**
```sql
CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    name VARCHAR(200) NOT NULL,
    slug VARCHAR(200) UNIQUE NOT NULL,
    description TEXT,
    short_description VARCHAR(500),
    sku VARCHAR(100) UNIQUE,
    price DECIMAL(10,2) NOT NULL,
    sale_price DECIMAL(10,2),
    cost_price DECIMAL(10,2),
    category_id INTEGER REFERENCES categories(id),
    specifications JSONB DEFAULT '{}',
    dimensions JSONB, -- {length, width, height, weight}
    status product_status DEFAULT 'draft',
    stock_quantity INTEGER DEFAULT 0,
    low_stock_threshold INTEGER DEFAULT 10,
    manage_stock BOOLEAN DEFAULT true,
    featured BOOLEAN DEFAULT false,
    meta_title VARCHAR(150),
    meta_description VARCHAR(300),
    created_by INTEGER REFERENCES users(id),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TYPE product_status AS ENUM ('draft', 'active', 'inactive', 'discontinued');

-- ç´¢å¼•
CREATE INDEX idx_products_category_id ON products(category_id);
CREATE INDEX idx_products_status ON products(status);
CREATE INDEX idx_products_price ON products(price);
CREATE INDEX idx_products_created_at ON products(created_at);
CREATE INDEX idx_products_featured ON products(featured);
CREATE INDEX idx_products_name_search ON products USING GIN(to_tsvector('english', name));
```

**product_imagesè¡¨ - äº§å“å›¾ç‰‡**
```sql
CREATE TABLE product_images (
    id SERIAL PRIMARY KEY,
    product_id INTEGER NOT NULL REFERENCES products(id) ON DELETE CASCADE,
    file_id INTEGER REFERENCES files(id),
    url VARCHAR(500) NOT NULL,
    alt_text VARCHAR(255),
    sort_order INTEGER DEFAULT 0,
    is_primary BOOLEAN DEFAULT false,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ç´¢å¼•
CREATE INDEX idx_product_images_product_id ON product_images(product_id);
CREATE INDEX idx_product_images_primary ON product_images(is_primary);
```

#### 6.2.3 è®¢å•ç›¸å…³è¡¨

**ordersè¡¨ - è®¢å•ä¸»è¡¨**
```sql
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    order_number VARCHAR(50) UNIQUE NOT NULL,
    user_id INTEGER NOT NULL REFERENCES users(id),
    status order_status DEFAULT 'pending',
    payment_status payment_status DEFAULT 'pending',
    total_amount DECIMAL(10,2) NOT NULL,
    subtotal DECIMAL(10,2) NOT NULL,
    tax_amount DECIMAL(10,2) DEFAULT 0,
    shipping_amount DECIMAL(10,2) DEFAULT 0,
    discount_amount DECIMAL(10,2) DEFAULT 0,
    currency VARCHAR(3) DEFAULT 'USD',
    
    -- åœ°å€ä¿¡æ¯
    shipping_address JSONB NOT NULL,
    billing_address JSONB,
    
    -- æ”¯ä»˜ä¿¡æ¯
    payment_method VARCHAR(50),
    payment_reference VARCHAR(100),
    
    -- ç‰©æµä¿¡æ¯
    shipping_method VARCHAR(50),
    tracking_number VARCHAR(100),
    shipped_date TIMESTAMP,
    delivered_date TIMESTAMP,
    
    -- å¤‡æ³¨
    notes TEXT,
    admin_notes TEXT,
    
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TYPE order_status AS ENUM (
    'pending', 'confirmed', 'processing', 'shipped', 
    'delivered', 'cancelled', 'refunded', 'returned'
);

CREATE TYPE payment_status AS ENUM (
    'pending', 'processing', 'completed', 'failed', 
    'cancelled', 'refunded', 'partial_refund'
);

-- ç´¢å¼•
CREATE INDEX idx_orders_user_id ON orders(user_id);
CREATE INDEX idx_orders_status ON orders(status);
CREATE INDEX idx_orders_payment_status ON orders(payment_status);
CREATE INDEX idx_orders_created_at ON orders(created_at);
CREATE INDEX idx_orders_order_number ON orders(order_number);
```

**order_itemsè¡¨ - è®¢å•å•†å“æ˜ç»†**
```sql
CREATE TABLE order_items (
    id SERIAL PRIMARY KEY,
    order_id INTEGER NOT NULL REFERENCES orders(id) ON DELETE CASCADE,
    product_id INTEGER NOT NULL REFERENCES products(id),
    quantity INTEGER NOT NULL CHECK (quantity > 0),
    unit_price DECIMAL(10,2) NOT NULL,
    total_price DECIMAL(10,2) NOT NULL,
    
    -- äº§å“å¿«ç…§ï¼Œä¿å­˜ä¸‹å•æ—¶çš„äº§å“ä¿¡æ¯
    product_snapshot JSONB NOT NULL,
    
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ç´¢å¼•
CREATE INDEX idx_order_items_order_id ON order_items(order_id);
CREATE INDEX idx_order_items_product_id ON order_items(product_id);
```

#### 6.2.4 ç³»ç»Ÿæ”¯æŒè¡¨

**filesè¡¨ - æ–‡ä»¶ç®¡ç†**
```sql
CREATE TABLE files (
    id SERIAL PRIMARY KEY,
    original_name VARCHAR(255) NOT NULL,
    stored_name VARCHAR(255) NOT NULL,
    file_path VARCHAR(500) NOT NULL,
    mime_type VARCHAR(100) NOT NULL,
    file_size BIGINT NOT NULL,
    file_hash VARCHAR(64) UNIQUE NOT NULL,
    
    -- å›¾ç‰‡ä¿¡æ¯
    width INTEGER,
    height INTEGER,
    
    -- å…ƒæ•°æ®
    alt_text VARCHAR(255),
    caption TEXT,
    category file_category DEFAULT 'general',
    
    uploaded_by INTEGER REFERENCES users(id),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TYPE file_category AS ENUM (
    'general', 'avatar', 'product_image', 'document', 'media'
);

-- ç´¢å¼•
CREATE INDEX idx_files_hash ON files(file_hash);
CREATE INDEX idx_files_category ON files(category);
CREATE INDEX idx_files_uploaded_by ON files(uploaded_by);
```

**audit_logsè¡¨ - æ“ä½œæ—¥å¿—**
```sql
CREATE TABLE audit_logs (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    table_name VARCHAR(50) NOT NULL,
    record_id INTEGER,
    action audit_action NOT NULL,
    old_values JSONB,
    new_values JSONB,
    ip_address INET,
    user_agent TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TYPE audit_action AS ENUM ('CREATE', 'UPDATE', 'DELETE', 'LOGIN', 'LOGOUT');

-- ç´¢å¼•
CREATE INDEX idx_audit_logs_user_id ON audit_logs(user_id);
CREATE INDEX idx_audit_logs_table_record ON audit_logs(table_name, record_id);
CREATE INDEX idx_audit_logs_action ON audit_logs(action);
CREATE INDEX idx_audit_logs_created_at ON audit_logs(created_at);
```

### 6.3 æ•°æ®å…³ç³»å›¾

è¯·å‚è€ƒä¸Šé¢ç”Ÿæˆçš„æ•°æ®åº“ç»“æ„å›¾ï¼Œå±•ç¤ºäº†ä¸»è¦è¡¨ä¹‹é—´çš„å…³ç³»ï¼š

![æ•°æ®åº“ç»“æ„å›¾](charts/database_schema.png)

### 6.4 æ•°æ®åº“çº¦æŸå’Œè§¦å‘å™¨

#### 6.4.1 çº¦æŸå®šä¹‰

**æ£€æŸ¥çº¦æŸ**
```sql
-- ä»·æ ¼çº¦æŸ
ALTER TABLE products ADD CONSTRAINT chk_price_positive 
CHECK (price > 0);

ALTER TABLE products ADD CONSTRAINT chk_sale_price_valid 
CHECK (sale_price IS NULL OR sale_price <= price);

-- åº“å­˜çº¦æŸ
ALTER TABLE products ADD CONSTRAINT chk_stock_non_negative 
CHECK (stock_quantity >= 0);

-- æ•°é‡çº¦æŸ
ALTER TABLE order_items ADD CONSTRAINT chk_quantity_positive 
CHECK (quantity > 0);
```

**å¤–é”®çº¦æŸ**
```sql
-- çº§è”åˆ é™¤
ALTER TABLE user_profiles 
ADD CONSTRAINT fk_user_profiles_user 
FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE;

-- é™åˆ¶åˆ é™¤
ALTER TABLE products 
ADD CONSTRAINT fk_products_category 
FOREIGN KEY (category_id) REFERENCES categories(id) ON DELETE RESTRICT;
```

#### 6.4.2 è§¦å‘å™¨å‡½æ•°

**è‡ªåŠ¨æ›´æ–°updated_atå­—æ®µ**
```sql
-- åˆ›å»ºè§¦å‘å™¨å‡½æ•°
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = CURRENT_TIMESTAMP;
    RETURN NEW;
END;
$$ language plpgsql;

-- åº”ç”¨åˆ°ç›¸å…³è¡¨
CREATE TRIGGER update_users_updated_at 
    BEFORE UPDATE ON users 
    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER update_products_updated_at 
    BEFORE UPDATE ON products 
    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();
```

**è‡ªåŠ¨ç”Ÿæˆè®¢å•å·**
```sql
CREATE OR REPLACE FUNCTION generate_order_number()
RETURNS TRIGGER AS $$
BEGIN
    NEW.order_number = 'ORD-' || TO_CHAR(CURRENT_DATE, 'YYYY-MM-DD') || '-' || 
                       LPAD(nextval('order_number_seq')::TEXT, 6, '0');
    RETURN NEW;
END;
$$ language plpgsql;

-- åˆ›å»ºåºåˆ—
CREATE SEQUENCE order_number_seq START 1;

-- åˆ›å»ºè§¦å‘å™¨
CREATE TRIGGER generate_order_number_trigger 
    BEFORE INSERT ON orders 
    FOR EACH ROW EXECUTE FUNCTION generate_order_number();
```

**å®¡è®¡æ—¥å¿—è§¦å‘å™¨**
```sql
CREATE OR REPLACE FUNCTION audit_trigger()
RETURNS TRIGGER AS $$
BEGIN
    IF TG_OP = 'INSERT' THEN
        INSERT INTO audit_logs (user_id, table_name, record_id, action, new_values, ip_address)
        VALUES (NEW.created_by, TG_TABLE_NAME, NEW.id, 'CREATE', row_to_json(NEW), inet_client_addr());
        RETURN NEW;
    ELSIF TG_OP = 'UPDATE' THEN
        INSERT INTO audit_logs (user_id, table_name, record_id, action, old_values, new_values, ip_address)
        VALUES (NEW.updated_by, TG_TABLE_NAME, NEW.id, 'UPDATE', row_to_json(OLD), row_to_json(NEW), inet_client_addr());
        RETURN NEW;
    ELSIF TG_OP = 'DELETE' THEN
        INSERT INTO audit_logs (user_id, table_name, record_id, action, old_values, ip_address)
        VALUES (OLD.updated_by, TG_TABLE_NAME, OLD.id, 'DELETE', row_to_json(OLD), inet_client_addr());
        RETURN OLD;
    END IF;
    RETURN NULL;
END;
$$ language plpgsql;
```

### 6.5 ç´¢å¼•ç­–ç•¥

#### 6.5.1 åŸºç¡€ç´¢å¼•

**ä¸»é”®å’Œå”¯ä¸€ç´¢å¼•**
```sql
-- å¤åˆå”¯ä¸€ç´¢å¼•
CREATE UNIQUE INDEX idx_product_sku_active 
ON products(sku) WHERE status = 'active';

-- éƒ¨åˆ†ç´¢å¼•
CREATE INDEX idx_orders_pending 
ON orders(created_at) WHERE status = 'pending';
```

**æŸ¥è¯¢ä¼˜åŒ–ç´¢å¼•**
```sql
-- å¤åˆç´¢å¼•ç”¨äºå¸¸è§æŸ¥è¯¢
CREATE INDEX idx_products_category_status_price 
ON products(category_id, status, price);

-- å…¨æ–‡æœç´¢ç´¢å¼•
CREATE INDEX idx_products_search 
ON products USING GIN(to_tsvector('english', name || ' ' || COALESCE(description, '')));
```

#### 6.5.2 æ€§èƒ½ä¼˜åŒ–ç´¢å¼•

**åˆ†åŒºç´¢å¼•**
```sql
-- æŒ‰æ—¥æœŸåˆ†åŒºçš„è®¢å•è¡¨
CREATE TABLE orders_y2025m08 PARTITION OF orders
FOR VALUES FROM ('2025-08-01') TO ('2025-09-01');

-- åˆ†åŒºç´¢å¼•
CREATE INDEX idx_orders_y2025m08_user_id ON orders_y2025m08(user_id);
```

### 6.6 æ•°æ®è¿ç§»è„šæœ¬

#### 6.6.1 åˆå§‹åŒ–è„šæœ¬

**database/migrations/001_create_initial_tables.js**
```javascript
'use strict';

module.exports = {
  up: async (queryInterface, Sequelize) => {
    // åˆ›å»ºç”¨æˆ·è¡¨
    await queryInterface.createTable('users', {
      id: {
        allowNull: false,
        autoIncrement: true,
        primaryKey: true,
        type: Sequelize.INTEGER
      },
      username: {
        type: Sequelize.STRING(50),
        allowNull: false,
        unique: true
      },
      email: {
        type: Sequelize.STRING(255),
        allowNull: false,
        unique: true
      },
      password_hash: {
        type: Sequelize.STRING(255),
        allowNull: false
      },
      full_name: {
        type: Sequelize.STRING(100)
      },
      phone: {
        type: Sequelize.STRING(20)
      },
      role: {
        type: Sequelize.ENUM('admin', 'manager', 'user', 'guest'),
        defaultValue: 'user'
      },
      is_active: {
        type: Sequelize.BOOLEAN,
        defaultValue: false
      },
      email_verified_at: {
        type: Sequelize.DATE
      },
      last_login: {
        type: Sequelize.DATE
      },
      created_at: {
        allowNull: false,
        type: Sequelize.DATE,
        defaultValue: Sequelize.literal('CURRENT_TIMESTAMP')
      },
      updated_at: {
        allowNull: false,
        type: Sequelize.DATE,
        defaultValue: Sequelize.literal('CURRENT_TIMESTAMP')
      }
    });

    // æ·»åŠ ç´¢å¼•
    await queryInterface.addIndex('users', ['email']);
    await queryInterface.addIndex('users', ['username']);
    await queryInterface.addIndex('users', ['role']);
  },

  down: async (queryInterface, Sequelize) => {
    await queryInterface.dropTable('users');
  }
};
```

#### 6.6.2 ç§å­æ•°æ®

**database/seeders/001_admin_user.js**
```javascript
'use strict';

const bcrypt = require('bcryptjs');

module.exports = {
  up: async (queryInterface, Sequelize) => {
    const hashedPassword = await bcrypt.hash('admin123456', 12);
    
    await queryInterface.bulkInsert('users', [{
      username: 'admin',
      email: 'admin@yourapp.com',
      password_hash: hashedPassword,
      full_name: 'System Administrator',
      role: 'admin',
      is_active: true,
      email_verified_at: new Date(),
      created_at: new Date(),
      updated_at: new Date()
    }]);
  },

  down: async (queryInterface, Sequelize) => {
    await queryInterface.bulkDelete('users', {
      email: 'admin@yourapp.com'
    });
  }
};
```

### 6.7 æ•°æ®å¤‡ä»½å’Œæ¢å¤

#### 6.7.1 å¤‡ä»½ç­–ç•¥

**å®Œæ•´å¤‡ä»½**
```bash
#!/bin/bash
# scripts/backup-full.sh

DB_NAME="myapp_production"
DB_USER="myapp_user"
BACKUP_DIR="/backup/full"
DATE=$(date +%Y%m%d_%H%M%S)

# åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p ${BACKUP_DIR}

# å®Œæ•´å¤‡ä»½
pg_dump -h localhost -U ${DB_USER} -d ${DB_NAME} \
  --verbose --no-acl --no-owner \
  > ${BACKUP_DIR}/full_backup_${DATE}.sql

# å‹ç¼©å¤‡ä»½æ–‡ä»¶
gzip ${BACKUP_DIR}/full_backup_${DATE}.sql

echo "å®Œæ•´å¤‡ä»½å®Œæˆ: full_backup_${DATE}.sql.gz"
```

**å¢é‡å¤‡ä»½**
```bash
#!/bin/bash
# scripts/backup-incremental.sh

# å¯ç”¨WALå½’æ¡£
pg_receivewal -h localhost -U replication_user -D /backup/wal
```

#### 6.7.2 æ¢å¤è„šæœ¬

**æ•°æ®åº“æ¢å¤**
```bash
#!/bin/bash
# scripts/restore-db.sh

BACKUP_FILE=${1}
DB_NAME="myapp_production"
DB_USER="myapp_user"

if [ -z "$BACKUP_FILE" ]; then
    echo "ä½¿ç”¨æ–¹æ³•: $0 <backup_file>"
    exit 1
fi

echo "æ¢å¤æ•°æ®åº“ä»: $BACKUP_FILE"

# åœæ­¢åº”ç”¨æœåŠ¡
systemctl stop myapp

# åˆ é™¤ç°æœ‰æ•°æ®åº“
dropdb -h localhost -U postgres ${DB_NAME}

# åˆ›å»ºæ–°æ•°æ®åº“
createdb -h localhost -U postgres ${DB_NAME}

# æ¢å¤æ•°æ®
gunzip -c ${BACKUP_FILE} | psql -h localhost -U ${DB_USER} -d ${DB_NAME}

# é‡æ–°å¯åŠ¨æœåŠ¡
systemctl start myapp

echo "æ•°æ®åº“æ¢å¤å®Œæˆ"
```

### 6.8 æ•°æ®åº“ç›‘æ§

#### 6.8.1 æ€§èƒ½ç›‘æ§æŸ¥è¯¢

**è¿æ¥æ•°ç›‘æ§**
```sql
-- æŸ¥çœ‹å½“å‰è¿æ¥æ•°
SELECT count(*) as connection_count 
FROM pg_stat_activity;

-- æŸ¥çœ‹å„æ•°æ®åº“è¿æ¥æ•°
SELECT datname, count(*) as connections 
FROM pg_stat_activity 
GROUP BY datname;
```

**æ…¢æŸ¥è¯¢ç›‘æ§**
```sql
-- æŸ¥çœ‹æ…¢æŸ¥è¯¢
SELECT query, calls, total_time, mean_time, rows
FROM pg_stat_statements 
ORDER BY mean_time DESC 
LIMIT 10;
```

**é”ç›‘æ§**
```sql
-- æŸ¥çœ‹å½“å‰é”æƒ…å†µ
SELECT 
    pg_stat_activity.datname,
    pg_class.relname,
    pg_locks.transactionid,
    pg_locks.mode,
    pg_stat_activity.usename,
    pg_stat_activity.query,
    pg_stat_activity.query_start,
    age(now(), pg_stat_activity.query_start) AS "duration"
FROM pg_stat_activity, pg_locks 
LEFT OUTER JOIN pg_class ON (pg_locks.relation = pg_class.oid)
WHERE pg_locks.pid = pg_stat_activity.pid
ORDER BY query_start;
```

#### 6.8.2 ç›‘æ§è„šæœ¬

**database/scripts/monitor.js**
```javascript
const { Client } = require('pg');

async function checkDatabaseHealth() {
  const client = new Client({
    host: process.env.DB_HOST,
    port: process.env.DB_PORT,
    database: process.env.DB_NAME,
    user: process.env.DB_USERNAME,
    password: process.env.DB_PASSWORD,
  });

  try {
    await client.connect();
    
    // æ£€æŸ¥è¿æ¥æ•°
    const connectionResult = await client.query(`
      SELECT count(*) as connection_count 
      FROM pg_stat_activity
    `);
    
    // æ£€æŸ¥æ•°æ®åº“å¤§å°
    const sizeResult = await client.query(`
      SELECT 
        pg_database.datname,
        pg_database_size(pg_database.datname) as size
      FROM pg_database
      WHERE datname = $1
    `, [process.env.DB_NAME]);
    
    // æ£€æŸ¥è¡¨å¤§å°
    const tableSizeResult = await client.query(`
      SELECT 
        schemaname,
        tablename,
        pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) as size
      FROM pg_tables 
      WHERE schemaname = 'public'
      ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC
      LIMIT 10
    `);
    
    console.log('æ•°æ®åº“å¥åº·æ£€æŸ¥ç»“æœ:');
    console.log('è¿æ¥æ•°:', connectionResult.rows[0].connection_count);
    console.log('æ•°æ®åº“å¤§å°:', sizeResult.rows[0].size);
    console.log('Top 10 è¡¨å¤§å°:', tableSizeResult.rows);
    
  } catch (error) {
    console.error('æ•°æ®åº“å¥åº·æ£€æŸ¥å¤±è´¥:', error);
  } finally {
    await client.end();
  }
}

// æ‰§è¡Œæ£€æŸ¥
checkDatabaseHealth();
```

---

## 7. ç³»ç»Ÿæ¶æ„å›¾å’ŒæŠ€æœ¯æ–‡æ¡£

### 7.1 ç³»ç»Ÿæ•´ä½“æ¶æ„

![ç³»ç»Ÿæ¶æ„å›¾](charts/system_architecture.png)

æœ¬ç³»ç»Ÿé‡‡ç”¨ç°ä»£åŒ–çš„åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œæ”¯æŒé«˜å¹¶å‘ã€é«˜å¯ç”¨æ€§å’Œæ°´å¹³æ‰©å±•ã€‚æ¶æ„åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªå±‚æ¬¡ï¼š

#### 7.1.1 å®¢æˆ·ç«¯å±‚ï¼ˆPresentation Layerï¼‰

**Webå‰ç«¯**
- **æŠ€æœ¯æ ˆ**: React 18 + TypeScript + Ant Design
- **ç‰¹ç‚¹**: å“åº”å¼è®¾è®¡ã€ç»„ä»¶åŒ–å¼€å‘ã€çŠ¶æ€ç®¡ç†
- **åŠŸèƒ½**: ç”¨æˆ·ç•Œé¢å±•ç¤ºã€ç”¨æˆ·äº¤äº’å¤„ç†ã€å‰ç«¯è·¯ç”±

**ç§»åŠ¨ç«¯åº”ç”¨**
- **æŠ€æœ¯æ ˆ**: React Native / Flutter
- **ç‰¹ç‚¹**: è·¨å¹³å°å¼€å‘ã€åŸç”Ÿæ€§èƒ½ã€ç¦»çº¿æ”¯æŒ
- **åŠŸèƒ½**: ç§»åŠ¨ç«¯ç•Œé¢ã€æ¨é€é€šçŸ¥ã€è®¾å¤‡ç‰¹æ€§é›†æˆ

**æ¡Œé¢åº”ç”¨**
- **æŠ€æœ¯æ ˆ**: Electron
- **ç‰¹ç‚¹**: è·¨å¹³å°ã€æœ¬åœ°å­˜å‚¨ã€ç³»ç»Ÿé›†æˆ
- **åŠŸèƒ½**: æ¡Œé¢ç«¯ç•Œé¢ã€æ–‡ä»¶æ“ä½œã€ç³»ç»Ÿé€šçŸ¥

#### 7.1.2 ç½‘å…³å±‚ï¼ˆGateway Layerï¼‰

**APIç½‘å…³**
- **åŠŸèƒ½**: è·¯ç”±è½¬å‘ã€è´Ÿè½½å‡è¡¡ã€APIèšåˆ
- **ç‰¹æ€§**: é™æµã€ç¼“å­˜ã€å®‰å…¨è¿‡æ»¤ã€ç›‘æ§
- **å®ç°**: Kong / Nginx / AWS API Gateway

**è´Ÿè½½å‡è¡¡å™¨**
- **åŠŸèƒ½**: æµé‡åˆ†å‘ã€å¥åº·æ£€æŸ¥ã€æ•…éšœè½¬ç§»
- **ç®—æ³•**: è½®è¯¢ã€åŠ æƒè½®è¯¢ã€æœ€å°‘è¿æ¥ã€IPå“ˆå¸Œ
- **å®ç°**: Nginx / HAProxy / Cloud Load Balancer

#### 7.1.3 æœåŠ¡å±‚ï¼ˆService Layerï¼‰

**å¾®æœåŠ¡æ¶æ„**
- **ç”¨æˆ·æœåŠ¡**: ç”¨æˆ·ç®¡ç†ã€è®¤è¯æˆæƒã€æƒé™æ§åˆ¶
- **ä¸šåŠ¡æœåŠ¡**: æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ã€æ•°æ®å¤„ç†ã€ä¸šåŠ¡è§„åˆ™
- **è®¤è¯æœåŠ¡**: JWTä»¤ç‰Œç®¡ç†ã€OAuthé›†æˆã€å•ç‚¹ç™»å½•
- **æ–‡ä»¶æœåŠ¡**: æ–‡ä»¶ä¸Šä¼ ã€å­˜å‚¨ç®¡ç†ã€CDNåˆ†å‘

**æœåŠ¡é€šä¿¡**
- **åŒæ­¥é€šä¿¡**: RESTful APIã€GraphQL
- **å¼‚æ­¥é€šä¿¡**: æ¶ˆæ¯é˜Ÿåˆ—ã€äº‹ä»¶é©±åŠ¨
- **æœåŠ¡å‘ç°**: Consulã€Eurekaã€Kubernetes Service

#### 7.1.4 æ•°æ®å±‚ï¼ˆData Layerï¼‰

**å…³ç³»æ•°æ®åº“**
- **ä¸»æ•°æ®åº“**: PostgreSQL 15
- **åŠŸèƒ½**: äº‹åŠ¡æ•°æ®å­˜å‚¨ã€ACIDä¿è¯ã€å¤æ‚æŸ¥è¯¢
- **ä¼˜åŒ–**: ä¸»ä»å¤åˆ¶ã€è¯»å†™åˆ†ç¦»ã€è¿æ¥æ± 

**NoSQLæ•°æ®åº“**
- **æ–‡æ¡£æ•°æ®åº“**: MongoDB
- **åŠŸèƒ½**: çµæ´»æ•°æ®å­˜å‚¨ã€æ°´å¹³æ‰©å±•ã€æ–‡æ¡£æŸ¥è¯¢
- **ä½¿ç”¨åœºæ™¯**: æ—¥å¿—å­˜å‚¨ã€å†…å®¹ç®¡ç†ã€ç”¨æˆ·è¡Œä¸º

**ç¼“å­˜å±‚**
- **å†…å­˜ç¼“å­˜**: Redis / Memcached
- **åŠŸèƒ½**: çƒ­ç‚¹æ•°æ®ç¼“å­˜ã€ä¼šè¯å­˜å‚¨ã€åˆ†å¸ƒå¼é”
- **ç­–ç•¥**: LRUã€è¿‡æœŸç­–ç•¥ã€ç¼“å­˜ç©¿é€é˜²æŠ¤

#### 7.1.5 åŸºç¡€è®¾æ–½å±‚ï¼ˆInfrastructure Layerï¼‰

**æ¶ˆæ¯é˜Ÿåˆ—**
- **å®ç°**: RabbitMQ / Apache Kafka
- **åŠŸèƒ½**: å¼‚æ­¥å¤„ç†ã€ç³»ç»Ÿè§£è€¦ã€å‰Šå³°å¡«è°·
- **æ¨¡å¼**: å‘å¸ƒè®¢é˜…ã€å·¥ä½œé˜Ÿåˆ—ã€RPC

**æ—¥å¿—ç³»ç»Ÿ**
- **æ”¶é›†**: Fluentd / Logstash
- **å­˜å‚¨**: Elasticsearch
- **å¯è§†åŒ–**: Kibana / Grafana
- **åŠŸèƒ½**: é›†ä¸­æ—¥å¿—ã€æŸ¥è¯¢åˆ†æã€å‘Šè­¦é€šçŸ¥

**ç›‘æ§ç³»ç»Ÿ**
- **æŒ‡æ ‡æ”¶é›†**: Prometheus
- **å¯è§†åŒ–**: Grafana
- **å‘Šè­¦**: AlertManager
- **é“¾è·¯è¿½è¸ª**: Jaeger / Zipkin

**æ–‡ä»¶å­˜å‚¨**
- **å¯¹è±¡å­˜å‚¨**: AWS S3 / é˜¿é‡Œäº‘OSS
- **åŠŸèƒ½**: é™æ€æ–‡ä»¶å­˜å‚¨ã€CDNåˆ†å‘ã€ç‰ˆæœ¬æ§åˆ¶
- **ä¼˜åŒ–**: å‹ç¼©ã€ç¼“å­˜ã€åœ°ç†åˆ†å¸ƒ

### 7.2 æ•°æ®æµæ¶æ„

#### 7.2.1 è¯·æ±‚å¤„ç†æµç¨‹

```mermaid
sequenceDiagram
    participant Client as å®¢æˆ·ç«¯
    participant Gateway as APIç½‘å…³
    participant Auth as è®¤è¯æœåŠ¡
    participant Service as ä¸šåŠ¡æœåŠ¡
    participant Cache as ç¼“å­˜å±‚
    participant DB as æ•°æ®åº“

    Client->>Gateway: å‘é€è¯·æ±‚
    Gateway->>Auth: éªŒè¯ä»¤ç‰Œ
    Auth-->>Gateway: è¿”å›ç”¨æˆ·ä¿¡æ¯
    Gateway->>Service: è½¬å‘è¯·æ±‚
    Service->>Cache: æŸ¥è¯¢ç¼“å­˜
    alt ç¼“å­˜å‘½ä¸­
        Cache-->>Service: è¿”å›ç¼“å­˜æ•°æ®
    else ç¼“å­˜æœªå‘½ä¸­
        Service->>DB: æŸ¥è¯¢æ•°æ®åº“
        DB-->>Service: è¿”å›æ•°æ®
        Service->>Cache: æ›´æ–°ç¼“å­˜
    end
    Service-->>Gateway: è¿”å›å“åº”
    Gateway-->>Client: è¿”å›ç»“æœ
```

#### 7.2.2 æ•°æ®åŒæ­¥æ¶æ„

**æ•°æ®åº“åŒæ­¥**
```mermaid
graph TD
    A[ä¸»æ•°æ®åº“] -->|ä¸»ä»å¤åˆ¶| B[ä»æ•°æ®åº“1]
    A -->|ä¸»ä»å¤åˆ¶| C[ä»æ•°æ®åº“2]
    B -->|è¯»æ“ä½œ| D[åº”ç”¨æœåŠ¡1]
    C -->|è¯»æ“ä½œ| E[åº”ç”¨æœåŠ¡2]
    A -->|å†™æ“ä½œ| F[åº”ç”¨æœåŠ¡å†™]
```

**ç¼“å­˜åŒæ­¥ç­–ç•¥**
- **Cache-Aside**: åº”ç”¨ç¨‹åºè´Ÿè´£ç¼“å­˜ç®¡ç†
- **Write-Through**: åŒæ—¶å†™å…¥ç¼“å­˜å’Œæ•°æ®åº“
- **Write-Behind**: å…ˆå†™ç¼“å­˜ï¼Œå¼‚æ­¥å†™å…¥æ•°æ®åº“
- **Refresh-Ahead**: ä¸»åŠ¨åˆ·æ–°å³å°†è¿‡æœŸçš„ç¼“å­˜

### 7.3 å®‰å…¨æ¶æ„

#### 7.3.1 å®‰å…¨å±‚æ¬¡

**ç½‘ç»œå®‰å…¨**
- **é˜²ç«å¢™**: WAFã€IPSã€DDoSé˜²æŠ¤
- **VPN**: å†…ç½‘è®¿é—®ã€å®‰å…¨éš§é“
- **SSL/TLS**: æ•°æ®ä¼ è¾“åŠ å¯†
- **ç½‘ç»œéš”ç¦»**: VPCã€å­ç½‘åˆ’åˆ†

**åº”ç”¨å®‰å…¨**
- **èº«ä»½è®¤è¯**: JWTã€OAuth2ã€SAML
- **æƒé™æ§åˆ¶**: RBACã€ABAC
- **è¾“å…¥éªŒè¯**: å‚æ•°æ ¡éªŒã€SQLæ³¨å…¥é˜²æŠ¤
- **è¾“å‡ºç¼–ç **: XSSé˜²æŠ¤ã€CSRFä¿æŠ¤

**æ•°æ®å®‰å…¨**
- **æ•°æ®åŠ å¯†**: é™æ€åŠ å¯†ã€ä¼ è¾“åŠ å¯†
- **å¯†é’¥ç®¡ç†**: HSMã€å¯†é’¥è½®æ¢
- **å¤‡ä»½å®‰å…¨**: åŠ å¯†å¤‡ä»½ã€å¼‚åœ°å­˜å‚¨
- **å®¡è®¡æ—¥å¿—**: æ“ä½œè®°å½•ã€åˆè§„å®¡è®¡

#### 7.3.2 å®‰å…¨æœ€ä½³å®è·µ

**å¯†ç å®‰å…¨**
```javascript
// å¯†ç åŠ å¯†ç¤ºä¾‹
const bcrypt = require('bcryptjs');

class SecurityService {
  // å¯†ç åŠ å¯†
  async hashPassword(password) {
    const saltRounds = 12;
    return await bcrypt.hash(password, saltRounds);
  }

  // å¯†ç éªŒè¯
  async verifyPassword(password, hash) {
    return await bcrypt.compare(password, hash);
  }

  // ç”Ÿæˆå®‰å…¨éšæœºå­—ç¬¦ä¸²
  generateSecureToken(length = 32) {
    return crypto.randomBytes(length).toString('hex');
  }
}
```

**APIå®‰å…¨**
```javascript
// APIå®‰å…¨ä¸­é—´ä»¶
const rateLimit = require('express-rate-limit');
const helmet = require('helmet');

// å®‰å…¨å¤´è®¾ç½®
app.use(helmet({
  contentSecurityPolicy: {
    directives: {
      defaultSrc: ["'self'"],
      styleSrc: ["'self'", "'unsafe-inline'"],
      scriptSrc: ["'self'"],
      imgSrc: ["'self'", "data:", "https:"],
    },
  },
  hsts: {
    maxAge: 31536000,
    includeSubDomains: true,
    preload: true
  }
}));

// APIé™æµ
const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15åˆ†é’Ÿ
  max: 100, // é™åˆ¶æ¯ä¸ªIP 100æ¬¡è¯·æ±‚
  message: 'Too many requests from this IP',
  standardHeaders: true,
  legacyHeaders: false,
});

app.use('/api', limiter);
```

### 7.4 æ€§èƒ½ä¼˜åŒ–æ¶æ„

#### 7.4.1 å‰ç«¯æ€§èƒ½ä¼˜åŒ–

**ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½**
```javascript
// Reactä»£ç åˆ†å‰²
import React, { lazy, Suspense } from 'react';

const ProductPage = lazy(() => import('./pages/ProductPage'));
const UserPage = lazy(() => import('./pages/UserPage'));

function App() {
  return (
    <Suspense fallback={<div>Loading...</div>}>
      <Routes>
        <Route path="/products" element={<ProductPage />} />
        <Route path="/users" element={<UserPage />} />
      </Routes>
    </Suspense>
  );
}
```

**èµ„æºä¼˜åŒ–ç­–ç•¥**
```javascript
// Webpacké…ç½®ä¼˜åŒ–
module.exports = {
  optimization: {
    splitChunks: {
      chunks: 'all',
      cacheGroups: {
        vendor: {
          test: /[\\/]node_modules[\\/]/,
          name: 'vendors',
          chunks: 'all',
        },
        common: {
          name: 'common',
          minChunks: 2,
          chunks: 'all',
          enforce: true
        }
      }
    }
  },
  // èµ„æºå‹ç¼©
  plugins: [
    new CompressionPlugin({
      algorithm: 'gzip',
      test: /\.(js|css|html|svg)$/,
      threshold: 8192,
      minRatio: 0.8
    })
  ]
};
```

#### 7.4.2 åç«¯æ€§èƒ½ä¼˜åŒ–

**æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–**
```javascript
// æŸ¥è¯¢ä¼˜åŒ–ç¤ºä¾‹
class ProductService {
  // ä½¿ç”¨ç´¢å¼•å’Œåˆ†é¡µ
  async getProducts(page = 1, limit = 20, filters = {}) {
    const offset = (page - 1) * limit;
    
    const query = {
      where: filters,
      include: [{
        model: Category,
        attributes: ['id', 'name']
      }],
      attributes: {
        exclude: ['created_by', 'updated_by']
      },
      order: [['created_at', 'DESC']],
      limit,
      offset
    };

    return await Product.findAndCountAll(query);
  }

  // æ‰¹é‡æŸ¥è¯¢ä¼˜åŒ–
  async getProductsWithCache(ids) {
    // å…ˆæŸ¥ç¼“å­˜
    const cacheKeys = ids.map(id => `product:${id}`);
    const cachedProducts = await redis.mget(cacheKeys);
    
    const foundProducts = [];
    const missingIds = [];
    
    cachedProducts.forEach((cached, index) => {
      if (cached) {
        foundProducts.push(JSON.parse(cached));
      } else {
        missingIds.push(ids[index]);
      }
    });

    // æŸ¥è¯¢ç¼ºå¤±çš„æ•°æ®
    if (missingIds.length > 0) {
      const dbProducts = await Product.findAll({
        where: { id: { [Op.in]: missingIds } }
      });

      // æ›´æ–°ç¼“å­˜
      const pipeline = redis.pipeline();
      dbProducts.forEach(product => {
        pipeline.setex(`product:${product.id}`, 3600, JSON.stringify(product));
        foundProducts.push(product);
      });
      await pipeline.exec();
    }

    return foundProducts;
  }
}
```

**ç¼“å­˜ç­–ç•¥**
```javascript
// å¤šçº§ç¼“å­˜ç­–ç•¥
class CacheService {
  constructor() {
    this.memoryCache = new Map();
    this.redis = new Redis(process.env.REDIS_URL);
  }

  async get(key) {
    // L1: å†…å­˜ç¼“å­˜
    if (this.memoryCache.has(key)) {
      return this.memoryCache.get(key);
    }

    // L2: Redisç¼“å­˜
    const cached = await this.redis.get(key);
    if (cached) {
      const value = JSON.parse(cached);
      this.memoryCache.set(key, value);
      return value;
    }

    return null;
  }

  async set(key, value, ttl = 3600) {
    // æ›´æ–°å†…å­˜ç¼“å­˜
    this.memoryCache.set(key, value);
    
    // æ›´æ–°Redisç¼“å­˜
    await this.redis.setex(key, ttl, JSON.stringify(value));
  }

  async invalidate(pattern) {
    // æ¸…é™¤å†…å­˜ç¼“å­˜
    for (const key of this.memoryCache.keys()) {
      if (key.match(pattern)) {
        this.memoryCache.delete(key);
      }
    }

    // æ¸…é™¤Redisç¼“å­˜
    const keys = await this.redis.keys(pattern);
    if (keys.length > 0) {
      await this.redis.del(...keys);
    }
  }
}
```

### 7.5 å¯æ‰©å±•æ€§æ¶æ„

#### 7.5.1 æ°´å¹³æ‰©å±•ç­–ç•¥

**æœåŠ¡æ‰©å±•**
```yaml
# Kubernetesæ°´å¹³æ‰©å±•é…ç½®
apiVersion: apps/v1
kind: Deployment
metadata:
  name: backend-deployment
spec:
  replicas: 3
  selector:
    matchLabels:
      app: backend
  template:
    spec:
      containers:
      - name: backend
        image: myapp/backend:latest
        resources:
          requests:
            memory: "256Mi"
            cpu: "250m"
          limits:
            memory: "512Mi"
            cpu: "500m"
---
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: backend-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: backend-deployment
  minReplicas: 3
  maxReplicas: 10
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70
  - type: Resource
    resource:
      name: memory
      target:
        type: Utilization
        averageUtilization: 80
```

**æ•°æ®åº“åˆ†ç‰‡**
```javascript
// æ•°æ®åº“åˆ†ç‰‡ç­–ç•¥
class DatabaseSharding {
  constructor() {
    this.shards = [
      new Sequelize(process.env.DB_SHARD_1_URL),
      new Sequelize(process.env.DB_SHARD_2_URL),
      new Sequelize(process.env.DB_SHARD_3_URL),
    ];
  }

  // æ ¹æ®ç”¨æˆ·IDåˆ†ç‰‡
  getShardByUserId(userId) {
    const shardIndex = userId % this.shards.length;
    return this.shards[shardIndex];
  }

  // æ ¹æ®å“ˆå¸Œå€¼åˆ†ç‰‡
  getShardByHash(key) {
    const hash = crypto.createHash('md5').update(key).digest('hex');
    const shardIndex = parseInt(hash.substring(0, 8), 16) % this.shards.length;
    return this.shards[shardIndex];
  }

  // è·¨åˆ†ç‰‡æŸ¥è¯¢
  async queryAllShards(query) {
    const promises = this.shards.map(shard => 
      shard.query(query, { type: Sequelize.QueryTypes.SELECT })
    );
    const results = await Promise.all(promises);
    return results.flat();
  }
}
```

#### 7.5.2 å‚ç›´æ‰©å±•ç­–ç•¥

**æœåŠ¡æ‹†åˆ†**
```mermaid
graph TD
    A[å•ä½“åº”ç”¨] -->|æ‹†åˆ†| B[ç”¨æˆ·æœåŠ¡]
    A -->|æ‹†åˆ†| C[äº§å“æœåŠ¡]
    A -->|æ‹†åˆ†| D[è®¢å•æœåŠ¡]
    A -->|æ‹†åˆ†| E[æ”¯ä»˜æœåŠ¡]
    
    B --> F[ç”¨æˆ·æ•°æ®åº“]
    C --> G[äº§å“æ•°æ®åº“]
    D --> H[è®¢å•æ•°æ®åº“]
    E --> I[æ”¯ä»˜æ•°æ®åº“]
```

**é¢†åŸŸé©±åŠ¨è®¾è®¡**
```javascript
// ç”¨æˆ·é¢†åŸŸæœåŠ¡
class UserDomainService {
  constructor(userRepository, eventBus) {
    this.userRepository = userRepository;
    this.eventBus = eventBus;
  }

  async registerUser(userData) {
    // ä¸šåŠ¡è§„åˆ™éªŒè¯
    this.validateUserData(userData);
    
    // åˆ›å»ºç”¨æˆ·èšåˆæ ¹
    const user = new User(userData);
    
    // ä¿å­˜ç”¨æˆ·
    await this.userRepository.save(user);
    
    // å‘å¸ƒé¢†åŸŸäº‹ä»¶
    this.eventBus.publish(new UserRegisteredEvent(user));
    
    return user;
  }
}

// äº§å“é¢†åŸŸæœåŠ¡
class ProductDomainService {
  constructor(productRepository, inventoryService) {
    this.productRepository = productRepository;
    this.inventoryService = inventoryService;
  }

  async createProduct(productData) {
    const product = new Product(productData);
    
    // åˆå§‹åŒ–åº“å­˜
    await this.inventoryService.initializeStock(product.id, product.initialStock);
    
    await this.productRepository.save(product);
    
    return product;
  }
}
```

### 7.6 å®¹é”™å’Œæ¢å¤æ¶æ„

#### 7.6.1 æœåŠ¡å®¹é”™æœºåˆ¶

**ç†”æ–­å™¨æ¨¡å¼**
```javascript
const CircuitBreaker = require('opossum');

class ServiceClient {
  constructor() {
    this.options = {
      timeout: 3000,
      errorThresholdPercentage: 50,
      resetTimeout: 30000
    };
    
    this.breaker = new CircuitBreaker(this.callExternalService.bind(this), this.options);
    
    // ç†”æ–­å™¨äº‹ä»¶
    this.breaker.on('open', () => console.log('Circuit breaker opened'));
    this.breaker.on('halfOpen', () => console.log('Circuit breaker half-opened'));
    this.breaker.on('close', () => console.log('Circuit breaker closed'));
  }

  async callExternalService(data) {
    // è°ƒç”¨å¤–éƒ¨æœåŠ¡
    return await externalAPI.call(data);
  }

  async makeRequest(data) {
    try {
      return await this.breaker.fire(data);
    } catch (error) {
      // é™çº§å¤„ç†
      return this.fallbackResponse(data);
    }
  }

  fallbackResponse(data) {
    return {
      success: false,
      message: 'æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åé‡è¯•',
      data: null
    };
  }
}
```

**é‡è¯•æœºåˆ¶**
```javascript
const retry = require('async-retry');

class ResilientService {
  async callWithRetry(operation, options = {}) {
    return await retry(async (bail) => {
      try {
        return await operation();
      } catch (error) {
        // ä¸å¯é‡è¯•çš„é”™è¯¯ç›´æ¥æŠ›å‡º
        if (this.isNonRetryableError(error)) {
          bail(error);
          return;
        }
        
        console.log(`Operation failed, retrying: ${error.message}`);
        throw error;
      }
    }, {
      retries: options.retries || 3,
      minTimeout: options.minTimeout || 1000,
      maxTimeout: options.maxTimeout || 5000,
      factor: options.factor || 2
    });
  }

  isNonRetryableError(error) {
    return error.status >= 400 && error.status < 500;
  }
}
```

#### 7.6.2 æ•°æ®æ¢å¤ç­–ç•¥

**å¤‡ä»½æ¢å¤æµç¨‹**
```bash
#!/bin/bash
# ç¾éš¾æ¢å¤è„šæœ¬

DISASTER_RECOVERY_MODE=${1:-"partial"}
BACKUP_LOCATION=${2:-"s3://myapp-backups/latest"}

echo "Starting disaster recovery in $DISASTER_RECOVERY_MODE mode"

case $DISASTER_RECOVERY_MODE in
  "full")
    echo "Full system recovery..."
    # æ¢å¤æ•°æ®åº“
    ./scripts/restore-database.sh $BACKUP_LOCATION/database
    # æ¢å¤æ–‡ä»¶
    ./scripts/restore-files.sh $BACKUP_LOCATION/files
    # æ¢å¤é…ç½®
    ./scripts/restore-config.sh $BACKUP_LOCATION/config
    ;;
  "database")
    echo "Database only recovery..."
    ./scripts/restore-database.sh $BACKUP_LOCATION/database
    ;;
  "partial")
    echo "Partial recovery..."
    # æ¢å¤å…³é”®æ•°æ®
    ./scripts/restore-critical-data.sh $BACKUP_LOCATION
    ;;
esac

echo "Disaster recovery completed"
```

---

## 8. åç»­å¼€å‘å’Œç»´æŠ¤æŒ‡å—

### 8.1 å¼€å‘æµç¨‹è§„èŒƒ

#### 8.1.1 æ•æ·å¼€å‘æµç¨‹

**Sprintè§„åˆ’**
- **Sprintå‘¨æœŸ**: 2å‘¨
- **Sprintä»ªå¼**:
  - Sprint Planning (4å°æ—¶)
  - Daily Standup (15åˆ†é’Ÿ)
  - Sprint Review (2å°æ—¶)
  - Sprint Retrospective (1.5å°æ—¶)

**å¼€å‘æµç¨‹**
```mermaid
graph TD
    A[éœ€æ±‚åˆ†æ] --> B[æŠ€æœ¯è®¾è®¡]
    B --> C[å¼€å‘ç¼–ç ]
    C --> D[å•å…ƒæµ‹è¯•]
    D --> E[Code Review]
    E --> F[é›†æˆæµ‹è¯•]
    F --> G[éƒ¨ç½²æµ‹è¯•]
    G --> H[éªŒæ”¶æµ‹è¯•]
    H --> I[ç”Ÿäº§å‘å¸ƒ]
```

#### 8.1.2 åˆ†æ”¯ç®¡ç†ç­–ç•¥

**GitFlowå·¥ä½œæµç¨‹**
```bash
# åŠŸèƒ½å¼€å‘æµç¨‹
git checkout develop
git pull origin develop
git checkout -b feature/user-profile-enhancement

# å¼€å‘å®Œæˆå
git add .
git commit -m "feat(profile): add avatar upload functionality"
git push origin feature/user-profile-enhancement

# åˆ›å»ºPull Request
# Code Reviewé€šè¿‡ååˆå¹¶åˆ°developåˆ†æ”¯
```

**åˆ†æ”¯å‘½åè§„èŒƒ**
```
feature/åŠŸèƒ½æè¿°       # æ–°åŠŸèƒ½å¼€å‘
bugfix/é—®é¢˜æè¿°        # Bugä¿®å¤  
hotfix/ç´§æ€¥ä¿®å¤æè¿°    # ç”Ÿäº§ç¯å¢ƒç´§æ€¥ä¿®å¤
release/ç‰ˆæœ¬å·         # å‘å¸ƒåˆ†æ”¯
```

#### 8.1.3 ä»£ç è´¨é‡æ§åˆ¶

**ä»£ç å®¡æŸ¥æ¸…å•**
- [ ] ä»£ç ç¬¦åˆç¼–ç è§„èŒƒ
- [ ] åŠŸèƒ½å®ç°ç¬¦åˆéœ€æ±‚
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 80%
- [ ] æ²¡æœ‰å®‰å…¨æ¼æ´
- [ ] æ€§èƒ½æ»¡è¶³è¦æ±‚
- [ ] é”™è¯¯å¤„ç†å®Œå–„
- [ ] æ–‡æ¡£æ›´æ–°å®Œæ•´

**è‡ªåŠ¨åŒ–æ£€æŸ¥**
```yaml
# .github/workflows/code-quality.yml
name: Code Quality Check

on:
  pull_request:
    branches: [ develop, main ]

jobs:
  code-quality:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
        cache: 'npm'
    
    - name: Install dependencies
      run: npm ci
    
    - name: Run ESLint
      run: npm run lint
    
    - name: Run Tests
      run: npm run test:coverage
    
    - name: Security Audit
      run: npm audit --production
    
    - name: Upload Coverage
      uses: codecov/codecov-action@v3
```

### 8.2 ç‰ˆæœ¬å‘å¸ƒç®¡ç†

#### 8.2.1 ç‰ˆæœ¬å·è§„èŒƒ

**è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ (SemVer)**
```
æ ¼å¼: MAJOR.MINOR.PATCH

MAJOR: ä¸å…¼å®¹çš„APIä¿®æ”¹
MINOR: å‘åå…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢
PATCH: å‘åå…¼å®¹çš„é—®é¢˜ä¿®æ­£

ç¤ºä¾‹:
1.0.0 - é¦–ä¸ªç¨³å®šç‰ˆæœ¬
1.1.0 - æ–°å¢åŠŸèƒ½
1.1.1 - Bugä¿®å¤
2.0.0 - é‡å¤§æ›´æ–°ï¼Œä¸å‘åå…¼å®¹
```

**ç‰ˆæœ¬å‘å¸ƒè„šæœ¬**
```bash
#!/bin/bash
# scripts/release.sh

VERSION_TYPE=${1:-patch}  # patch, minor, major
CURRENT_VERSION=$(node -p "require('./package.json').version")

echo "Current version: $CURRENT_VERSION"

# æ›´æ–°ç‰ˆæœ¬å·
npm version $VERSION_TYPE --no-git-tag-version

NEW_VERSION=$(node -p "require('./package.json').version")
echo "New version: $NEW_VERSION"

# æ›´æ–°CHANGELOG
echo "## [$NEW_VERSION] - $(date +%Y-%m-%d)" >> CHANGELOG.md.tmp
echo "" >> CHANGELOG.md.tmp
cat CHANGELOG.md >> CHANGELOG.md.tmp
mv CHANGELOG.md.tmp CHANGELOG.md

# æäº¤ç‰ˆæœ¬æ›´æ–°
git add .
git commit -m "chore: release version $NEW_VERSION"
git tag -a "v$NEW_VERSION" -m "Release version $NEW_VERSION"

# æ¨é€åˆ°è¿œç¨‹ä»“åº“
git push origin develop
git push origin "v$NEW_VERSION"

echo "Version $NEW_VERSION released successfully"
```

#### 8.2.2 å‘å¸ƒæµç¨‹

**å‘å¸ƒæ¸…å•**
- [ ] åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] æ€§èƒ½æµ‹è¯•é€šè¿‡
- [ ] å®‰å…¨æ‰«æé€šè¿‡
- [ ] æ–‡æ¡£æ›´æ–°å®Œæˆ
- [ ] æ•°æ®åº“è¿ç§»è„šæœ¬å‡†å¤‡
- [ ] å›æ»šè®¡åˆ’åˆ¶å®š
- [ ] ç›‘æ§å‘Šè­¦é…ç½®
- [ ] å‘å¸ƒé€šçŸ¥å‘é€

**å‘å¸ƒç­–ç•¥**
```yaml
# è“ç»¿éƒ¨ç½²é…ç½®
apiVersion: argoproj.io/v1alpha1
kind: Rollout
metadata:
  name: myapp-rollout
spec:
  replicas: 5
  strategy:
    blueGreen:
      activeService: myapp-active
      previewService: myapp-preview
      autoPromotionEnabled: false
      prePromotionAnalysis:
        templates:
        - templateName: success-rate
        args:
        - name: service-name
          value: myapp-preview
      postPromotionAnalysis:
        templates:
        - templateName: success-rate
        args:
        - name: service-name
          value: myapp-active
```

### 8.3 ç›‘æ§å’Œè¿ç»´

#### 8.3.1 ç³»ç»Ÿç›‘æ§

**ç›‘æ§æŒ‡æ ‡**
```javascript
// åº”ç”¨æŒ‡æ ‡æ”¶é›†
const promClient = require('prom-client');

// è‡ªå®šä¹‰æŒ‡æ ‡
const httpRequestsTotal = new promClient.Counter({
  name: 'http_requests_total',
  help: 'Total number of HTTP requests',
  labelNames: ['method', 'route', 'status']
});

const httpRequestDuration = new promClient.Histogram({
  name: 'http_request_duration_seconds',
  help: 'Duration of HTTP requests in seconds',
  labelNames: ['method', 'route'],
  buckets: [0.01, 0.05, 0.1, 0.5, 1, 2, 5]
});

const activeConnections = new promClient.Gauge({
  name: 'active_connections',
  help: 'Number of active connections',
});

// ä¸­é—´ä»¶æ”¶é›†æŒ‡æ ‡
const collectMetrics = (req, res, next) => {
  const start = Date.now();
  
  res.on('finish', () => {
    const duration = (Date.now() - start) / 1000;
    
    httpRequestsTotal
      .labels(req.method, req.route?.path || req.path, res.statusCode)
      .inc();
    
    httpRequestDuration
      .labels(req.method, req.route?.path || req.path)
      .observe(duration);
  });
  
  next();
};

module.exports = { collectMetrics };
```

**å‘Šè­¦è§„åˆ™**
```yaml
# monitoring/alerts/app-alerts.yml
groups:
- name: myapp.alerts
  rules:
  - alert: HighErrorRate
    expr: rate(http_requests_total{status=~"5.."}[5m]) > 0.1
    for: 2m
    labels:
      severity: critical
      service: myapp
    annotations:
      summary: "åº”ç”¨é”™è¯¯ç‡è¿‡é«˜"
      description: "æœåŠ¡ {{ $labels.service }} é”™è¯¯ç‡è¶…è¿‡10%"
      
  - alert: HighResponseTime
    expr: histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m])) > 1
    for: 5m
    labels:
      severity: warning
      service: myapp
    annotations:
      summary: "åº”ç”¨å“åº”æ—¶é—´è¿‡é•¿"
      description: "95%çš„è¯·æ±‚å“åº”æ—¶é—´è¶…è¿‡1ç§’"
      
  - alert: LowDiskSpace
    expr: (node_filesystem_avail_bytes / node_filesystem_size_bytes) * 100 < 10
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "ç£ç›˜ç©ºé—´ä¸è¶³"
      description: "ç£ç›˜ä½¿ç”¨ç‡è¶…è¿‡90%"
```

#### 8.3.2 æ—¥å¿—ç®¡ç†

**æ—¥å¿—é…ç½®**
```javascript
// config/logger.js
const winston = require('winston');
const { ElasticsearchTransport } = require('winston-elasticsearch');

const logger = winston.createLogger({
  level: process.env.LOG_LEVEL || 'info',
  format: winston.format.combine(
    winston.format.timestamp(),
    winston.format.errors({ stack: true }),
    winston.format.json()
  ),
  defaultMeta: {
    service: 'myapp',
    version: process.env.APP_VERSION,
    environment: process.env.NODE_ENV
  },
  transports: [
    // æ§åˆ¶å°è¾“å‡º
    new winston.transports.Console({
      format: winston.format.combine(
        winston.format.colorize(),
        winston.format.simple()
      )
    }),
    
    // æ–‡ä»¶è¾“å‡º
    new winston.transports.File({
      filename: 'logs/error.log',
      level: 'error',
      maxsize: 10485760, // 10MB
      maxFiles: 5
    }),
    
    new winston.transports.File({
      filename: 'logs/combined.log',
      maxsize: 10485760,
      maxFiles: 5
    }),
    
    // Elasticsearchè¾“å‡º
    new ElasticsearchTransport({
      level: 'info',
      clientOpts: {
        node: process.env.ELASTICSEARCH_URL
      },
      index: 'myapp-logs'
    })
  ]
});

module.exports = logger;
```

**æ—¥å¿—åˆ†ææŸ¥è¯¢**
```json
// ElasticsearchæŸ¥è¯¢ç¤ºä¾‹
{
  "query": {
    "bool": {
      "must": [
        {
          "range": {
            "@timestamp": {
              "gte": "now-1h",
              "lte": "now"
            }
          }
        },
        {
          "term": {
            "level": "error"
          }
        }
      ]
    }
  },
  "aggs": {
    "error_types": {
      "terms": {
        "field": "message.keyword",
        "size": 10
      }
    }
  }
}
```

### 8.4 æ•…éšœæ’æŸ¥æŒ‡å—

#### 8.4.1 å¸¸è§é—®é¢˜æ’æŸ¥

**æœåŠ¡æ— å“åº”**
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
systemctl status myapp
docker ps -a
kubectl get pods -n myapp

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tulpn | grep :3000
lsof -i :3000

# æŸ¥çœ‹æ—¥å¿—
tail -f /var/log/myapp/error.log
kubectl logs -f deployment/myapp -n myapp

# æ£€æŸ¥èµ„æºä½¿ç”¨
top -p $(pgrep node)
free -h
df -h

# æ£€æŸ¥ç½‘ç»œè¿æ¥
curl -I http://localhost:3000/health
telnet localhost 3000
```

**æ•°æ®åº“è¿æ¥é—®é¢˜**
```bash
# PostgreSQLè¿æ¥æ£€æŸ¥
psql -h localhost -p 5432 -U myapp_user -d myapp_db -c "SELECT 1;"

# æŸ¥çœ‹æ•°æ®åº“è¿æ¥æ•°
psql -c "SELECT count(*) FROM pg_stat_activity;"

# æŸ¥çœ‹æ…¢æŸ¥è¯¢
psql -c "SELECT query, calls, total_time, mean_time 
         FROM pg_stat_statements 
         ORDER BY mean_time DESC 
         LIMIT 10;"

# Redisè¿æ¥æ£€æŸ¥
redis-cli ping
redis-cli info memory
redis-cli info clients
```

**å†…å­˜æ³„æ¼æ’æŸ¥**
```javascript
// å†…å­˜ä½¿ç”¨ç›‘æ§
const memoryUsage = () => {
  const used = process.memoryUsage();
  console.log({
    rss: Math.round(used.rss / 1024 / 1024 * 100) / 100,
    heapTotal: Math.round(used.heapTotal / 1024 / 1024 * 100) / 100,
    heapUsed: Math.round(used.heapUsed / 1024 / 1024 * 100) / 100,
    external: Math.round(used.external / 1024 / 1024 * 100) / 100
  });
};

// æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
setInterval(memoryUsage, 60000);

// å¼ºåˆ¶åƒåœ¾å›æ”¶ï¼ˆä»…å¼€å‘ç¯å¢ƒï¼‰
if (global.gc) {
  setInterval(() => {
    global.gc();
    console.log('Manual GC executed');
  }, 300000); // 5åˆ†é’Ÿ
}
```

#### 8.4.2 æ•…éšœé¢„é˜²æªæ–½

**å¥åº·æ£€æŸ¥**
```javascript
// health-check.js
const express = require('express');
const app = express();

app.get('/health', async (req, res) => {
  const health = {
    status: 'ok',
    timestamp: new Date().toISOString(),
    uptime: process.uptime(),
    checks: {}
  };

  try {
    // æ•°æ®åº“æ£€æŸ¥
    await checkDatabase();
    health.checks.database = { status: 'ok' };
  } catch (error) {
    health.checks.database = { status: 'error', message: error.message };
    health.status = 'error';
  }

  try {
    // Redisæ£€æŸ¥
    await checkRedis();
    health.checks.redis = { status: 'ok' };
  } catch (error) {
    health.checks.redis = { status: 'error', message: error.message };
    health.status = 'error';
  }

  const statusCode = health.status === 'ok' ? 200 : 503;
  res.status(statusCode).json(health);
});

async function checkDatabase() {
  const result = await db.query('SELECT 1');
  if (!result) throw new Error('Database query failed');
}

async function checkRedis() {
  const result = await redis.ping();
  if (result !== 'PONG') throw new Error('Redis ping failed');
}
```

### 8.5 æ€§èƒ½ä¼˜åŒ–æŒ‡å—

#### 8.5.1 å‰ç«¯æ€§èƒ½ä¼˜åŒ–

**Bundleåˆ†æå’Œä¼˜åŒ–**
```bash
# åˆ†æbundleå¤§å°
npx webpack-bundle-analyzer build/static/js/*.js

# Reactæ€§èƒ½åˆ†æ
npm install --save-dev @welldone-software/why-did-you-render
```

```javascript
// æ€§èƒ½ç›‘æ§ç»„ä»¶
import { Profiler } from 'react';

const onRenderCallback = (id, phase, actualDuration, baseDuration, startTime, commitTime, interactions) => {
  console.log('Profiler:', {
    id,
    phase,
    actualDuration,
    baseDuration,
    startTime,
    commitTime
  });
};

function App() {
  return (
    <Profiler id="App" onRender={onRenderCallback}>
      <Header />
      <Main />
      <Footer />
    </Profiler>
  );
}
```

#### 8.5.2 åç«¯æ€§èƒ½ä¼˜åŒ–

**æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–**
```sql
-- æŸ¥è¯¢ä¼˜åŒ–ç¤ºä¾‹
EXPLAIN ANALYZE 
SELECT p.*, c.name as category_name, COUNT(r.id) as review_count
FROM products p
LEFT JOIN categories c ON p.category_id = c.id
LEFT JOIN reviews r ON p.id = r.product_id
WHERE p.status = 'active'
  AND p.price BETWEEN 100 AND 1000
GROUP BY p.id, c.name
ORDER BY p.created_at DESC
LIMIT 20;

-- æ·»åŠ å¿…è¦çš„ç´¢å¼•
CREATE INDEX CONCURRENTLY idx_products_status_price 
ON products(status, price) WHERE status = 'active';

CREATE INDEX CONCURRENTLY idx_reviews_product_id 
ON reviews(product_id);
```

**APIç¼“å­˜ç­–ç•¥**
```javascript
// APIç¼“å­˜ä¸­é—´ä»¶
const cache = require('memory-cache');

const cacheMiddleware = (duration = 300) => {
  return (req, res, next) => {
    const key = req.originalUrl;
    const cached = cache.get(key);
    
    if (cached) {
      res.set('X-Cache', 'HIT');
      return res.json(cached);
    }
    
    res.originalJson = res.json;
    res.json = (data) => {
      cache.put(key, data, duration * 1000);
      res.set('X-Cache', 'MISS');
      res.originalJson(data);
    };
    
    next();
  };
};

// ä½¿ç”¨ç¼“å­˜
app.get('/api/products', cacheMiddleware(600), getProducts);
```

### 8.6 å®‰å…¨ç»´æŠ¤

#### 8.6.1 å®‰å…¨æ›´æ–°æµç¨‹

**ä¾èµ–æ›´æ–°æ£€æŸ¥**
```bash
# å®‰å…¨æ¼æ´æ£€æŸ¥
npm audit
npm audit fix

# ä¾èµ–æ›´æ–°
npx npm-check-updates -u
npm install

# Dockeré•œåƒå®‰å…¨æ‰«æ
docker scan myapp:latest
```

**å®‰å…¨é…ç½®æ£€æŸ¥æ¸…å•**
- [ ] æ‰€æœ‰å¯†ç ä½¿ç”¨å¼ºå¯†ç 
- [ ] APIå¯†é’¥å®šæœŸè½®æ¢
- [ ] SSLè¯ä¹¦æœ‰æ•ˆæœŸæ£€æŸ¥
- [ ] é˜²ç«å¢™è§„åˆ™æ›´æ–°
- [ ] æ—¥å¿—è®¿é—®æƒé™æ§åˆ¶
- [ ] æ•°æ®åº“è®¿é—®æƒé™æœ€å°åŒ–
- [ ] å¤‡ä»½æ•°æ®åŠ å¯†å­˜å‚¨

#### 8.6.2 å®‰å…¨ç›‘æ§

**å®‰å…¨äº‹ä»¶ç›‘æ§**
```javascript
// å®‰å…¨äº‹ä»¶ç›‘æ§
const securityLogger = require('./config/security-logger');

// ç™»å½•å¤±è´¥ç›‘æ§
const loginFailureTracker = new Map();

const trackLoginFailures = (ip, username) => {
  const key = `${ip}:${username}`;
  const failures = loginFailureTracker.get(key) || 0;
  
  if (failures >= 5) {
    securityLogger.warn('Multiple login failures detected', {
      ip,
      username,
      failures: failures + 1,
      timestamp: new Date()
    });
    
    // è§¦å‘IPå°ç¦
    blockIP(ip, 3600); // å°ç¦1å°æ—¶
  }
  
  loginFailureTracker.set(key, failures + 1);
  
  // æ¸…ç†è¿‡æœŸè®°å½•
  setTimeout(() => {
    loginFailureTracker.delete(key);
  }, 900000); // 15åˆ†é’Ÿåæ¸…ç†
};

// å¼‚å¸¸è®¿é—®æ£€æµ‹
const detectAnomalousAccess = (req) => {
  const userAgent = req.headers['user-agent'];
  const ip = req.ip;
  const path = req.path;
  
  // æ£€æµ‹å¯ç–‘çš„ç”¨æˆ·ä»£ç†
  if (!userAgent || userAgent.includes('bot') || userAgent.includes('crawler')) {
    securityLogger.warn('Suspicious user agent detected', { ip, userAgent, path });
  }
  
  // æ£€æµ‹SQLæ³¨å…¥å°è¯•
  const sqlInjectionPattern = /(union|select|insert|update|delete|drop|exec|script)/i;
  if (sqlInjectionPattern.test(JSON.stringify(req.query) + JSON.stringify(req.body))) {
    securityLogger.error('SQL injection attempt detected', { ip, path, query: req.query, body: req.body });
  }
};
```

### 8.7 å›¢é˜Ÿåä½œæŒ‡å—

#### 8.7.1 å›¢é˜Ÿè§’è‰²åˆ†å·¥

**å¼€å‘å›¢é˜Ÿç»“æ„**
```
æŠ€æœ¯æ€»ç›‘ (1å)
â”œâ”€â”€ å‰ç«¯è´Ÿè´£äºº (1å)
â”‚   â”œâ”€â”€ é«˜çº§å‰ç«¯å·¥ç¨‹å¸ˆ (2å)
â”‚   â””â”€â”€ å‰ç«¯å·¥ç¨‹å¸ˆ (3å)
â”œâ”€â”€ åç«¯è´Ÿè´£äºº (1å)  
â”‚   â”œâ”€â”€ é«˜çº§åç«¯å·¥ç¨‹å¸ˆ (2å)
â”‚   â””â”€â”€ åç«¯å·¥ç¨‹å¸ˆ (3å)
â”œâ”€â”€ DevOpså·¥ç¨‹å¸ˆ (1å)
â””â”€â”€ QAæµ‹è¯•å·¥ç¨‹å¸ˆ (2å)
```

**è´£ä»»åˆ†å·¥**
| è§’è‰² | ä¸»è¦èŒè´£ | æ¬¡è¦èŒè´£ |
|------|----------|----------|
| æŠ€æœ¯æ€»ç›‘ | æŠ€æœ¯æ¶æ„è®¾è®¡ã€å›¢é˜Ÿç®¡ç†ã€æŠ€æœ¯å†³ç­– | ä»£ç å®¡æŸ¥ã€æŠ€æœ¯åŸ¹è®­ |
| å‰ç«¯è´Ÿè´£äºº | å‰ç«¯æ¶æ„è®¾è®¡ã€å›¢é˜Ÿåè°ƒã€ä»£ç è´¨é‡ | éœ€æ±‚åˆ†æã€æ€§èƒ½ä¼˜åŒ– |
| åç«¯è´Ÿè´£äºº | åç«¯æ¶æ„è®¾è®¡ã€æ•°æ®åº“è®¾è®¡ã€APIè®¾è®¡ | æ€§èƒ½è°ƒä¼˜ã€å®‰å…¨åŠ å›º |
| DevOpså·¥ç¨‹å¸ˆ | CI/CDç®¡é“ã€éƒ¨ç½²è‡ªåŠ¨åŒ–ã€ç›‘æ§è¿ç»´ | å®‰å…¨é…ç½®ã€æ€§èƒ½ç›‘æ§ |

#### 8.7.2 æ²Ÿé€šåä½œè§„èŒƒ

**ä¼šè®®åˆ¶åº¦**
```
æ¯æ—¥ç«™ä¼š (Daily Standup)
- æ—¶é—´: æ¯å¤© 9:30-9:45
- å‚ä¸: å…¨ä½“å¼€å‘äººå‘˜
- å†…å®¹: æ˜¨æ—¥è¿›å±•ã€ä»Šæ—¥è®¡åˆ’ã€é‡åˆ°é—®é¢˜

æŠ€æœ¯åˆ†äº«ä¼š (Tech Sharing)
- æ—¶é—´: æ¯å‘¨äº” 16:00-17:00
- å‚ä¸: å…¨ä½“æŠ€æœ¯äººå‘˜
- å†…å®¹: æŠ€æœ¯åˆ†äº«ã€æœ€ä½³å®è·µã€é—®é¢˜è®¨è®º

æ¶æ„è¯„å®¡ä¼š (Architecture Review)
- æ—¶é—´: æŒ‰éœ€å¬å¼€
- å‚ä¸: æŠ€æœ¯è´Ÿè´£äººã€ç›¸å…³å¼€å‘äººå‘˜
- å†…å®¹: æ¶æ„è®¾è®¡å®¡æŸ¥ã€æŠ€æœ¯æ–¹æ¡ˆè®¨è®º
```

**æ–‡æ¡£ç®¡ç†**
```
æŠ€æœ¯æ–‡æ¡£ç›®å½•ç»“æ„:
docs/
â”œâ”€â”€ architecture/          # æ¶æ„æ–‡æ¡£
â”œâ”€â”€ api/                   # APIæ–‡æ¡£
â”œâ”€â”€ deployment/            # éƒ¨ç½²æ–‡æ¡£  
â”œâ”€â”€ development/           # å¼€å‘è§„èŒƒ
â”œâ”€â”€ troubleshooting/       # æ•…éšœæ’æŸ¥
â”œâ”€â”€ security/              # å®‰å…¨æ–‡æ¡£
â””â”€â”€ meeting-notes/         # ä¼šè®®çºªè¦
```

### 8.8 æŒç»­æ”¹è¿›è®¡åˆ’

#### 8.8.1 æŠ€æœ¯å€ºåŠ¡ç®¡ç†

**æŠ€æœ¯å€ºåŠ¡è¯†åˆ«**
```javascript
// ä»£ç è´¨é‡æ£€æŸ¥è„šæœ¬
const fs = require('fs');
const path = require('path');

class TechnicalDebtAnalyzer {
  constructor() {
    this.issues = [];
  }

  analyzeCodebase(directory) {
    const files = this.getAllFiles(directory, '.js');
    
    files.forEach(file => {
      const content = fs.readFileSync(file, 'utf8');
      this.checkComplexity(file, content);
      this.checkDuplication(file, content);
      this.checkDeprecatedAPIs(file, content);
    });

    return this.generateReport();
  }

  checkComplexity(file, content) {
    const lines = content.split('\n');
    const functions = this.extractFunctions(content);
    
    functions.forEach(func => {
      if (func.complexity > 10) {
        this.issues.push({
          type: 'high_complexity',
          file,
          function: func.name,
          complexity: func.complexity,
          severity: 'medium'
        });
      }
    });
  }

  generateReport() {
    const report = {
      totalIssues: this.issues.length,
      byType: {},
      bySeverity: {},
      recommendations: []
    };

    this.issues.forEach(issue => {
      report.byType[issue.type] = (report.byType[issue.type] || 0) + 1;
      report.bySeverity[issue.severity] = (report.bySeverity[issue.severity] || 0) + 1;
    });

    return report;
  }
}
```

**æ”¹è¿›è®¡åˆ’æ¨¡æ¿**
```markdown
# æŠ€æœ¯æ”¹è¿›è®¡åˆ’ - Sprint XX

## æŠ€æœ¯å€ºåŠ¡æ¸…ç†
- [ ] é‡æ„ç”¨æˆ·æœåŠ¡ä¸­çš„å¤æ‚å‡½æ•° (é¢„è®¡ 8å°æ—¶)
- [ ] ä¼˜åŒ–äº§å“æŸ¥è¯¢çš„æ•°æ®åº“ç´¢å¼• (é¢„è®¡ 4å°æ—¶)
- [ ] å‡çº§è¿‡æœŸçš„npmä¾èµ–åŒ… (é¢„è®¡ 2å°æ—¶)

## æ€§èƒ½ä¼˜åŒ–
- [ ] å®ç°APIå“åº”ç¼“å­˜ (é¢„è®¡ 16å°æ—¶)
- [ ] å‰ç«¯ä»£ç åˆ†å‰²ä¼˜åŒ– (é¢„è®¡ 12å°æ—¶)
- [ ] æ•°æ®åº“è¿æ¥æ± è°ƒä¼˜ (é¢„è®¡ 4å°æ—¶)

## å®‰å…¨åŠ å›º
- [ ] å®æ–½APIé™æµæœºåˆ¶ (é¢„è®¡ 8å°æ—¶)
- [ ] æ·»åŠ è¾“å…¥éªŒè¯å¢å¼º (é¢„è®¡ 6å°æ—¶)
- [ ] æ›´æ–°SSLè¯ä¹¦é…ç½® (é¢„è®¡ 2å°æ—¶)

## ç›‘æ§å®Œå–„
- [ ] æ·»åŠ ä¸šåŠ¡æŒ‡æ ‡ç›‘æ§ (é¢„è®¡ 12å°æ—¶)
- [ ] å®Œå–„å‘Šè­¦è§„åˆ™é…ç½® (é¢„è®¡ 4å°æ—¶)
- [ ] æ—¥å¿—ç»“æ„åŒ–æ”¹è¿› (é¢„è®¡ 8å°æ—¶)
```

#### 8.8.2 æŠ€æœ¯æ ˆæ¼”è¿›

**æŠ€æœ¯é€‰å‹è¯„ä¼°æ¡†æ¶**
```javascript
// æŠ€æœ¯è¯„ä¼°çŸ©é˜µ
const technologyAssessment = {
  criteria: {
    performance: { weight: 0.25 },
    maintainability: { weight: 0.20 },
    community: { weight: 0.15 },
    security: { weight: 0.20 },
    cost: { weight: 0.10 },
    learning_curve: { weight: 0.10 }
  },
  
  evaluate(technology, scores) {
    let totalScore = 0;
    let maxScore = 0;
    
    for (const [criterion, config] of Object.entries(this.criteria)) {
      const score = scores[criterion] || 0;
      totalScore += score * config.weight;
      maxScore += 10 * config.weight;
    }
    
    return {
      technology,
      score: totalScore,
      percentage: (totalScore / maxScore) * 100,
      recommendation: this.getRecommendation(totalScore / maxScore)
    };
  },
  
  getRecommendation(score) {
    if (score >= 0.8) return 'Strongly Recommended';
    if (score >= 0.6) return 'Recommended';
    if (score >= 0.4) return 'Consider';
    return 'Not Recommended';
  }
};

// ä½¿ç”¨ç¤ºä¾‹
const nextjsEvaluation = technologyAssessment.evaluate('Next.js', {
  performance: 9,
  maintainability: 8,
  community: 9,
  security: 8,
  cost: 10,
  learning_curve: 7
});
```

### 8.9 æ–‡æ¡£ç»´æŠ¤

#### 8.9.1 æ–‡æ¡£æ›´æ–°æµç¨‹

**æ–‡æ¡£ç‰ˆæœ¬æ§åˆ¶**
```bash
# æ–‡æ¡£æ›´æ–°å·¥ä½œæµ
git checkout -b docs/update-api-documentation
# ç¼–è¾‘æ–‡æ¡£
git add docs/
git commit -m "docs: update API documentation for v2.1.0"
git push origin docs/update-api-documentation
# åˆ›å»ºPull Request
```

**è‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆ**
```javascript
// è‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£
const swaggerJsdoc = require('swagger-jsdoc');
const fs = require('fs');

const options = {
  definition: {
    openapi: '3.0.0',
    info: {
      title: 'MyApp API',
      version: '1.0.0',
      description: 'MyApp RESTful API documentation',
    },
    servers: [
      {
        url: process.env.API_BASE_URL,
        description: 'Development server',
      },
    ],
  },
  apis: ['./src/routes/*.js'], // ä»è·¯ç”±æ–‡ä»¶ä¸­æå–APIæ–‡æ¡£
};

const specs = swaggerJsdoc(options);

// ç”Ÿæˆæ–‡æ¡£æ–‡ä»¶
fs.writeFileSync('./docs/api/openapi.json', JSON.stringify(specs, null, 2));
console.log('API documentation generated successfully');
```

#### 8.9.2 çŸ¥è¯†åº“å»ºè®¾

**æŠ€æœ¯çŸ¥è¯†åº“ç»“æ„**
```
çŸ¥è¯†åº“ç›®å½•:
knowledge-base/
â”œâ”€â”€ onboarding/            # æ–°äººå…¥èŒæŒ‡å—
â”œâ”€â”€ troubleshooting/       # æ•…éšœæ’æŸ¥æ‰‹å†Œ
â”œâ”€â”€ best-practices/        # æœ€ä½³å®è·µæ–‡æ¡£
â”œâ”€â”€ architecture-decisions/ # æ¶æ„å†³ç­–è®°å½•(ADR)
â”œâ”€â”€ runbooks/              # è¿ç»´æ‰‹å†Œ
â””â”€â”€ lessons-learned/       # ç»éªŒæ€»ç»“
```

**æ¶æ„å†³ç­–è®°å½•æ¨¡æ¿**
```markdown
# ADR-001: é€‰æ‹©PostgreSQLä½œä¸ºä¸»æ•°æ®åº“

## çŠ¶æ€
å·²æ¥å—

## èƒŒæ™¯
é¡¹ç›®éœ€è¦é€‰æ‹©ä¸€ä¸ªå¯é çš„å…³ç³»æ•°æ®åº“æ¥å­˜å‚¨æ ¸å¿ƒä¸šåŠ¡æ•°æ®ã€‚

## å†³ç­–
é€‰æ‹©PostgreSQLä½œä¸ºä¸»æ•°æ®åº“ç³»ç»Ÿã€‚

## ç†ç”±
1. æ”¯æŒACIDäº‹åŠ¡ï¼Œæ•°æ®ä¸€è‡´æ€§å¼º
2. ä¸°å¯Œçš„æ•°æ®ç±»å‹æ”¯æŒï¼ˆJSONã€æ•°ç»„ç­‰ï¼‰
3. å¼ºå¤§çš„æŸ¥è¯¢ä¼˜åŒ–å™¨
4. æ´»è·ƒçš„ç¤¾åŒºæ”¯æŒ
5. è‰¯å¥½çš„æ‰©å±•æ€§

## åæœ
ä¼˜ç‚¹:
- æ•°æ®ä¸€è‡´æ€§å¾—åˆ°ä¿éšœ
- æ”¯æŒå¤æ‚æŸ¥è¯¢å’Œåˆ†æ
- è¿ç»´å·¥å…·å®Œå–„

ç¼ºç‚¹:
- ç›¸æ¯”NoSQLï¼Œå†™å…¥æ€§èƒ½ç¨ä½
- éœ€è¦ä¸“ä¸šçš„DBAæŠ€èƒ½

## æ³¨è®°
å†³ç­–æ—¥æœŸ: 2025-08-26
å†³ç­–è€…: æŠ€æœ¯å›¢é˜Ÿ
å½±å“èŒƒå›´: æ•´ä¸ªåº”ç”¨
```

---

## æ€»ç»“

æœ¬æŠ€æœ¯äº¤ä»˜æ–‡æ¡£åŒ…æä¾›äº†å®Œæ•´çš„é¡¹ç›®æŠ€æœ¯ä¿¡æ¯ï¼Œæ¶µç›–äº†ä»å¼€å‘ç¯å¢ƒæ­å»ºåˆ°ç”Ÿäº§è¿ç»´çš„å…¨ç”Ÿå‘½å‘¨æœŸã€‚æ–‡æ¡£çš„ä¸»è¦ä»·å€¼åœ¨äºï¼š

### ğŸ“š çŸ¥è¯†ä¼ æ‰¿
- è¯¦ç»†çš„ä»£ç ç»“æ„è¯´æ˜ï¼Œå¸®åŠ©æ–°å›¢é˜Ÿæˆå‘˜å¿«é€Ÿä¸Šæ‰‹
- å®Œæ•´çš„æŠ€æœ¯é€‰å‹ç†ç”±å’Œæ¶æ„å†³ç­–è®°å½•
- ä¸°å¯Œçš„æœ€ä½³å®è·µå’Œç»éªŒæ€»ç»“

### ğŸ”§ å®ç”¨å·¥å…·
- å¯æ‰§è¡Œçš„éƒ¨ç½²è„šæœ¬å’Œé…ç½®æ–‡ä»¶
- è¯¦ç»†çš„APIæ¥å£æ–‡æ¡£å’Œæµ‹è¯•ç”¨ä¾‹
- å®Œå–„çš„ç›‘æ§å‘Šè­¦å’Œæ•…éšœæ’æŸ¥æŒ‡å—

### ğŸš€ æŒç»­æ”¹è¿›
- è§„èŒƒçš„å¼€å‘æµç¨‹å’Œä»£ç è´¨é‡æ§åˆ¶
- ç³»ç»ŸåŒ–çš„æ€§èƒ½ä¼˜åŒ–å’Œå®‰å…¨åŠ å›ºæ–¹æ¡ˆ
- æ˜ç¡®çš„å›¢é˜Ÿåä½œå’Œæ–‡æ¡£ç»´æŠ¤æœºåˆ¶

### ğŸ’¡ ä½¿ç”¨å»ºè®®

1. **æ–°å›¢é˜Ÿæˆå‘˜**: æŒ‰é¡ºåºé˜…è¯»ç¬¬1-3ç« ï¼Œå»ºç«‹å¼€å‘ç¯å¢ƒåå¼€å§‹ç†Ÿæ‚‰ä»£ç ç»“æ„
2. **è¿ç»´äººå‘˜**: é‡ç‚¹å…³æ³¨ç¬¬4ã€7ã€8ç« çš„éƒ¨ç½²é…ç½®å’Œç›‘æ§è¿ç»´å†…å®¹
3. **é¡¹ç›®ç»ç†**: é€šè¯»å…¨æ–‡ï¼Œé‡ç‚¹å…³æ³¨ç¬¬8ç« çš„å›¢é˜Ÿåä½œå’Œé¡¹ç›®ç®¡ç†å†…å®¹
4. **æŠ€æœ¯å†³ç­–è€…**: é‡ç‚¹å‚è€ƒç¬¬2ã€7ç« çš„æŠ€æœ¯é€‰å‹å’Œæ¶æ„è®¾è®¡å†…å®¹

### ğŸ“‹ æ–‡æ¡£ç»´æŠ¤

æœ¬æ–‡æ¡£åº”éšé¡¹ç›®å‘å±•æŒç»­æ›´æ–°ï¼Œå»ºè®®ï¼š
- æ¯ä¸ªSprintç»“æŸåæ£€æŸ¥æ–‡æ¡£æ›´æ–°éœ€æ±‚
- é‡å¤§æŠ€æœ¯å˜æ›´æ—¶åŠæ—¶æ›´æ–°ç›¸å…³ç« èŠ‚
- å­£åº¦è¿›è¡Œæ–‡æ¡£å®Œæ•´æ€§æ£€æŸ¥å’Œä¼˜åŒ–

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2025å¹´8æœˆ26æ—¥  
**ç»´æŠ¤è´£ä»»äºº**: æŠ€æœ¯å›¢é˜Ÿ  

---

*æœ¬æ–‡æ¡£æ˜¯é¡¹ç›®çš„é‡è¦æŠ€æœ¯èµ„äº§ï¼Œè¯·å¦¥å–„ä¿å­˜å¹¶åŠæ—¶æ›´æ–°ã€‚å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–æ”¹è¿›å»ºè®®ï¼Œè¯·è”ç³»æŠ€æœ¯å›¢é˜Ÿã€‚*
